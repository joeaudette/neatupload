<?xml version="1.0" encoding="UTF-8"?>
<office:document xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:config="urn:oasis:names:tc:opendocument:xmlns:config:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" office:version="1.0" office:mimetype="application/vnd.oasis.opendocument.text">
<office:meta>
<meta:generator>OpenOffice.org/2.3$Linux OpenOffice.org_project/680m6$Build-9226</meta:generator>
<dc:title>NeatUploadâ„¢ Manual</dc:title>
<meta:creation-date>2007-08-10T02:24:38</meta:creation-date>
<dc:creator>Dean Brettle</dc:creator>
<dc:date>2008-10-27T15:44:50</dc:date>
<meta:editing-cycles>121</meta:editing-cycles>
<meta:editing-duration>P6DT8H51M19S</meta:editing-duration>
<meta:user-defined meta:name="Info 1"/>
<meta:user-defined meta:name="Info 2"/>
<meta:user-defined meta:name="Info 3"/>
<meta:user-defined meta:name="Info 4"/>
<meta:document-statistic meta:table-count="1" meta:image-count="0" meta:object-count="0" meta:page-count="1" meta:paragraph-count="595" meta:word-count="16867" meta:character-count="117668"/>
</office:meta>
<office:settings>
<config:config-item-set config:name="ooo:view-settings">
<config:config-item config:name="ViewAreaTop" config:type="int">158905</config:config-item>
<config:config-item config:name="ViewAreaLeft" config:type="int">1002</config:config-item>
<config:config-item config:name="ViewAreaWidth" config:type="int">24714</config:config-item>
<config:config-item config:name="ViewAreaHeight" config:type="int">15030</config:config-item>
<config:config-item config:name="ShowRedlineChanges" config:type="boolean">false</config:config-item>
<config:config-item config:name="InBrowseMode" config:type="boolean">true</config:config-item>
<config:config-item-map-indexed config:name="Views">
<config:config-item-map-entry>
<config:config-item config:name="ViewId" config:type="string">view2</config:config-item>
<config:config-item config:name="ViewLeft" config:type="int">15240</config:config-item>
<config:config-item config:name="ViewTop" config:type="int">164583</config:config-item>
<config:config-item config:name="VisibleLeft" config:type="int">1002</config:config-item>
<config:config-item config:name="VisibleTop" config:type="int">158905</config:config-item>
<config:config-item config:name="VisibleRight" config:type="int">25714</config:config-item>
<config:config-item config:name="VisibleBottom" config:type="int">173934</config:config-item>
<config:config-item config:name="ZoomType" config:type="short">0</config:config-item>
<config:config-item config:name="ZoomFactor" config:type="short">100</config:config-item>
<config:config-item config:name="IsSelectedFrame" config:type="boolean">false</config:config-item>
</config:config-item-map-entry>
</config:config-item-map-indexed>
</config:config-item-set>
<config:config-item-set config:name="ooo:configuration-settings">
<config:config-item config:name="AddParaTableSpacing" config:type="boolean">true</config:config-item>
<config:config-item config:name="PrintReversed" config:type="boolean">false</config:config-item>
<config:config-item config:name="OutlineLevelYieldsNumbering" config:type="boolean">false</config:config-item>
<config:config-item config:name="LinkUpdateMode" config:type="short">1</config:config-item>
<config:config-item config:name="PrintEmptyPages" config:type="boolean">true</config:config-item>
<config:config-item config:name="IgnoreFirstLineIndentInNumbering" config:type="boolean">false</config:config-item>
<config:config-item config:name="CharacterCompressionType" config:type="short">0</config:config-item>
<config:config-item config:name="PrintSingleJobs" config:type="boolean">false</config:config-item>
<config:config-item config:name="UpdateFromTemplate" config:type="boolean">false</config:config-item>
<config:config-item config:name="PrintPaperFromSetup" config:type="boolean">false</config:config-item>
<config:config-item config:name="AddFrameOffsets" config:type="boolean">false</config:config-item>
<config:config-item config:name="PrintLeftPages" config:type="boolean">true</config:config-item>
<config:config-item config:name="RedlineProtectionKey" config:type="base64Binary"/>
<config:config-item config:name="PrintTables" config:type="boolean">true</config:config-item>
<config:config-item config:name="ChartAutoUpdate" config:type="boolean">true</config:config-item>
<config:config-item config:name="PrintControls" config:type="boolean">true</config:config-item>
<config:config-item config:name="PrinterSetup" config:type="base64Binary">XwH+/0dlbmVyaWMgUHJpbnRlcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU0dFTlBSVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAMApQAAAAAAAAAFAFZUAAAkbQAASm9iRGF0YSAxCnByaW50ZXI9R2VuZXJpYyBQcmludGVyCm9yaWVudGF0aW9uPVBvcnRyYWl0CmNvcGllcz0xCmN1cHM9MAptYXJnaW5kYWp1c3RtZW50PTAsMCwwLDAKY29sb3JkZXB0aD0yNApwc2xldmVsPTAKY29sb3JkZXZpY2U9MApQUERDb250ZXhEYXRhClBhZ2VTaXplOkxldHRlcgAA</config:config-item>
<config:config-item config:name="IgnoreTabsAndBlanksForLineCalculation" config:type="boolean">false</config:config-item>
<config:config-item config:name="PrintAnnotationMode" config:type="short">0</config:config-item>
<config:config-item config:name="LoadReadonly" config:type="boolean">false</config:config-item>
<config:config-item config:name="AddParaSpacingToTableCells" config:type="boolean">true</config:config-item>
<config:config-item config:name="AddExternalLeading" config:type="boolean">true</config:config-item>
<config:config-item config:name="ApplyUserData" config:type="boolean">true</config:config-item>
<config:config-item config:name="FieldAutoUpdate" config:type="boolean">true</config:config-item>
<config:config-item config:name="SaveVersionOnClose" config:type="boolean">false</config:config-item>
<config:config-item config:name="SaveGlobalDocumentLinks" config:type="boolean">false</config:config-item>
<config:config-item config:name="IsKernAsianPunctuation" config:type="boolean">false</config:config-item>
<config:config-item config:name="AlignTabStopPosition" config:type="boolean">true</config:config-item>
<config:config-item config:name="ClipAsCharacterAnchoredWriterFlyFrames" config:type="boolean">false</config:config-item>
<config:config-item config:name="CurrentDatabaseDataSource" config:type="string">Addresses2</config:config-item>
<config:config-item config:name="DoNotCaptureDrawObjsOnPage" config:type="boolean">false</config:config-item>
<config:config-item config:name="TableRowKeep" config:type="boolean">false</config:config-item>
<config:config-item config:name="PrinterName" config:type="string">Generic Printer</config:config-item>
<config:config-item config:name="PrintFaxName" config:type="string"/>
<config:config-item config:name="ConsiderTextWrapOnObjPos" config:type="boolean">false</config:config-item>
<config:config-item config:name="UseOldPrinterMetrics" config:type="boolean">true</config:config-item>
<config:config-item config:name="PrintRightPages" config:type="boolean">true</config:config-item>
<config:config-item config:name="IsLabelDocument" config:type="boolean">false</config:config-item>
<config:config-item config:name="UseFormerLineSpacing" config:type="boolean">false</config:config-item>
<config:config-item config:name="AddParaTableSpacingAtStart" config:type="boolean">true</config:config-item>
<config:config-item config:name="UseFormerTextWrapping" config:type="boolean">false</config:config-item>
<config:config-item config:name="DoNotResetParaAttrsForNumFont" config:type="boolean">false</config:config-item>
<config:config-item config:name="PrintProspect" config:type="boolean">false</config:config-item>
<config:config-item config:name="PrintGraphics" config:type="boolean">true</config:config-item>
<config:config-item config:name="AllowPrintJobCancel" config:type="boolean">true</config:config-item>
<config:config-item config:name="CurrentDatabaseCommandType" config:type="int">0</config:config-item>
<config:config-item config:name="DoNotJustifyLinesWithManualBreak" config:type="boolean">false</config:config-item>
<config:config-item config:name="UseFormerObjectPositioning" config:type="boolean">false</config:config-item>
<config:config-item config:name="PrinterIndependentLayout" config:type="string">high-resolution</config:config-item>
<config:config-item config:name="UseOldNumbering" config:type="boolean">false</config:config-item>
<config:config-item config:name="PrintPageBackground" config:type="boolean">true</config:config-item>
<config:config-item config:name="CurrentDatabaseCommand" config:type="string"/>
<config:config-item config:name="PrintDrawings" config:type="boolean">true</config:config-item>
<config:config-item config:name="PrintBlackFonts" config:type="boolean">false</config:config-item>
<config:config-item config:name="UnxForceZeroExtLeading" config:type="boolean">true</config:config-item>
</config:config-item-set>
</office:settings>
<office:scripts>
<office:script script:language="ooo:Basic">
<ooo:libraries>
<ooo:library-embedded ooo:name="Standard"/>
</ooo:libraries>
</office:script>
</office:scripts>
<office:font-face-decls>
<style:font-face style:name="Nimbus Mono L1" svg:font-family="'Nimbus Mono L', monospace"/>
<style:font-face style:name="StarSymbol" svg:font-family="StarSymbol"/>
<style:font-face style:name="monospace" svg:font-family="monospace"/>
<style:font-face style:name="Monospace" svg:font-family="Monospace" style:font-pitch="fixed"/>
<style:font-face style:name="Nimbus Mono L" svg:font-family="'Nimbus Mono L'" style:font-family-generic="modern" style:font-pitch="fixed"/>
<style:font-face style:name="Arial Unicode MS" svg:font-family="'Arial Unicode MS'" style:font-pitch="variable"/>
<style:font-face style:name="HG Mincho Light J" svg:font-family="'HG Mincho Light J'" style:font-pitch="variable"/>
<style:font-face style:name="Nimbus Roman No9 L" svg:font-family="'Nimbus Roman No9 L'" style:font-family-generic="roman" style:font-pitch="variable"/>
<style:font-face style:name="Thorndale" svg:font-family="Thorndale" style:font-family-generic="roman" style:font-pitch="variable"/>
<style:font-face style:name="Albany" svg:font-family="Albany" style:font-family-generic="swiss" style:font-pitch="variable"/>
<style:font-face style:name="DejaVu LGC Sans" svg:font-family="'DejaVu LGC Sans'" style:font-family-generic="system" style:font-pitch="variable"/>
</office:font-face-decls>
<office:styles>
<style:default-style style:family="graphic">
<style:graphic-properties draw:shadow-offset-x="0.1181in" draw:shadow-offset-y="0.1181in" draw:start-line-spacing-horizontal="0.1114in" draw:start-line-spacing-vertical="0.1114in" draw:end-line-spacing-horizontal="0.1114in" draw:end-line-spacing-vertical="0.1114in" style:flow-with-text="true"/>
<style:paragraph-properties style:text-autospace="ideograph-alpha" style:line-break="strict" style:writing-mode="lr-tb" style:font-independent-line-spacing="false">
<style:tab-stops/>
</style:paragraph-properties>
<style:text-properties fo:color="#000000" fo:font-size="12pt" fo:language="en" fo:country="US" style:letter-kerning="true" style:font-size-asian="12pt" style:language-asian="en" style:country-asian="US" style:font-size-complex="12pt" style:language-complex="en" style:country-complex="US"/>
</style:default-style>
<style:default-style style:family="paragraph">
<style:paragraph-properties fo:hyphenation-ladder-count="no-limit" style:text-autospace="ideograph-alpha" style:punctuation-wrap="hanging" style:line-break="strict" style:tab-stop-distance="0.4925in" style:writing-mode="page"/>
<style:text-properties fo:color="#000000" style:font-name="Nimbus Roman No9 L" fo:font-size="12pt" fo:language="en" fo:country="US" style:letter-kerning="true" style:font-name-asian="DejaVu LGC Sans" style:font-size-asian="12pt" style:language-asian="en" style:country-asian="US" style:font-name-complex="DejaVu LGC Sans" style:font-size-complex="12pt" style:language-complex="en" style:country-complex="US" fo:hyphenate="false" fo:hyphenation-remain-char-count="2" fo:hyphenation-push-char-count="2"/>
</style:default-style>
<style:default-style style:family="table">
<style:table-properties table:border-model="separating"/>
</style:default-style>
<style:default-style style:family="table-row">
<style:table-row-properties fo:keep-together="auto"/>
</style:default-style>
<style:style style:name="Standard" style:family="paragraph" style:class="text">
<style:paragraph-properties fo:margin-top="0.1in" fo:margin-bottom="0.1in"/>
</style:style>
<style:style style:name="Heading" style:family="paragraph" style:parent-style-name="Standard" style:next-style-name="Text_20_body" style:class="text">
<style:paragraph-properties fo:margin-top="0.1665in" fo:margin-bottom="0.1965in" fo:keep-with-next="always"/>
<style:text-properties style:font-name="Albany" fo:font-size="14pt" style:font-name-asian="HG Mincho Light J" style:font-size-asian="14pt" style:font-name-complex="Arial Unicode MS" style:font-size-complex="14pt"/>
</style:style>
<style:style style:name="Text_20_body" style:display-name="Text body" style:family="paragraph" style:parent-style-name="Standard" style:class="text">
<style:paragraph-properties fo:margin-top="0.1in" fo:margin-bottom="0.1in"/>
</style:style>
<style:style style:name="List" style:family="paragraph" style:parent-style-name="Text_20_body" style:class="list"/>
<style:style style:name="Caption" style:family="paragraph" style:parent-style-name="Standard" style:class="extra">
<style:paragraph-properties fo:margin-top="0.0835in" fo:margin-bottom="0.0835in" text:number-lines="false" text:line-number="0"/>
<style:text-properties fo:font-size="12pt" fo:font-style="italic" style:font-size-asian="12pt" style:font-style-asian="italic" style:font-size-complex="12pt" style:font-style-complex="italic"/>
</style:style>
<style:style style:name="Index" style:family="paragraph" style:parent-style-name="Standard" style:class="index">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.0201in" text:number-lines="false" text:line-number="0"/>
</style:style>
<style:style style:name="Heading_20_1" style:display-name="Heading 1" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:auto-update="true" style:class="text" style:default-outline-level="1">
<style:text-properties style:font-name="Thorndale" fo:font-size="24pt" fo:font-weight="bold" style:font-name-asian="HG Mincho Light J" style:font-size-asian="24pt" style:font-weight-asian="bold" style:font-name-complex="Arial Unicode MS" style:font-size-complex="24pt" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Heading_20_2" style:display-name="Heading 2" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:auto-update="true" style:class="text" style:default-outline-level="2">
<style:text-properties style:font-name="Nimbus Roman No9 L" fo:font-size="18pt" fo:font-weight="bold" style:font-name-asian="DejaVu LGC Sans" style:font-size-asian="18pt" style:font-weight-asian="bold" style:font-name-complex="DejaVu LGC Sans" style:font-size-complex="18pt" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Heading_20_3" style:display-name="Heading 3" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:auto-update="true" style:class="text" style:default-outline-level="3">
<style:text-properties style:font-name="Nimbus Roman No9 L" fo:font-size="14pt" fo:font-weight="bold" style:font-name-asian="DejaVu LGC Sans" style:font-size-asian="14pt" style:font-weight-asian="bold" style:font-name-complex="DejaVu LGC Sans" style:font-size-complex="14pt" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Heading_20_4" style:display-name="Heading 4" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:auto-update="true" style:class="text" style:default-outline-level="4">
<style:text-properties style:font-name="Nimbus Roman No9 L" fo:font-size="12pt" fo:font-weight="bold" style:font-name-asian="DejaVu LGC Sans" style:font-size-asian="12pt" style:font-weight-asian="bold" style:font-name-complex="DejaVu LGC Sans" style:font-size-complex="12pt" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Header" style:family="paragraph" style:parent-style-name="Standard" style:class="extra">
<style:paragraph-properties text:number-lines="false" text:line-number="0">
<style:tab-stops>
<style:tab-stop style:position="3.3457in" style:type="center"/>
<style:tab-stop style:position="6.6925in" style:type="right"/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Footer" style:family="paragraph" style:parent-style-name="Standard" style:class="extra">
<style:paragraph-properties text:number-lines="false" text:line-number="0">
<style:tab-stops>
<style:tab-stop style:position="3.3457in" style:type="center"/>
<style:tab-stop style:position="6.6925in" style:type="right"/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Table_20_Contents" style:display-name="Table Contents" style:family="paragraph" style:parent-style-name="Text_20_body" style:class="extra"/>
<style:style style:name="Table_20_Heading" style:display-name="Table Heading" style:family="paragraph" style:parent-style-name="Table_20_Contents" style:class="extra">
<style:paragraph-properties fo:text-align="center" style:justify-single-word="false" text:number-lines="false" text:line-number="0"/>
<style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Sender" style:family="paragraph" style:parent-style-name="Standard" style:class="extra">
<style:text-properties fo:font-style="italic"/>
</style:style>
<style:style style:name="Contents_20_Heading" style:display-name="Contents Heading" style:family="paragraph" style:parent-style-name="Heading" style:class="index">
<style:paragraph-properties fo:margin-left="0in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false" text:number-lines="false" text:line-number="0"/>
<style:text-properties fo:font-size="16pt" fo:font-weight="bold" style:font-size-asian="16pt" style:font-weight-asian="bold" style:font-size-complex="16pt" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Contents_20_1" style:display-name="Contents 1" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="0in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="6.9252in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Contents_20_2" style:display-name="Contents 2" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="0.1965in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="6.7283in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Contents_20_3" style:display-name="Contents 3" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="0.3929in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="6.5319in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Contents_20_4" style:display-name="Contents 4" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="0.5898in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="6.3354in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Title" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Subtitle" style:class="chapter">
<style:paragraph-properties fo:text-align="center" style:justify-single-word="false"/>
<style:text-properties fo:font-size="18pt" fo:font-weight="bold" style:font-size-asian="18pt" style:font-weight-asian="bold" style:font-size-complex="18pt" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Subtitle" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:class="chapter">
<style:paragraph-properties fo:text-align="center" style:justify-single-word="false"/>
<style:text-properties fo:font-size="14pt" fo:font-style="italic" style:font-size-asian="14pt" style:font-style-asian="italic" style:font-size-complex="14pt" style:font-style-complex="italic"/>
</style:style>
<style:style style:name="Preformatted_20_Text" style:display-name="Preformatted Text" style:family="paragraph" style:parent-style-name="Standard" style:class="html">
<style:paragraph-properties fo:margin-left="0.5in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false" fo:background-color="#e6e6e6" fo:padding="0.0201in" fo:border="0.0071in solid #000000" style:shadow="none">
<style:background-image/>
</style:paragraph-properties>
<style:text-properties style:font-name="Nimbus Mono L" fo:font-size="10pt" style:font-name-asian="Nimbus Mono L" style:font-size-asian="10pt" style:font-name-complex="Nimbus Mono L" style:font-size-complex="10pt"/>
</style:style>
<style:style style:name="Horizontal_20_Line" style:display-name="Horizontal Line" style:family="paragraph" style:parent-style-name="Standard" style:next-style-name="Text_20_body" style:class="html">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.1965in" style:border-line-width-bottom="0.0008in 0.0138in 0.0008in" fo:padding="0in" fo:border-left="none" fo:border-right="none" fo:border-top="none" fo:border-bottom="0.0154in double #808080"/>
<style:text-properties fo:font-size="6pt"/>
</style:style>
<style:style style:name="List_20_Contents" style:display-name="List Contents" style:family="paragraph" style:parent-style-name="Standard" style:class="html">
<style:paragraph-properties fo:margin-left="0.3937in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="Signature" style:family="paragraph" style:parent-style-name="Standard" style:class="text">
<style:paragraph-properties text:number-lines="false" text:line-number="0"/>
</style:style>
<style:style style:name="Contents_20_5" style:display-name="Contents 5" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="0.7862in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="6.139in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Contents_20_6" style:display-name="Contents 6" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="0.9827in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="5.9425in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Contents_20_7" style:display-name="Contents 7" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="1.1791in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="5.7457in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Contents_20_8" style:display-name="Contents 8" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="1.3756in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="5.5492in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Contents_20_9" style:display-name="Contents 9" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="1.572in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="5.3528in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Contents_20_10" style:display-name="Contents 10" style:family="paragraph" style:parent-style-name="Index" style:class="index">
<style:paragraph-properties fo:margin-left="1.7689in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0in" fo:text-indent="0in" style:auto-text-indent="false">
<style:tab-stops>
<style:tab-stop style:position="5.1563in" style:type="right" style:leader-style="dotted" style:leader-text="."/>
</style:tab-stops>
</style:paragraph-properties>
</style:style>
<style:style style:name="Heading_20_5" style:display-name="Heading 5" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:auto-update="true" style:class="text" style:default-outline-level="5">
<style:text-properties fo:font-size="85%" fo:font-weight="bold" style:font-size-asian="85%" style:font-weight-asian="bold" style:font-size-complex="85%" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Heading_20_6" style:display-name="Heading 6" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:auto-update="true" style:class="text" style:default-outline-level="6">
<style:text-properties fo:font-size="75%" fo:font-weight="bold" style:font-size-asian="75%" style:font-weight-asian="bold" style:font-size-complex="75%" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Heading_20_7" style:display-name="Heading 7" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:auto-update="true" style:class="text" style:default-outline-level="7">
<style:text-properties fo:font-size="75%" fo:font-weight="bold" style:font-size-asian="75%" style:font-weight-asian="bold" style:font-size-complex="75%" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Heading_20_8" style:display-name="Heading 8" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:auto-update="true" style:class="text" style:default-outline-level="8">
<style:text-properties fo:font-size="75%" fo:font-weight="bold" style:font-size-asian="75%" style:font-weight-asian="bold" style:font-size-complex="75%" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Heading_20_9" style:display-name="Heading 9" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:auto-update="true" style:class="text" style:default-outline-level="9">
<style:text-properties fo:font-size="75%" fo:font-weight="bold" style:font-size-asian="75%" style:font-weight-asian="bold" style:font-size-complex="75%" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Heading_20_10" style:display-name="Heading 10" style:family="paragraph" style:parent-style-name="Heading" style:next-style-name="Text_20_body" style:class="text" style:default-outline-level="10">
<style:text-properties fo:font-size="75%" fo:font-weight="bold" style:font-size-asian="75%" style:font-weight-asian="bold" style:font-size-complex="75%" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Footnote_20_Symbol" style:display-name="Footnote Symbol" style:family="text"/>
<style:style style:name="Numbering_20_Symbols" style:display-name="Numbering Symbols" style:family="text"/>
<style:style style:name="Bullet_20_Symbols" style:display-name="Bullet Symbols" style:family="text">
<style:text-properties style:font-name="StarSymbol" fo:font-size="9pt" style:font-name-asian="StarSymbol" style:font-size-asian="9pt" style:font-name-complex="StarSymbol" style:font-size-complex="9pt"/>
</style:style>
<style:style style:name="Internet_20_link" style:display-name="Internet link" style:family="text">
<style:text-properties fo:color="#000080" style:text-underline-style="solid" style:text-underline-width="auto" style:text-underline-color="font-color"/>
</style:style>
<style:style style:name="Visited_20_Internet_20_Link" style:display-name="Visited Internet Link" style:family="text">
<style:text-properties fo:color="#800000" style:text-underline-style="solid" style:text-underline-width="auto" style:text-underline-color="font-color"/>
</style:style>
<style:style style:name="Endnote_20_Symbol" style:display-name="Endnote Symbol" style:family="text"/>
<style:style style:name="Emphasis" style:family="text">
<style:text-properties fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic"/>
</style:style>
<style:style style:name="Strong_20_Emphasis" style:display-name="Strong Emphasis" style:family="text">
<style:text-properties fo:color="#800000" fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="Source_20_Text" style:display-name="Source Text" style:family="text">
<style:text-properties fo:font-weight="bold" fo:background-color="transparent"/>
</style:style>
<style:style style:name="Variable" style:family="text">
<style:text-properties fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic"/>
</style:style>
<style:style style:name="Rubies" style:family="text">
<style:text-properties fo:font-size="6pt" style:text-underline-style="none" style:font-size-asian="6pt" style:font-size-complex="6pt" style:text-emphasize="none"/>
</style:style>
<style:style style:name="Drop_20_Caps" style:display-name="Drop Caps" style:family="text"/>
<style:style style:name="Line_20_numbering" style:display-name="Line numbering" style:family="text"/>
<style:style style:name="Frame" style:family="graphic">
<style:graphic-properties text:anchor-type="as-char" svg:y="0in" style:wrap="none" style:vertical-pos="middle" style:vertical-rel="line"/>
</style:style>
<style:style style:name="Graphics" style:family="graphic">
<style:graphic-properties text:anchor-type="paragraph" svg:x="0in" svg:y="0in" style:wrap="none" style:vertical-pos="top" style:vertical-rel="paragraph" style:horizontal-pos="center" style:horizontal-rel="paragraph"/>
</style:style>
<style:style style:name="OLE" style:family="graphic">
<style:graphic-properties text:anchor-type="paragraph" svg:x="0in" svg:y="0in" style:wrap="none" style:vertical-pos="top" style:vertical-rel="paragraph" style:horizontal-pos="center" style:horizontal-rel="paragraph"/>
</style:style>
<text:outline-style>
<text:outline-level-style text:level="1" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1"/>
<text:outline-level-style text:level="2" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1" text:display-levels="2"/>
<text:outline-level-style text:level="3" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1" text:display-levels="3"/>
<text:outline-level-style text:level="4" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1" text:display-levels="4"/>
<text:outline-level-style text:level="5" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1" text:display-levels="5"/>
<text:outline-level-style text:level="6" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1" text:display-levels="6"/>
<text:outline-level-style text:level="7" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1" text:display-levels="7"/>
<text:outline-level-style text:level="8" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1" text:display-levels="8"/>
<text:outline-level-style text:level="9" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1" text:display-levels="9"/>
<text:outline-level-style text:level="10" text:style-name="Numbering_20_Symbols" style:num-prefix=" " style:num-suffix=" " style:num-format="1" text:display-levels="10"/>
</text:outline-style>
<text:notes-configuration text:note-class="footnote" text:citation-style-name="Footnote_20_Symbol" style:num-format="1" text:start-value="0" text:footnotes-position="page" text:start-numbering-at="document"/>
<text:notes-configuration text:note-class="endnote" text:citation-style-name="Endnote_20_Symbol" text:master-page-name="Endnote" style:num-format="i" text:start-value="0"/>
<text:linenumbering-configuration text:style-name="Line_20_numbering" text:number-lines="false" text:offset="0.1965in" style:num-format="1" text:number-position="left" text:increment="5"/>
</office:styles>
<office:automatic-styles>
<style:style style:name="Table1" style:family="table">
<style:table-properties style:width="12.959in" table:align="left"/>
</style:style>
<style:style style:name="Table1.A" style:family="table-column">
<style:table-column-properties style:column-width="2.3208in"/>
</style:style>
<style:style style:name="Table1.B" style:family="table-column">
<style:table-column-properties style:column-width="10.6382in"/>
</style:style>
<style:style style:name="Table1.A1" style:family="table-cell">
<style:table-cell-properties style:vertical-align="middle" style:border-line-width-left="0.0007in 0.0347in 0.0007in" style:border-line-width-top="0.0007in 0.0347in 0.0007in" style:border-line-width-bottom="0.0007in 0.0347in 0.0007in" fo:padding="0.0208in" fo:border-left="0.0361in double #808080" fo:border-right="none" fo:border-top="0.0361in double #808080" fo:border-bottom="0.0361in double #808080"/>
</style:style>
<style:style style:name="Table1.B1" style:family="table-cell">
<style:table-cell-properties style:vertical-align="middle" style:border-line-width="0.0007in 0.0347in 0.0007in" fo:padding="0.0208in" fo:border="0.0361in double #808080"/>
</style:style>
<style:style style:name="Table1.A2" style:family="table-cell">
<style:table-cell-properties style:vertical-align="middle" style:border-line-width-left="0.0007in 0.0347in 0.0007in" style:border-line-width-bottom="0.0007in 0.0347in 0.0007in" fo:padding="0.0208in" fo:border-left="0.0361in double #808080" fo:border-right="none" fo:border-top="none" fo:border-bottom="0.0361in double #808080"/>
</style:style>
<style:style style:name="Table1.B2" style:family="table-cell">
<style:table-cell-properties style:vertical-align="middle" style:border-line-width-left="0.0007in 0.0347in 0.0007in" style:border-line-width-right="0.0007in 0.0347in 0.0007in" style:border-line-width-bottom="0.0007in 0.0347in 0.0007in" fo:padding="0.0208in" fo:border-left="0.0361in double #808080" fo:border-right="0.0361in double #808080" fo:border-top="none" fo:border-bottom="0.0361in double #808080"/>
</style:style>
<style:style style:name="P1" style:family="paragraph" style:parent-style-name="Text_20_body">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P2" style:family="paragraph" style:parent-style-name="Preformatted_20_Text">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P3" style:family="paragraph" style:parent-style-name="Standard">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P4" style:family="paragraph" style:parent-style-name="Preformatted_20_Text">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.2in"/>
</style:style>
<style:style style:name="P5" style:family="paragraph" style:parent-style-name="Preformatted_20_Text">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.1965in"/>
</style:style>
<style:style style:name="P6" style:family="paragraph" style:parent-style-name="Preformatted_20_Text">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.1965in"/>
<style:text-properties style:font-name="Nimbus Mono L1"/>
</style:style>
<style:style style:name="P7" style:family="paragraph" style:parent-style-name="Text_20_body">
<style:paragraph-properties fo:margin-left="0.4201in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P8" style:family="paragraph" style:parent-style-name="Contents_20_2">
<style:paragraph-properties>
<style:tab-stops/>
</style:paragraph-properties>
</style:style>
<style:style style:name="P9" style:family="paragraph" style:parent-style-name="Contents_20_3">
<style:paragraph-properties>
<style:tab-stops/>
</style:paragraph-properties>
</style:style>
<style:style style:name="P10" style:family="paragraph" style:parent-style-name="Contents_20_4">
<style:paragraph-properties>
<style:tab-stops/>
</style:paragraph-properties>
</style:style>
<style:style style:name="P11" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P12" style:family="paragraph" style:parent-style-name="Preformatted_20_Text">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P13" style:family="paragraph" style:parent-style-name="Preformatted_20_Text">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0.1965in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P14" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P15" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P16" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P17" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P18" style:family="paragraph" style:parent-style-name="Signature">
<style:paragraph-properties fo:text-align="center" style:justify-single-word="false"/>
</style:style>
<style:style style:name="P19" style:family="paragraph" style:parent-style-name="Preformatted_20_Text">
<style:paragraph-properties fo:margin-left="0in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P20" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P21" style:family="paragraph" style:parent-style-name="Contents_20_1">
<style:paragraph-properties>
<style:tab-stops/>
</style:paragraph-properties>
</style:style>
<style:style style:name="P22" style:family="paragraph" style:parent-style-name="Text_20_body">
<style:paragraph-properties fo:margin-left="-0.4925in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P23" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P24" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P25" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P26" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P27" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P28" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P29" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P30" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P31" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P32" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P33" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P34" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L1"/>
<style:style style:name="P35" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L2"/>
<style:style style:name="P36" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L6"/>
<style:style style:name="P37" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7"/>
<style:style style:name="P38" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7"/>
<style:style style:name="P39" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7"/>
<style:style style:name="P40" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7"/>
<style:style style:name="P41" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7"/>
<style:style style:name="P42" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L8"/>
<style:style style:name="P43" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L9"/>
<style:style style:name="P44" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L9"/>
<style:style style:name="P45" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L9"/>
<style:style style:name="P46" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L9"/>
<style:style style:name="P47" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L9"/>
<style:style style:name="P48" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L9"/>
<style:style style:name="P49" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L10"/>
<style:style style:name="P50" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L10"/>
<style:style style:name="P51" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L10"/>
<style:style style:name="P52" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L11"/>
<style:style style:name="P53" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L12"/>
<style:style style:name="P54" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L13"/>
<style:style style:name="P55" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L14"/>
<style:style style:name="P56" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L15"/>
<style:style style:name="P57" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L16"/>
<style:style style:name="P58" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L18"/>
<style:style style:name="P59" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L19"/>
<style:style style:name="P60" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L20"/>
<style:style style:name="P61" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L20"/>
<style:style style:name="P62" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L20"/>
<style:style style:name="P63" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L21"/>
<style:style style:name="P64" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22"/>
<style:style style:name="P65" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22"/>
<style:style style:name="P66" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22"/>
<style:style style:name="P67" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22"/>
<style:style style:name="P68" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22"/>
<style:style style:name="P69" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L23"/>
<style:style style:name="P70" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L23"/>
<style:style style:name="P71" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L24"/>
<style:style style:name="P72" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L1">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P73" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L1">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P74" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L2">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P75" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L2">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P76" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L2">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P77" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L3">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P78" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L3">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P79" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L3">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P80" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L3">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P81" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L3">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P82" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P83" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P84" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P85" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P86" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P87" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P88" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P89" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P90" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P91" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L5">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P92" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P93" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P94" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P95" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P96" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P97" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P98" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P99" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P100" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P101" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P102" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P103" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P104" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P105" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P106" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P107" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L8">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P108" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L8">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P109" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L8">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P110" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L9">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P111" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L9">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P112" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L9">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P113" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L11">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P114" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L11">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P115" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L12">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P116" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L13">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P117" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L13">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P118" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L14">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P119" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L14">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P120" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L15">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P121" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L15">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P122" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L15">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P123" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L15">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P124" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L16">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P125" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L16">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P126" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L18">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P127" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L18">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P128" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L18">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P129" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L18">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P130" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L18">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P131" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L18">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P132" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L18">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P133" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L19">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P134" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L19">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P135" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L19">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P136" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L19">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P137" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L19">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P138" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L20">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P139" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L21">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P140" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L21">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P141" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P142" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P143" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P144" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P145" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P146" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P147" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P148" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P149" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P150" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P151" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L24">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P152" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L24">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P153" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L17">
<style:paragraph-properties fo:margin-left="-0.4925in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P154" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L17">
<style:paragraph-properties fo:margin-left="-0.4925in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P155" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L17">
<style:paragraph-properties fo:margin-left="-0.4925in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P156" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L17">
<style:paragraph-properties fo:margin-left="-0.4925in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P157" style:family="paragraph" style:parent-style-name="Text_20_body" style:list-style-name="L17">
<style:paragraph-properties fo:margin-left="-0.4925in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P158" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L7"/>
<style:style style:name="P159" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L7"/>
<style:style style:name="P160" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L8"/>
<style:style style:name="P161" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L9"/>
<style:style style:name="P162" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L9"/>
<style:style style:name="P163" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L9"/>
<style:style style:name="P164" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L9"/>
<style:style style:name="P165" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L9"/>
<style:style style:name="P166" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L22"/>
<style:style style:name="P167" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P168" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P169" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P170" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P171" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P172" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P173" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P174" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P175" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P176" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P177" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P178" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P179" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P180" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P181" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P182" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P183" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P184" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P185" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P186" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P187" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P188" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P189" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P190" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P191" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P192" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P193" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23"/>
<style:style style:name="P194" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.2in"/>
</style:style>
<style:style style:name="P195" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.2in"/>
</style:style>
<style:style style:name="P196" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L7">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.2in"/>
</style:style>
<style:style style:name="P197" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L9">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.2in"/>
</style:style>
<style:style style:name="P198" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L20">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.2in"/>
</style:style>
<style:style style:name="P199" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.2in"/>
</style:style>
<style:style style:name="P200" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.2in"/>
</style:style>
<style:style style:name="P201" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L9">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P202" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L20">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.1965in"/>
<style:text-properties style:font-name="Nimbus Mono L1"/>
</style:style>
<style:style style:name="P203" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.1965in"/>
</style:style>
<style:style style:name="P204" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L22">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.1965in"/>
</style:style>
<style:style style:name="P205" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0.1965in"/>
</style:style>
<style:style style:name="P206" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P207" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P208" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P209" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P210" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P211" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P212" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P213" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P214" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P215" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P216" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P217" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P218" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P219" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P220" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P221" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P222" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P223" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P224" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P225" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P226" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P227" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P228" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P229" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P230" style:family="paragraph" style:parent-style-name="Preformatted_20_Text" style:list-style-name="L23">
<style:paragraph-properties fo:margin-left="1in" fo:margin-right="0in" fo:margin-top="0in" fo:margin-bottom="0.1965in" fo:text-indent="0in" style:auto-text-indent="false"/>
</style:style>
<style:style style:name="P231" style:family="paragraph" style:parent-style-name="Title" style:master-page-name="HTML">
<style:paragraph-properties style:page-number="auto"/>
</style:style>
<style:style style:name="P232" style:family="paragraph" style:parent-style-name="Standard" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="P233" style:family="paragraph" style:parent-style-name="Standard" style:list-style-name="L4">
<style:paragraph-properties fo:margin-top="0in" fo:margin-bottom="0in"/>
</style:style>
<style:style style:name="T1" style:family="text">
<style:text-properties fo:font-weight="bold"/>
</style:style>
<style:style style:name="T2" style:family="text">
<style:text-properties fo:font-weight="bold" style:font-weight-asian="bold" style:font-weight-complex="bold"/>
</style:style>
<style:style style:name="T3" style:family="text">
<style:text-properties fo:font-style="italic"/>
</style:style>
<style:style style:name="T4" style:family="text">
<style:text-properties fo:font-style="italic" fo:font-weight="bold"/>
</style:style>
<style:style style:name="T5" style:family="text">
<style:text-properties fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic"/>
</style:style>
<style:style style:name="T6" style:family="text">
<style:text-properties style:font-name="monospace"/>
</style:style>
<style:style style:name="T7" style:family="text">
<style:text-properties style:font-name="monospace" fo:font-style="italic"/>
</style:style>
<style:style style:name="T8" style:family="text">
<style:text-properties style:text-underline-style="solid" style:text-underline-width="auto" style:text-underline-color="font-color"/>
</style:style>
<style:style style:name="T9" style:family="text">
<style:text-properties style:font-name="Nimbus Mono L"/>
</style:style>
<style:style style:name="T10" style:family="text">
<style:text-properties style:font-name="Nimbus Mono L" fo:font-style="italic"/>
</style:style>
<style:style style:name="T11" style:family="text">
<style:text-properties style:font-name="Nimbus Mono L1"/>
</style:style>
<style:style style:name="T12" style:family="text">
<style:text-properties style:font-name="Nimbus Mono L1" fo:font-style="italic"/>
</style:style>
<style:style style:name="T13" style:family="text">
<style:text-properties fo:font-weight="normal" style:font-weight-asian="normal" style:font-weight-complex="normal"/>
</style:style>
<style:style style:name="T14" style:family="text">
<style:text-properties fo:color="#000000" style:font-name="Nimbus Mono L" fo:font-size="10pt" fo:font-style="italic" style:font-name-asian="Monospace" style:font-size-asian="10pt" style:font-style-asian="italic" style:font-name-complex="Monospace" style:font-size-complex="10pt" style:font-style-complex="italic"/>
</style:style>
<style:style style:name="T15" style:family="text">
<style:text-properties fo:color="#000000" style:font-name="Nimbus Mono L" fo:font-size="10pt" style:font-name-asian="Monospace" style:font-size-asian="10pt" style:font-name-complex="Monospace" style:font-size-complex="10pt"/>
</style:style>
<style:style style:name="T16" style:family="text">
<style:text-properties fo:color="#000000" style:font-name="Nimbus Mono L" fo:font-size="10pt" fo:font-style="normal" style:font-name-asian="Monospace" style:font-size-asian="10pt" style:font-style-asian="normal" style:font-name-complex="Monospace" style:font-size-complex="10pt" style:font-style-complex="normal"/>
</style:style>
<style:style style:name="T17" style:family="text">
<style:text-properties fo:font-style="normal" style:font-style-asian="normal" style:font-style-complex="normal"/>
</style:style>
<style:style style:name="Sect1" style:family="section">
<style:section-properties fo:background-color="transparent" style:editable="false">
<style:columns fo:column-count="1" fo:column-gap="0in"/>
<style:background-image/>
</style:section-properties>
</style:style>
<style:style style:name="Sect2" style:family="section">
<style:section-properties style:editable="false">
<style:columns fo:column-count="1" fo:column-gap="0in"/>
</style:section-properties>
</style:style>
<text:list-style style:name="L1">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L2">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L3">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L4">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L5">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.3035in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-number text:level="2" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.5in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.75in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.25in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.5in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.75in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.25in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.5in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L6">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.3035in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-number text:level="2" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.5in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.75in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.25in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.5in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.75in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.25in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.5in" text:min-label-width="0.25in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L7">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L8">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L9">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L10">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L11">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L12">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L13">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L14">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L15">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L16">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L17">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â—">
<style:list-level-properties text:space-before="0.25in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â—‹">
<style:list-level-properties text:space-before="0.5in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â– ">
<style:list-level-properties text:space-before="0.75in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â—">
<style:list-level-properties text:space-before="1in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â—‹">
<style:list-level-properties text:space-before="1.25in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â– ">
<style:list-level-properties text:space-before="1.5in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â—">
<style:list-level-properties text:space-before="1.75in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â—‹">
<style:list-level-properties text:space-before="2in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â– ">
<style:list-level-properties text:space-before="2.25in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â—">
<style:list-level-properties text:space-before="2.5in" text:min-label-width="0.25in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L18">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L19">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L20">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L21">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L22">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<text:list-style style:name="L23">
<text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
<text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" style:num-suffix="." text:bullet-char="â€¢">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
<style:text-properties style:font-name="StarSymbol"/>
</text:list-level-style-bullet>
</text:list-style>
<text:list-style style:name="L24">
<text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.2945in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="0.7854in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.2764in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="1.7673in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.2583in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="2.7492in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.2402in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="3.7315in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.2224in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
<text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1">
<style:list-level-properties text:space-before="4.7134in" text:min-label-width="0.1965in"/>
</text:list-level-style-number>
</text:list-style>
<style:page-layout style:name="pm1">
<style:page-layout-properties fo:page-width="8.5in" fo:page-height="11in" style:num-format="1" style:print-orientation="portrait" fo:margin-top="0.7874in" fo:margin-bottom="0.7874in" fo:margin-left="0.7874in" fo:margin-right="0.7874in" style:writing-mode="lr-tb" style:footnote-max-height="0in">
<style:footnote-sep style:width="0.0071in" style:distance-before-sep="0.0398in" style:distance-after-sep="0.0398in" style:adjustment="left" style:rel-width="25%" style:color="#000000"/>
</style:page-layout-properties>
<style:header-style/>
<style:footer-style/>
</style:page-layout>
<style:page-layout style:name="pm2">
<style:page-layout-properties fo:page-width="8.5in" fo:page-height="11in" style:num-format="1" style:print-orientation="portrait" fo:margin-top="0.3937in" fo:margin-bottom="0.3937in" fo:margin-left="0.7874in" fo:margin-right="0.3937in" fo:background-color="transparent" style:writing-mode="lr-tb" style:footnote-max-height="0in">
<style:background-image/>
<style:footnote-sep style:width="0.0071in" style:distance-before-sep="0.0398in" style:distance-after-sep="0.0398in" style:adjustment="left" style:rel-width="25%" style:color="#000000"/>
</style:page-layout-properties>
<style:header-style/>
<style:footer-style/>
</style:page-layout>
<style:page-layout style:name="pm3">
<style:page-layout-properties fo:page-width="8.5in" fo:page-height="11in" style:num-format="1" style:print-orientation="portrait" fo:margin-top="0.7874in" fo:margin-bottom="0.7874in" fo:margin-left="0.7874in" fo:margin-right="0.7874in" style:writing-mode="lr-tb" style:footnote-max-height="0in">
<style:footnote-sep style:adjustment="left" style:rel-width="25%" style:color="#000000"/>
</style:page-layout-properties>
<style:header-style/>
<style:footer-style/>
</style:page-layout>
<number:date-style style:name="N37" number:automatic-order="true">
<number:month number:style="long"/>
<number:text>/</number:text>
<number:day number:style="long"/>
<number:text>/</number:text>
<number:year/>
</number:date-style>
<number:time-style style:name="N116">
<number:hours number:style="long"/>
<number:text>:</number:text>
<number:minutes number:style="long"/>
<number:text>:</number:text>
<number:seconds number:style="long"/>
<number:am-pm/>
</number:time-style>
</office:automatic-styles>
<office:master-styles>
<style:master-page style:name="Standard" style:page-layout-name="pm1"/>
<style:master-page style:name="HTML" style:page-layout-name="pm2"/>
<style:master-page style:name="Endnote" style:page-layout-name="pm3"/>
</office:master-styles>
<office:body>
<office:text>
<office:forms form:automatic-focus="false" form:apply-design-mode="false"/>
<text:sequence-decls>
<text:sequence-decl text:display-outline-level="0" text:name="Illustration"/>
<text:sequence-decl text:display-outline-level="0" text:name="Table"/>
<text:sequence-decl text:display-outline-level="0" text:name="Text"/>
<text:sequence-decl text:display-outline-level="0" text:name="Drawing"/>
</text:sequence-decls>
<text:p text:style-name="P231">
<text:bookmark text:name="mozTocId101532"/>NeatUploadâ„¢ Manual</text:p>
<text:p text:style-name="P18">
<text:span text:style-name="Emphasis">
<text:span text:style-name="T17">by </text:span>
</text:span>
<text:a xlink:type="simple" xlink:href="http://www.brettle.com/">
<text:span text:style-name="Emphasis">
<text:span text:style-name="T17">Dean Brettle</text:span>
</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="http://www.brettle.com/">
<text:span text:style-name="Emphasis"/>
</text:a>
<text:a xlink:type="simple" xlink:href="http://www.brettle.com/">
<text:span text:style-name="T17">
<text:line-break/>
</text:span>
</text:a>
<text:span text:style-name="Emphasis">
<text:span text:style-name="T17">Last updated </text:span>
</text:span>
<text:span text:style-name="Emphasis">
<text:span text:style-name="T17">
<text:date style:data-style-name="N37" text:date-value="2008-10-27T15:44:50.99">10/27/08</text:date>
</text:span>
</text:span>
<text:span text:style-name="Emphasis">
<text:span text:style-name="T17"/>
</text:span>
<text:span text:style-name="Emphasis">
<text:span text:style-name="T17">
<text:time style:data-style-name="N116" text:time-value="2008-10-27T15:44:50.99">03:44:51PM</text:time>
</text:span>
</text:span>
<text:span text:style-name="Emphasis">
<text:span text:style-name="T17"/>
</text:span>
</text:p>
<text:table-of-content text:style-name="Sect1" text:protected="true" text:name="Table of Contents1">
<text:table-of-content-source text:outline-level="10">
<text:index-title-template text:style-name="Contents_20_Heading">Table of Contents</text:index-title-template>
<text:table-of-content-entry-template text:outline-level="1" text:style-name="Contents_20_1">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
<text:table-of-content-entry-template text:outline-level="2" text:style-name="Contents_20_2">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
<text:table-of-content-entry-template text:outline-level="3" text:style-name="Contents_20_3">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
<text:table-of-content-entry-template text:outline-level="4" text:style-name="Contents_20_4">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
<text:table-of-content-entry-template text:outline-level="5" text:style-name="Contents_20_5">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
<text:table-of-content-entry-template text:outline-level="6" text:style-name="Contents_20_6">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
<text:table-of-content-entry-template text:outline-level="7" text:style-name="Contents_20_7">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
<text:table-of-content-entry-template text:outline-level="8" text:style-name="Contents_20_8">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
<text:table-of-content-entry-template text:outline-level="9" text:style-name="Contents_20_9">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
<text:table-of-content-entry-template text:outline-level="10" text:style-name="Contents_20_10">
<text:index-entry-chapter/>
<text:index-entry-link-start text:style-name="Internet_20_link"/>
<text:index-entry-text/>
<text:index-entry-link-end/>
</text:table-of-content-entry-template>
</text:table-of-content-source>
<text:index-body>
<text:index-title text:style-name="Sect2" text:name="Table of Contents1_Head">
<text:p text:style-name="Contents_20_Heading">Table of Contents</text:p>
</text:index-title>
<text:p text:style-name="P21">
<text:s/>1 <text:a xlink:type="simple" xlink:href="#1.Introduction|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Introduction</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>1.1 <text:a xlink:type="simple" xlink:href="#1.1.Requirements|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Requirements</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>1.2 <text:a xlink:type="simple" xlink:href="#1.2.Branding, Licensing, and the Trademark|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Branding, Licensing, and the Trademark</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>1.3 <text:a xlink:type="simple" xlink:href="#1.3.Version Numbering|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Version Numbering</text:a>
</text:p>
<text:p text:style-name="P21">
<text:s/>2 <text:a xlink:type="simple" xlink:href="#2.Release Notes for NeatUpload-1.3.x|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Release Notes for NeatUpload-1.3.x</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>2.1 <text:a xlink:type="simple" xlink:href="#2.1.Upgrading from NeatUpload-1.2.x and NeatUpload-1.1.x|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Upgrading from NeatUpload-1.2.x and NeatUpload-1.1.x</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>2.2 <text:a xlink:type="simple" xlink:href="#2.2.Upgrading from NeatUpload-1.0.x|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Upgrading from NeatUpload-1.0.x</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>2.3 <text:a xlink:type="simple" xlink:href="#2.3.New Features in NeatUpload-1.3|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">New Features in NeatUpload-1.3</text:a>
</text:p>
<text:p text:style-name="P21">
<text:s/>3 <text:a xlink:type="simple" xlink:href="#3.Usage|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Usage</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.1 <text:a xlink:type="simple" xlink:href="#3.1.Installing NeatUpload|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Installing NeatUpload</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.2 <text:a xlink:type="simple" xlink:href="#3.2.Using NeatUpload with the Visual Studio Web Form Designer|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Using NeatUpload with the Visual Studio Web Form Designer</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.3 <text:a xlink:type="simple" xlink:href="#3.3.Using NeatUpload without the Visual Studio Web Form Designer|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Using NeatUpload without the Visual Studio Web Form Designer</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.4 <text:a xlink:type="simple" xlink:href="#3.4.Allowing Users with Flash to Select Multiple Files from One File Selection Dialog|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Allowing Users with Flash to Select Multiple Files from One File Selection Dialog</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.5 <text:a xlink:type="simple" xlink:href="#3.5.Validating File Names|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Validating File Names</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.6 <text:a xlink:type="simple" xlink:href="#3.6.Preventing Accidental Upload Interruptions|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Preventing Accidental Upload Interruptions</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.7 <text:a xlink:type="simple" xlink:href="#3.7.Avoiding Unnecessary Uploads and Progress Displays|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Avoiding Unnecessary Uploads and Progress Displays</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.8 <text:a xlink:type="simple" xlink:href="#3.8.Showing Processing Progress|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Showing Processing Progress</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.9 <text:a xlink:type="simple" xlink:href="#3.9.Uploading without InputFile |outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Uploading without InputFile </text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>3.10 <text:a xlink:type="simple" xlink:href="#3.10.Uploading from a Client Application|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Uploading from a Client Application</text:a>
</text:p>
<text:p text:style-name="P21">
<text:s/>4 <text:a xlink:type="simple" xlink:href="#4.Configuration|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Configuration</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.1 <text:a xlink:type="simple" xlink:href="#4.1.Using the &lt;neatUpload&gt; Configuration Section|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Using the &lt;neatUpload&gt; Configuration Section</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.2 <text:a xlink:type="simple" xlink:href="#4.2.Changing the Temporary Directory Used by the FilesystemUploadStorageProvider|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Changing the Temporary Directory Used by the FilesystemUploadStorageProvider</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.3 <text:a xlink:type="simple" xlink:href="#4.3.Supporting Web Gardens and Web Farms|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Supporting Web Gardens and Web Farms</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.4 <text:a xlink:type="simple" xlink:href="#4.4.Using Location Filtering to Restrict/Modify NeatUpload's Request Processing|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Using Location Filtering to Restrict/Modify NeatUpload's Request Processing</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.5 <text:a xlink:type="simple" xlink:href="#4.5.Limiting the Size of Upload Requests|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Limiting the Size of Upload Requests</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.6 <text:a xlink:type="simple" xlink:href="#4.6.Changing the Maximum Size of Normal Requests|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Changing the Maximum Size of Normal Requests</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.7 <text:a xlink:type="simple" xlink:href="#4.7.Limiting the Upload Rate|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Limiting the Upload Rate</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.8 <text:a xlink:type="simple" xlink:href="#4.8.Configuring Individual InputFile and MultiFile Controls Programmatically|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Configuring Individual InputFile and MultiFile Controls Programmatically</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.9 <text:a xlink:type="simple" xlink:href="#4.9.Reducing Server Load|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Reducing Server Load</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.10 <text:a xlink:type="simple" xlink:href="#4.10.Changing the Location of NeatUpload's Files|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Changing the Location of NeatUpload's Files</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>4.11 <text:a xlink:type="simple" xlink:href="#4.11.Changing the Query String Parameter Used When Uploading From Client Applications|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Changing the Query String Parameter Used When Uploading From Client Applications</text:a>
</text:p>
<text:p text:style-name="P21">
<text:s/>5 <text:a xlink:type="simple" xlink:href="#5.Customization|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Customization</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>5.1 <text:a xlink:type="simple" xlink:href="#5.1.Customizing Progress.aspx |outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Customizing Progress.aspx </text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>5.2 <text:a xlink:type="simple" xlink:href="#5.2.Creating Custom Fallback Content for ProgressBar |outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Creating Custom Fallback Content for ProgressBar </text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>5.3 <text:a xlink:type="simple" xlink:href="#5.3.Advanced Progress Bar Customization|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Advanced Progress Bar Customization</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>5.4 <text:a xlink:type="simple" xlink:href="#5.4.Customizing the MultiFile Button|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Customizing the MultiFile Button</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>5.5 <text:a xlink:type="simple" xlink:href="#5.5.Customizing MultiFile's Handling of Queued Files|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Customizing MultiFile's Handling of Queued Files</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>5.6 <text:a xlink:type="simple" xlink:href="#5.6.Creating a Custom UploadStorageProvider|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Creating a Custom UploadStorageProvider</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>5.7 <text:a xlink:type="simple" xlink:href="#5.7.Creating a Custom UploadStateStoreProvider|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Creating a Custom UploadStateStoreProvider</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>5.8 <text:a xlink:type="simple" xlink:href="#5.8.Handling Non-absolute Paths in IE6|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Handling Non-absolute Paths in IE6</text:a>
</text:p>
<text:p text:style-name="P21">
<text:s/>6 <text:a xlink:type="simple" xlink:href="#6.Extensions|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Extensions</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>6.1 <text:a xlink:type="simple" xlink:href="#6.1.The SqlServerInputFile Extension|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">The SqlServerInputFile Extension</text:a>
</text:p>
<text:p text:style-name="P9">
<text:s/>6.1.1 <text:a xlink:type="simple" xlink:href="#6.1.1.Installation|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Installation</text:a>
</text:p>
<text:p text:style-name="P9">
<text:s/>6.1.2 <text:a xlink:type="simple" xlink:href="#6.1.2.Configuration|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Configuration</text:a>
</text:p>
<text:p text:style-name="P9">
<text:s/>6.1.3 <text:a xlink:type="simple" xlink:href="#6.1.3.Usage|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Usage</text:a>
</text:p>
<text:p text:style-name="P9">
<text:s/>6.1.4 <text:a xlink:type="simple" xlink:href="#6.1.4.Example|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Example</text:a>
</text:p>
<text:p text:style-name="P10">
<text:s/>6.1.4.1 <text:a xlink:type="simple" xlink:href="#6.1.4.1.Example Setup Query for SQL Server 2005|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Example Setup Query for SQL Server 2005</text:a>
</text:p>
<text:p text:style-name="P10">
<text:s/>6.1.4.2 <text:a xlink:type="simple" xlink:href="#6.1.4.2.Example Setup Query for SQL Server 2000|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Example Setup Query for SQL Server 2000</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>6.2 <text:a xlink:type="simple" xlink:href="#6.2.The GreyBoxProgressBar Extension|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">The GreyBoxProgressBar Extension</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>6.3 <text:a xlink:type="simple" xlink:href="#6.3.The HashedInputFile Extension|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">The HashedInputFile Extension</text:a>
</text:p>
<text:p text:style-name="P21">
<text:s/>7 <text:a xlink:type="simple" xlink:href="#7.Known Issues|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Known Issues</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.1 <text:a xlink:type="simple" xlink:href="#7.1.ASP.NET application-wide tracing disables NeatUpload|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">ASP.NET application-wide tracing disables NeatUpload</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.2 <text:a xlink:type="simple" xlink:href="#7.2.Permissions on uploaded files depend on temporary directory |outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Permissions on uploaded files depend on temporary directory </text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.3 <text:a xlink:type="simple" xlink:href="#7.3.Module conflicts can cause data length is shorter than Content-Length errors |outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Module conflicts can cause data length is shorter than Content-Length errors </text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.4 <text:a xlink:type="simple" xlink:href="#7.4.HttpResponse.AppendToLog() does nothing when UploadHttpModule is used|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">HttpResponse.AppendToLog() does nothing when UploadHttpModule is used</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.5 <text:a xlink:type="simple" xlink:href="#7.5.Setting HttpResponse.HeaderEncoding does nothing when UploadHttpModule is used|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Setting HttpResponse.HeaderEncoding does nothing when UploadHttpModule is used</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.6 <text:a xlink:type="simple" xlink:href="#7.6.Inline ProgressBars don't work with Opera|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Inline ProgressBars don't work with Opera</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.7 <text:a xlink:type="simple" xlink:href="#7.7.Non-absolute path in IE7 causes the progress display to start even though no upload occurs|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Non-absolute path in IE7 causes the progress display to start even though no upload occurs</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.8 <text:a xlink:type="simple" xlink:href="#7.8.Handler returning false does not block default action in IE6|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Handler returning false does not block default action in IE6</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.9 <text:a xlink:type="simple" xlink:href="#7.9.LinkButtons do not start the progress display in Internet Explorer for the Mac|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">LinkButtons do not start the progress display in Internet Explorer for the Mac</text:a>
</text:p>
<text:p text:style-name="P8">
<text:s/>7.10 <text:a xlink:type="simple" xlink:href="#7.10.Sometimes responses larger than 1MB are not buffered|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Sometimes responses larger than 1MB are not buffered</text:a>
</text:p>
<text:p text:style-name="P21">
<text:s/>8 <text:a xlink:type="simple" xlink:href="#8.Troubleshooting|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Troubleshooting</text:a>
</text:p>
</text:index-body>
</text:table-of-content>
<text:p text:style-name="Text_20_body"/>
<text:h text:style-name="Heading_20_1" text:outline-level="1">
<text:bookmark text:name="mozTocId903858"/>Introduction</text:h>
<text:p text:style-name="Text_20_body">The <text:a xlink:type="simple" xlink:href="http://www.brettle.com/neatupload">NeatUploadâ„¢</text:a>
<text:a xlink:type="simple" xlink:href="http://en.wikipedia.org/wiki/ASP.NET">ASP.NET</text:a> component allows developers to stream uploaded files to storage (e.g. disk or a database) and allows users to monitor upload progress. It is <text:a xlink:type="simple" xlink:href="http://opensource.org/docs/definition.php">open source</text:a> and works under <text:a xlink:type="simple" xlink:href="http://www.mono-project.com/">Mono's</text:a>
<text:a xlink:type="simple" xlink:href="http://www.go-mono.com/asp-net.html#xsp">XSP</text:a> / <text:a xlink:type="simple" xlink:href="http://www.go-mono.com/asp-net.html#mod_mono">mod_mono</text:a> as well as Microsoft's ASP.NET implementation. </text:p>
<text:p text:style-name="Text_20_body">NeatUpload contains seven custom controls (<text:span text:style-name="Source_20_Text">InputFile</text:span>, <text:span text:style-name="T2">MultiFile</text:span>, <text:span text:style-name="Source_20_Text">ProgressBar</text:span>, <text:span text:style-name="Source_20_Text">UnloadConfirmer</text:span>, <text:span text:style-name="Source_20_Text">HiddenPostBackID</text:span>, <text:span text:style-name="Source_20_Text">DetailsSpan</text:span>, and <text:span text:style-name="Source_20_Text">DetailsDiv</text:span>), an <text:span text:style-name="Source_20_Text">HttpModule</text:span> (<text:span text:style-name="Source_20_Text">UploadHttpModule</text:span>), and a Page subclass (<text:span text:style-name="Source_20_Text">ProgressPage</text:span>). This section briefly describes what they each do and how they are related. The remainder of this manual describes how to install and use NeatUpload. </text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">InputFile</text:span> is a custom control that renders like <text:span text:style-name="Source_20_Text">HtmlInputFile</text:span>, but provides properties to access the uploaded file's client-specified name, content, and MIME type, and a method to move the file to a permanent location. <text:s/>
<text:span text:style-name="T2">MultiFile</text:span>
<text:span text:style-name="T13">is a custom control similar to </text:span>
<text:span text:style-name="T2">InputFile</text:span>
<text:span text:style-name="T13">but with support for uploading multiple files and for specifying the look of the control.</text:span>
</text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">ProgressBar</text:span> is a custom control that is responsible for providing a site for the progress to be displayed. It provides an attribute to control whether to display the progress inline or in a popup. It also provides ways to control which buttons cause the progress display to start refreshing. If the progress is displayed inline, the <text:span text:style-name="Source_20_Text">ProgressBar</text:span> control renders as an <text:span text:style-name="Source_20_Text">IFRAME</text:span>. Otherwise, it renders as a <text:span text:style-name="Source_20_Text">DIV</text:span> containing a "Check Upload Progress" link (to display the progress in a new window) along with some JavaScript which removes the <text:span text:style-name="Source_20_Text">DIV</text:span> when the page loads. This provides a fallback when JavaScript is not available. Note that <text:span text:style-name="Source_20_Text">ProgressBar</text:span> doesn't actually display the progress bar itself. It merely provides a site (an <text:span text:style-name="Source_20_Text">IFRAME</text:span> or popup) which loads a page derived from <text:span text:style-name="Source_20_Text">ProgressPage</text:span> (by default <text:span text:style-name="Source_20_Text">Progress.aspx</text:span>). Â The <text:span text:style-name="Source_20_Text">ProgressPage</text:span> subclass displays the progress bar. </text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">UnloadConfirmer</text:span> is a custom control that displays a confirmation dialog if the user tries to do something that would interrupt an upload.</text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">HiddenPostBackID</text:span> is a custom control that tells NeatUpload to stream to storage all files uploaded from a page, including those uploaded with standard ASP.NET upload controls.</text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> is an <text:span text:style-name="Source_20_Text">HttpModule</text:span> that intercepts HTTP requests, streams <text:span text:style-name="Source_20_Text">InputFile/MultiFile</text:span> uploads to temporary files, and restricts the size of the remainder of the request. By default, <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> intercepts every request. Â As a result, a bug in NeatUpload could affect pages that don't even contain <text:span text:style-name="Source_20_Text">
<text:span text:style-name="T13">NeatUpload</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>controls. For this reason, you can configure NeatUpload to only use <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> for certain pages (or even none) while continuing to use <text:span text:style-name="Source_20_Text">InputFile</text:span>
<text:span text:style-name="Source_20_Text">
<text:span text:style-name="T13">, </text:span>
</text:span>
<text:span text:style-name="Source_20_Text">MultiFile</text:span>
<text:span text:style-name="Source_20_Text">
<text:span text:style-name="T13">,</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>and <text:span text:style-name="Source_20_Text">ProgressBar</text:span>. When <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> is not used for a request, NeatUpload gets the uploaded file from the ASP.NET standard <text:span text:style-name="Source_20_Text">HttpRequest.Files</text:span> property instead of intercepting the request. That means that <text:span text:style-name="Source_20_Text">InputFile</text:span> will function like an <text:span text:style-name="Source_20_Text">HtmlInputFile</text:span> control, but no progress bar will be displayed. This greatly reduces the risk of adopting NeatUpload. </text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">ProgressPage</text:span> is a subclass ofÂ <text:span text:style-name="Source_20_Text">System.Web.UI.Page</text:span> that is used as the base class for pages displayed in the site provided by the <text:span text:style-name="Source_20_Text">ProgressBar</text:span> control (i.e. in the <text:span text:style-name="Source_20_Text">IFRAME</text:span> or popup). <text:span text:style-name="Source_20_Text">Â Progress.aspx</text:span> is the default <text:span text:style-name="Source_20_Text">ProgressPage</text:span>. Â <text:span text:style-name="Source_20_Text">ProgressPage </text:span>retrieves the details of the upload process from the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span>. and makes them available for subclasses to use in data-binding expressions.Â  <text:span text:style-name="Source_20_Text">ProgressPage</text:span> subclasses (e.g. <text:span text:style-name="Source_20_Text">Progress.aspx</text:span>) place such data-binding expressions within <text:span text:style-name="Source_20_Text">
<text:span text:style-name="T1">DetailsSpan</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>and <text:span text:style-name="Source_20_Text">
<text:span text:style-name="T1">DetailsDiv</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>controls so that NeatUpload can use AJAX techniques to update the values without requiring a browser a refresh. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="Requirements"/>Requirements</text:h>
<text:p text:style-name="Text_20_body">To use NeatUpload you will need: </text:p>
<text:list text:style-name="L1">
<text:list-item>
<text:p text:style-name="P72">.NET Framework (1.1, 2.0, 3.0, or 3.5), or Mono (1.1 or 1.2). Mono users that are using the mod_mono Apache module should use mod_mono 1.1.14 or later. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P72">A working web application. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P34">Either "Full" <text:a xlink:type="simple" xlink:href="http://msdn2.microsoft.com/en-us/library/tkscy493.aspx">trust</text:a> or, if NeatUpload is installed in the GAC, at least "Medium" trust. "Full" trust level is the ASP.NET default, but some hosting providers force web applications to run with "Medium" trust. </text:p>
</text:list-item>
</text:list>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="Branding"/>Branding, Licensing, and the Trademark</text:h>
<text:p text:style-name="Text_20_body">Some NeatUpload controls display a "PoweredÂ byÂ <text:a xlink:type="simple" xlink:href="http://www.brettle.com/neatupload" office:target-frame-name="_blank" xlink:show="new">NeatUpload</text:a>" branding unless you are using a version that someone has modified to remove the branding. This branding is designed to encourage you to contribute to NeatUpload in one of the following ways: </text:p>
<text:list text:style-name="L2">
<text:list-item>
<text:p text:style-name="P74">spread the word by leaving the branding in place, or </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P74">becoming familiar enough with NeatUpload (as evidenced by your ability to find and remove the branding) that you could contribute code in the future, or </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P74">help fund NeatUpload by <text:a xlink:type="simple" xlink:href="mailto:dean@brettle.com?subject=How%20to%20buy%20unbranded%20NeatUpload%3F">purchasing an unbranded version</text:a>, or </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P35">make a substantial non-monetary contribution (e.g. fix a bug, help with testing, or manually translate documentation), in return for which I will typically provide an unbranded version </text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">Note that both the branded and unbranded versions are licensed under the <text:a xlink:type="simple" xlink:href="http://www.brettle.com/neatupload#License">GNU Lesser General Public License (LGPL)</text:a>. The only difference is whether the branding is present. That means you can legally redistribute (or fork) the unbranded version. Note however that "NeatUpload" is a trademark for the combination of the code I distribute and my support of it. As such, you are not allowed to promote your redistribution of the unbranded version (or a derivative of either version) in a way that could imply my endorsement without my permission. For example, don't call it "Unbranded NeatUpload" or say that it is "based on NeatUpload", because I don't want to get support requests from folks using it. </text:p>
<text:p text:style-name="Text_20_body">To summarize, if you are using a branded version of NeatUpload you have several options for removing the branding. In addition, you can use NeatUpload, modify it (including removal of the branding), and redistribute it in accordance with the terms of LGPL license. This includes using it to create products/services that compete with NeatUpload. However, you can't promote your redistribution of an unbranded version of NeatUpload in a way that could imply my endorsement because doing so dilutes the NeatUpload trademark. </text:p>
<text:p text:style-name="Text_20_body">I view branding NeatUpload as an experiment, and I'm very interested in feedback, both positive and negative. Please <text:a xlink:type="simple" xlink:href="http://www.brettle.com/ForumView.aspx?ItemID=5&amp;mid=39&amp;pageindex=7&amp;pageid=32">post your comments</text:a>, or <text:a xlink:type="simple" xlink:href="mailto:dean@brettle.com">email me</text:a> directly. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Version Numbering</text:h>
<text:p text:style-name="Text_20_body">NeatUpload release names have the form NeatUpload-<text:span text:style-name="Emphasis">major.minor.patch</text:span>. When comparing versions, the same major and minor numbers but a higher patch number (e.g. 1.1.4 vs. 1.1.3) means the new version contains only fixes for bugs in existing assemblies or new features implemented in new optional assemblies. There is very little risk (and sometimes significant reward) in installing the new version. The same major number but a higher minor number (e.g. 1.2.<text:span text:style-name="Emphasis">patch</text:span> vs. 1.1.<text:span text:style-name="Emphasis">patch</text:span>) means the new version adds new features to existing assemblies but any backward incompatibilities are extremely minor. You should not need to modify your application to continue to use the old features, but you might need to make modification to use the new features. However, you should review the release notes and test your application after upgrading to ensure that bugs weren't inadvertently introduced. A higher major number (e.g. 2.<text:span text:style-name="Emphasis">minor.patch</text:span> vs. 1.<text:span text:style-name="Emphasis">minor.patch</text:span>) means the new version contains significant changes that are not backward-compatible. Depending on what features your application uses, you might need to modify it to work with the new version. Review the release notes for details.</text:p>
<text:h text:style-name="Heading_20_1" text:outline-level="1">
<text:bookmark text:name="ReleaseNotes"/>Release Notes for NeatUpload-1.3.x</text:h>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="Upgrading1dot2"/>Upgrading from NeatUpload-1.2.x and NeatUpload-1.1.x</text:h>
<text:p text:style-name="Text_20_body">NeatUpload-1.3.x is intended to be almost completely backward-compatible with NeatUpload-1.2.x and NeatUpload-1.1.x. See below for compatibility exceptions. To upgrade, simply replace your <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.dll</text:span> with the copy from <text:span text:style-name="Source_20_Text">NeatUpload-1.3.x/dotnet/app/bin/</text:span> and copy everything from the <text:span text:style-name="Source_20_Text">NeatUpload-1.3.x/dotnet/app/NeatUpload/</text:span> folder into the NeatUpload folder that is a child of your application's root directory.</text:p>
<text:p text:style-name="Text_20_body">If you have customized your <text:span text:style-name="Source_20_Text">Progress.aspx</text:span> page, it will probably work unchanged under NeatUpload-1.3.x but merging your changes into the latest version should not be difficult and is recommended. </text:p>
<text:p text:style-name="Text_20_body">If you are using the &lt;neatUpload&gt; configuration section, consider moving it out of the &lt;system.web&gt; section and adding the xmlns="http://www.brettle.com/neatupload/config/2008" attribute as described in <text:a xlink:type="simple" xlink:href="#4.1.Using the &lt;neatUpload&gt; Configuration Section|outline" text:style-name="Internet_20_link" text:visited-style-name="Internet_20_link">Using the &lt;neatUpload&gt; Configuration Section</text:a>. <text:s/>The old location under &lt;system.web&gt; is still supported but the documentation uses the new location and adding the xmlns attribute will provide Intellisense support in Visual Studio. </text:p>
<text:p text:style-name="Text_20_body">The only compatiblity exceptions in NeatUpload-1.3 are: </text:p>
<text:list text:style-name="L3">
<text:list-item>
<text:p text:style-name="P77">The <text:span text:style-name="Source_20_Text">InputFile</text:span> control is now "branded" unless you are using a version that someone has modified to remove the branding. The branding looks says â€œ(PoweredÂ byÂ <text:a xlink:type="simple" xlink:href="http://www.brettle.com/neatupload" office:target-frame-name="_blank" xlink:show="new">NeatUpload</text:a>)â€. <text:s/>For more information on the branding and having it removed, see <text:a xlink:type="simple" xlink:href="#Branding">Branding, Licensing, and the Trademark</text:a>
</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P77">If you don't specify a temporary directory for use by the default <text:span text:style-name="Source_20_Text">FileSystemUploadStorageProvider</text:span>, it will first try to use the directory <text:span text:style-name="Source_20_Text">app_data\NeatUpload_Temp</text:span> within your application directory. If that directory exists (or can be created) and is writable, NeatUpload will use it. Otherwise, it will revert to the old behavior of using the system-wide temporary directory. This change was made to make it easier to configure NeatUpload in environments which use a Medium trust-level. In such an environment, the server administrator typically doesn't want to give applications access to the system-wide directory. Without this change, you would need to explicitly specify a temporary directory for NeatUpload to work in such an environment. With this change, you at most need to create <text:span text:style-name="Source_20_Text">app_data\NeatUpload_Temp</text:span> and grant write permissions to the account that your app runs under. If you aren't in a Medium trust environment, you don't even need to do that. NeatUpload will probably be unable to create the directory and will fallback to using the system-wide temporary directory. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P77">
<text:span text:style-name="Source_20_Text">UploadException</text:span> is no longer a subclass of <text:span text:style-name="Source_20_Text">HttpException</text:span>. It is now just a subclass of <text:span text:style-name="Source_20_Text">Exception</text:span>. This changes was necessary to allow <text:span text:style-name="Source_20_Text">UploadException</text:span>s to be serialized so they can be passed to the progress bar in a web garden/farm environment. Custom error pages should still work because when an <text:span text:style-name="Source_20_Text">UploadException</text:span> occurs during an upload, NeatUpload now wraps it in an <text:span text:style-name="Source_20_Text">HttpException</text:span> with the same HTTP status code and throws the <text:span text:style-name="Source_20_Text">HttpException</text:span>. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P77">For upload requests where the non-file portion exceeds the <text:span text:style-name="Source_20_Text">maxNormalRequestLength</text:span> limit, NeatUpload now throws a <text:span text:style-name="Source_20_Text">NonfilePortionTooLargeException</text:span> instead of an <text:span text:style-name="Source_20_Text">UploadTooLargeException</text:span>. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P77">If you use ASP.NET 2.0 themes, those themes will now be applied to the default progress display page (<text:span text:style-name="Source_20_Text">Progress.aspx</text:span>) and the sample custom error page (<text:span text:style-name="Source_20_Text">Error413.aspx</text:span>). </text:p>
</text:list-item>
</text:list>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId432734"/>Upgrading from NeatUpload-1.0.x</text:h>
<text:p text:style-name="Text_20_body">NeatUpload-1.3.x is intended to be almost completelyÂ backward-compatible with NeatUpload-1.0.x. Â The only exception other than those mentioned above is that <text:span text:style-name="Source_20_Text">ProgressBar</text:span>s must now be placed somewhere inside a <text:span text:style-name="Source_20_Text">&lt;form&gt;</text:span> element. Â In almost all cases that will already be the case so this should not be a major issue. Â <text:line-break/>
<text:line-break/>To upgrade, simply replace your <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.dll</text:span> with the copy from <text:span text:style-name="Source_20_Text">NeatUpload-1.3.x/dotnet/app/bin/</text:span> and copy everything from the <text:span text:style-name="Source_20_Text">NeatUpload-1.3.x/dotnet/app/NeatUpload/</text:span> folder into the NeatUpload folder in your application. <text:s/>If you have not customized your <text:span text:style-name="Source_20_Text">Progress.aspx</text:span> page, you should replace it with <text:span text:style-name="Source_20_Text">NeatUpload-1.3.x/dotnet/app/NeatUpload/Progress.aspx</text:span>. Â If you have customized it, consider changing it to use the new <text:span text:style-name="Source_20_Text">&lt;Upload:DetailsSpan&gt;</text:span> and <text:span text:style-name="Source_20_Text">&lt;Upload:DetailsDiv&gt;</text:span> elements to take advantage ofÂ <text:a xlink:type="simple" xlink:href="http://en.wikipedia.org/wiki/AJAX">AJAX</text:a> refreshless updates.Â  See <text:a xlink:type="simple" xlink:href="Manual.html#Customizing_Progress_aspx">Customizing Progress.aspx</text:a> for details.<text:line-break/>
<text:line-break/>If you recompile, you will see some warnings about obsoleted/deprecated methods. Â Those methods may be removed in NeatUpload-2.x. Â You are encouraged to switch to their replacements, but that is not required for NeatUpload-1.3.x. Â Similarly, you are encouraged to use the new custom configuration section instead of the NeatUpload-1.0.x appSettings. Â The old appSettings still work in NeatUpload-1.3.x, but the new custom configuration section provides much more flexibility, including the ability to use location filtering to restrict the requests that NeatUpload touches. Â See <text:a xlink:type="simple" xlink:href="Manual.html#mozTocId221000">Configuration</text:a> for details.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="NewFeatures1dot3"/>New Features in NeatUpload-1.3</text:h>
<text:list text:style-name="L4">
<text:list-item>
<text:p text:style-name="P232">
<text:bookmark text:name="_ctl5_myDataList__ctl0_Description"/>Added support for IIS7's default application pool (i.e. Integrated Pipeline Mode) using the same technique that <text:a xlink:type="simple" xlink:href="http://darrenjohnstone.net/category/aspnet-file-uploads/">Darren Johnstone's upload component</text:a> uses.Â  The technique does use reflection to access non-public members of ASP.NET classes, but uses the least reflection of any technique I've seen.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P82">Added the <text:span text:style-name="Source_20_Text">MultiFile</text:span> control for uploading multiple files.</text:p>
<text:list>
<text:list-item>
<text:p text:style-name="P82">If the user has Flash 8 or higher, they can also <text:a xlink:type="simple" xlink:href="#0.0.2.Allowing Users with Flash to Select Multiple Files from One File Selection Dialog|outline">
<text:span text:style-name="T5">select</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="#0.0.2.Allowing Users with Flash to Select Multiple Files from One File Selection Dialog|outline"/>
<text:a xlink:type="simple" xlink:href="#0.0.2.Allowing Users with Flash to Select Multiple Files from One File Selection Dialog|outline">multiple files</text:a> from a single file selection dialog. <text:s/>Other users select one file per-dialog.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P82">Developers can <text:a xlink:type="simple" xlink:href="#0.1.1.Customizing the MultiFile Button|outline">customize the button</text:a> that displays the file selection dialog and <text:a xlink:type="simple" xlink:href="#0.1.1.Customizing MultiFile's Handling of Queued Files|outline">customize the handling of queued files</text:a>.</text:p>
</text:list-item>
</text:list>
</text:list-item>
<text:list-item>
<text:p text:style-name="P82">Added support for using NeatUpload in a web garden or web farm if you have ASP.NET configured to share session state across the servers in your garden/farm. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P82">Added support for <text:a xlink:type="simple" xlink:href="#MediumTrust">Using NeatUpload in a Medium Trust Environment</text:a> when installed in the GAC. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P82">Added support for <text:a xlink:type="simple" xlink:href="#ShowingProcessingProgress">using a </text:a>
<text:a xlink:type="simple" xlink:href="#ShowingProcessingProgress">
<text:span text:style-name="Source_20_Text">ProgressBar</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="#ShowingProcessingProgress"/>
<text:a xlink:type="simple" xlink:href="#ShowingProcessingProgress">to show processing progress</text:a>. This can be used to display the progress of a long-running task even when no files are uploaded.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P232">
<text:bookmark text:name="_ctl5_myDataList__ctl0_Description1"/>Added an <text:span text:style-name="Source_20_Text">UnloadConfirmer</text:span> control which displays a confirmation dialog to the user if they attempt to leave the page or resubmit it while an upload is in progress.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P82">Added support for <text:a xlink:type="simple" xlink:href="#UploadingWithoutInputFile">uploading without using </text:a>
<text:a xlink:type="simple" xlink:href="#UploadingWithoutInputFile">
<text:span text:style-name="Source_20_Text">InputFile</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="#UploadingWithoutInputFile"/>. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P82">Added support for <text:a xlink:type="simple" xlink:href="#MaxUploadRate">Limiting the Upload Rate</text:a>.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P82">
<text:bookmark text:name="_ctl5_myDataList__ctl0_Description2"/>Added APIs and SPIs to make it possible to write new controls that use the same <text:span text:style-name="Source_20_Text">IHttpModule</text:span>, new <text:span text:style-name="Source_20_Text">IHttpModule</text:span>s that work with existing controls, and custom <text:span text:style-name="Source_20_Text">UploadStateStoreProvider</text:span>s that maintain upload state in different locations. </text:p>
</text:list-item>
</text:list>
<text:list text:style-name="L5">
<text:list-item>
<text:p text:style-name="P91">Added Intellisense support for the &lt;neatUpload&gt; element if you include NeatUploadConfig.xsd in your web project and use &lt;neatUploadÂ xmlns="http://www.brettle.com/neatupload/config/2008" ...&gt;. </text:p>
</text:list-item>
</text:list>
<text:list text:style-name="L6">
<text:list-item>
<text:p text:style-name="P36">Rearranged the directory structure to separate the source code from the example application and moved most of the script code into a separate NeatUpload.js file that is not specific to ASP.NET.</text:p>
</text:list-item>
</text:list>
<text:h text:style-name="Heading_20_1" text:outline-level="1">
<text:bookmark text:name="mozTocId50790"/>Usage</text:h>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="T3">The following instructions should work with Visual Studio 2003 and Visual Studio 2005. Â If you are using Visual Studio 2002, you might be able to get NeatUpload to work by following the instructions in this </text:span>
<text:a xlink:type="simple" xlink:href="http://www.brettle.com/ForumThreadView.aspx?thread=84&amp;pageindex=7">
<text:span text:style-name="T3">forum thread</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="http://www.brettle.com/ForumThreadView.aspx?thread=84&amp;pageindex=7"/>
<text:span text:style-name="T3">.</text:span>
</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId304923"/>Installing NeatUpload</text:h>
<text:p text:style-name="Text_20_body">Installing NeatUpload is pretty straightforward. Just copy the necessary assemblies and subdirectories into your application and make some modifications to your <text:span text:style-name="Source_20_Text">Web.config</text:span>. Â Specifically: </text:p>
<text:list text:style-name="L7">
<text:list-item>
<text:p text:style-name="P92">If you haven't already, download the release and extract it wherever you want. All the files will be extracted into a subdirectory named <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>, where version is the version of the release you are installing. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">
<text:bookmark text:name="MediumTrust"/>If your application has "Full" trust, you can safely skip this step. If your application does not have "Full" trust, a server administrator (e.g. your hosting provider) needs to install NeatUpload in the GAC. This is necessary because NeatUpload (and all other similar components) needs to access the underlying <text:span text:style-name="Source_20_Text">HttpWorkerRequest</text:span> object. To install NeatUpload in the GAC, the server administrator should: </text:p>
<text:list>
<text:list-item>
<text:p text:style-name="P92">Use Windows Explorer to open <text:span text:style-name="Source_20_Text">%WINDIR%\assembly</text:span>. The window will list the assemblies currently in the GAC along with their version number, etc. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">In another Windows Explorer window, open the <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">\bin</text:span> folder. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">Drag and drop <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.dll</text:span> and (if present) <text:span text:style-name="Source_20_Text">Policy.</text:span>
<text:span text:style-name="Emphasis">major.minor</text:span>
<text:span text:style-name="Source_20_Text">.Brettle.Web.NeatUpload.dll</text:span> from the <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">\bin</text:span> folder into the GAC window to add them to the GAC. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">Find the Brettle.Web.NeatUpload assembly that was just added and note the value in the "Version" column. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">Tell NeatUpload users that the full strong name for the Brettle.Web.NeatUpload assembly is <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload,Â Version=</text:span>
<text:span text:style-name="Emphasis">
<text:span text:style-name="T1">valueÂ inÂ versionÂ column</text:span>
</text:span>
<text:span text:style-name="Emphasis"/>
<text:span text:style-name="Source_20_Text">,Â Culture=neutral,Â PublicKeyToken=C95290D92C5893C8"</text:span>. </text:p>
</text:list-item>
</text:list>
<text:p text:style-name="P92">To use NeatUpload after it has been installed in the GAC, you need to: Use the full strong name wherever the assembly is referenced in your application's <text:span text:style-name="Source_20_Text">Web.config</text:span>. For example, if this documentation says to use:</text:p>
<text:list>
<text:list-header>
<text:p text:style-name="P194">type="Brettle.Web.NeatUpload.UploadHttpModule,<text:span text:style-name="T1">Brettle.Web.NeatUpload</text:span>"</text:p>
</text:list-header>
</text:list>
<text:p text:style-name="P37">you would use:</text:p>
<text:list>
<text:list-header>
<text:p text:style-name="P194">type="Brettle.Web.NeatUpload.UploadHttpModule,<text:span text:style-name="T1">Brettle.Web.NeatUpload,Version=valuefromadmin,Culture=neutral,PublicKeyToken=C95290D92C5893C8"</text:span>
</text:p>
</text:list-header>
</text:list>
<text:p text:style-name="P92">The server administrator will provide the "Version" portion of the strong name. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">Either create <text:span text:style-name="Source_20_Text">app_data/NeatUpload_Temp</text:span> under your application root and make it writable by the account that your application is running as, or <text:a xlink:type="simple" xlink:href="#TempDirectory">change the temporary directory</text:a> used by the default provider. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">(Optional) To see the demo running on your server, configure IIS, mod_mono, or XSP so that <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/</text:span> is a web application. Then point your browser at the <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload/Demo.aspx</text:span> on that website. To use NeatUpload in your own web application, continue with the remaining installation steps. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">If you will be using the Visual Studio Web Form Designer, add the NeatUpload controls to your toolbox. Â To do that, right-click on the Toolbox, click Add/Remove Items, Browse toÂ Â <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/bin/Brettle.Web.NeatUpload.dll</text:span>, click Open, and then click OK. Â A reference to <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.dll</text:span> will automatically be added to your project the first time you use the designer to add one of the NeatUpload controls to a form. If you want to use any of the NeatUpload extensions, add the other corresponding assemblies to your toolbox.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">If you won't be using the Visual Studio Web Form Designer, add a reference to your web application that refers to the <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.dll</text:span> (and any extension assemblies of interest) in the <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotet/app/bin</text:span> directory. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P92">In your web application's root directory, create a <text:span text:style-name="Source_20_Text">NeatUpload/</text:span> child directory by copying <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/NeatUpload/</text:span> and its contents. Â That subdirectory contains various files that NeatUpload needs in order to function properly. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P37">Add the following line to your <text:span text:style-name="Source_20_Text">Web.config</text:span> at the <text:span text:style-name="Emphasis">top</text:span> of the <text:span text:style-name="Source_20_Text">configuration/system.web/httpModules</text:span> section: </text:p>
<text:p text:style-name="P158">&lt;add name="UploadHttpModule" type="Brettle.Web.NeatUpload.UploadHttpModule, Brettle.Web.NeatUpload" /&gt;</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P37">Add the following line to your <text:span text:style-name="Source_20_Text">Web.config</text:span> at the <text:span text:style-name="Emphasis">top</text:span> of the <text:span text:style-name="Source_20_Text">configuration/system.webServer/modules</text:span> section to support IIS7's Integrated Pipeline Mode (which is used in it's default application pool):</text:p>
<text:p text:style-name="P158">&lt;add name="UploadHttpModule" type="Brettle.Web.NeatUpload.UploadHttpModule, Brettle.Web.NeatUpload" preCondition="managedHandler"/&gt;</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P37">(Optional) To allow larger uploads than the default of 4 Mbytes under Microsoft's ASP.NET, Â you <text:span text:style-name="T3">might</text:span> need to add or modify the following element in your <text:span text:style-name="Source_20_Text">Web.config</text:span> under <text:span text:style-name="Source_20_Text">configuration/system.web</text:span>: </text:p>
<text:p text:style-name="P194">&lt;httpRuntime maxRequestLength="<text:span text:style-name="Variable">size_in_kbytes</text:span>" /&gt;</text:p>
<text:p text:style-name="P92">At the moment, both .NET and Mono seem to ignore that setting when NeatUpload is being used, but there is no official documentation specifying exactly when that limit is enforced, so a future version of .NET or Mono might enforce the limit even when NeatUpload is being used. Â  Setting the <text:span text:style-name="Source_20_Text">&lt;httpRuntime&gt;</text:span> element's <text:span text:style-name="Source_20_Text">maxRequestLength</text:span> attribute simply provides insurance against such future changes. Â Note that since that attribute is currently ignored when NeatUpload is used, you can't use it to actually restrict the size of uploads. Â To do that, see <text:a xlink:type="simple" xlink:href="#Limiting_the_Size_of_Upload_Requests">Limiting the Size of Upload Requests</text:a> below.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P37">(Optional) Copy the <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/Brettle.Web.NeatUpload/</text:span> folder into your application. Point your browser at the <text:span text:style-name="Source_20_Text">Demo.aspx</text:span> in that folder and verify that the demo functions properly. </text:p>
</text:list-item>
</text:list>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId879490"/>Using NeatUpload with the Visual Studio Web Form Designer</text:h>
<text:p text:style-name="Text_20_body">To use the Visual Studio web form designer to add NeatUpload to a web form, follow these steps: </text:p>
<text:list text:style-name="L8">
<text:list-item>
<text:p text:style-name="P107">Drag the following controls from the toolbox onto your web form:Â <text:span text:style-name="Source_20_Text">MultiFile</text:span>, <text:span text:style-name="Source_20_Text">InputFile</text:span>, <text:span text:style-name="Source_20_Text">ProgressBar</text:span>, and <text:span text:style-name="Source_20_Text">Button</text:span>. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P107">(Optional) If you want an inline progress bar, set the <text:span text:style-name="Source_20_Text">ProgressBar</text:span>'s <text:span text:style-name="Source_20_Text">Inline</text:span> property to <text:span text:style-name="Source_20_Text">true</text:span>. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P107">(Optional) If you want to customize the <text:span text:style-name="Source_20_Text">ProgressBar</text:span> fallback behavior, drag whatever control(s) you want displayed as a fallback onto the <text:span text:style-name="Source_20_Text">ProgressBar</text:span> control. Â For example, to just change the fallback text, you could drag a <text:span text:style-name="Source_20_Text">Label</text:span> control onto the ProgressBar and edit its contents. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P42">In your codebehind file,Â process the uploaded file(s). Â If you are using the <text:span text:style-name="Source_20_Text">InputFile</text:span> control, the uploaded file's client-specified name, MIME type, and contents can be accessed via <text:span text:style-name="Variable">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.FileName</text:span>, <text:span text:style-name="Variable">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.ContentType</text:span>, and <text:span text:style-name="Source_20_Text">
<text:span text:style-name="T3">inputFileId</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"> .FileContent</text:span>, respectively. Â  <text:span text:style-name="Strong_20_Emphasis">
<text:span text:style-name="T1">If you want to keep the uploaded file, you must use the </text:span>
</text:span>
<text:span text:style-name="Strong_20_Emphasis">
<text:span text:style-name="T4">inputFileId</text:span>
</text:span>
<text:span text:style-name="Strong_20_Emphasis"/>
<text:span text:style-name="Strong_20_Emphasis">
<text:span text:style-name="T1">.MoveTo() method to move the uploaded file to a permanent location. Â If you do not, NeatUpload will automatically remove the uploaded file at the end of the request</text:span>
</text:span>
<text:span text:style-name="Strong_20_Emphasis"/>to ensure that unwanted files are not left on the filesystem. Â The following code will put the uploaded file in the application's root directory (assuming sufficient permissions): </text:p>
<text:p text:style-name="P160">using Brettle.Web.NeatUpload;<text:line-break/>...<text:line-break/>using System.IO;<text:line-break/>...<text:line-break/>public class YourPage : System.Web.UI.Page<text:line-break/>{<text:line-break/> private void Page_Load(object sender, EventArgs e)<text:line-break/> {<text:line-break/> ...<text:line-break/>
<text:span text:style-name="T3">submitButtonId.Click</text:span> += new System.EventHandler(this.Button_Clicked);<text:line-break/> ...<text:line-break/> }<text:line-break/> ...<text:line-break/> private void Button_Clicked(object sender, EventArgs e)<text:line-break/> {<text:line-break/> ...<text:line-break/> if (IsValid &amp;&amp; <text:span text:style-name="Variable">inputFileId</text:span>.HasFile)<text:line-break/> {<text:line-break/> ...<text:line-break/>
<text:span text:style-name="Variable">inputFileId</text:span>.MoveTo(Path.Combine(Request.PhysicalApplicationPath,<text:span text:style-name="Variable">inputFileId</text:span>.FileName),<text:line-break/> MoveToOptions.Overwrite);</text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">If you are using the <text:span text:style-name="Source_20_Text">MultiFile</text:span> control, the <text:span text:style-name="Variable">multiFileId</text:span>
<text:span text:style-name="Source_20_Text">.Files</text:span> property returns an array of <text:span text:style-name="Source_20_Text">UploadedFile</text:span> objects. <text:s/>Those objects have members similar to the above <text:span text:style-name="Source_20_Text">InputFile</text:span> members, that you can use to save and access the uploaded files. <text:s/>
</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId170882"/>Using NeatUpload <text:span text:style-name="T3">without</text:span> the Visual Studio Web Form Designer</text:h>
<text:p text:style-name="Text_20_body">To use NeatUpload on a web form <text:span text:style-name="T3">without</text:span> using the Visual Studio designer, follow these steps: </text:p>
<text:list text:style-name="L9">
<text:list-item>
<text:p text:style-name="P43">Add the following to the top of your page: </text:p>
<text:p text:style-name="P161">&lt;%@ Register TagPrefix="Upload" Namespace="Brettle.Web.NeatUpload" Assembly="Brettle.Web.NeatUpload" %&gt;</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P43">Add an <text:span text:style-name="Source_20_Text">InputFile</text:span> or <text:span text:style-name="Source_20_Text">MultiFile</text:span> control to your aspx page wherever you want the user to choose a file, using something like this: </text:p>
<text:p text:style-name="P161">&lt;Upload:InputFile id="<text:span text:style-name="Variable">inputFileId</text:span>" runat="server" /&gt;</text:p>
<text:p text:style-name="P110">or this:</text:p>
<text:p text:style-name="P201">&lt;Upload:MultiFile id="multi<text:span text:style-name="Variable">FileId</text:span>" runat="server" /&gt;</text:p>
<text:p text:style-name="P110">Feel free to add any attributes that you would normally add to an <text:span text:style-name="Source_20_Text">HtmlInputFile</text:span> tag. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P43">Add a <text:span text:style-name="Source_20_Text">ProgressBar</text:span> control to your aspx page wherever you want to display an inline progress bar or, in the case of a popup progress bar, add it wherever you want the fallback link to be displayed. Â Use something like this: </text:p>
<text:p text:style-name="P161">&lt;Upload:ProgressBar id="<text:span text:style-name="Variable">progressBarId</text:span>" runat="server" inline="<text:span text:style-name="Variable">true|false</text:span>" /&gt;</text:p>
<text:p text:style-name="P110">The inline attribute defaults to false. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P43">Add a submit button to your aspx page. For example: </text:p>
<text:p text:style-name="P197">&lt;asp:Button id="<text:span text:style-name="Variable">submitButtonId</text:span>" runat="server" Text="<text:span text:style-name="Variable">Submit</text:span>" /&gt;</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P43">In your codebehind file, declare each <text:span text:style-name="Source_20_Text">MultiFile</text:span>, <text:span text:style-name="Source_20_Text">InputFile</text:span>, <text:span text:style-name="Source_20_Text">ProgressBar</text:span>, and <text:span text:style-name="Source_20_Text">Button</text:span> control using code like this: </text:p>
<text:p text:style-name="P161">using Brettle.Web.NeatUpload;<text:line-break/>...<text:line-break/>using System.Web.UI.WebControls;<text:line-break/>...<text:line-break/>public class YourPage : System.Web.UI.Page<text:line-break/>{<text:line-break/>
<text:s text:c="7"/>...<text:line-break/>
<text:s text:c="7"/>protected InputFile <text:span text:style-name="Variable">inputFileId</text:span>;<text:line-break/>
<text:s text:c="7"/>protected MultiFile <text:span text:style-name="Variable">multiFileId</text:span>;<text:line-break/>
<text:s text:c="7"/>protected ProgressBar <text:span text:style-name="Variable">progressBarId</text:span>; <text:line-break/>
<text:s text:c="7"/>protected Button <text:span text:style-name="T3">submitButtonId</text:span>;</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P43">In your codebehind file,Â process the uploaded file. Â If you are using the <text:span text:style-name="Source_20_Text">InputFile</text:span> control, the uploaded file's client-specified name, MIME type, and contents can be accessed via <text:span text:style-name="Variable">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.FileName</text:span>, <text:span text:style-name="Variable">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.ContentType</text:span>, and <text:span text:style-name="Source_20_Text">
<text:span text:style-name="T3">inputFileId</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"> .FileContent</text:span>, respectively. Â  <text:span text:style-name="Strong_20_Emphasis">
<text:span text:style-name="T1">If you want to keep the uploaded file, you must use the </text:span>
</text:span>
<text:span text:style-name="Source_20_Text">
<text:span text:style-name="T4">inputFileId</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>
<text:span text:style-name="Source_20_Text">
<text:span text:style-name="T1">.MoveTo()</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>
<text:span text:style-name="Strong_20_Emphasis">
<text:span text:style-name="T1">method to move the uploaded file to a permanent location. Â If you do not, NeatUpload will automatically remove the uploaded file at the end of the request</text:span>
</text:span>
<text:span text:style-name="Strong_20_Emphasis"/>to ensure that unwanted files do not fill up the filesystem. Â The following code will put the uploaded file in the application's root directory (assuming sufficient permissions): </text:p>
<text:p text:style-name="P161">using Brettle.Web.NeatUpload;<text:line-break/>...<text:line-break/>using System.IO;<text:line-break/>...<text:line-break/>public class YourPage : System.Web.UI.Page<text:line-break/>{<text:line-break/> private void Page_Load(object sender, EventArgs e)<text:line-break/> {<text:line-break/> ...<text:line-break/>
<text:span text:style-name="T3">submitButtonId.Click</text:span> += new System.EventHandler(this.Button_Clicked);<text:line-break/> ...<text:line-break/> }<text:line-break/> ...<text:line-break/> private void Button_Clicked(object sender, EventArgs e)<text:line-break/> {<text:line-break/> ...<text:line-break/> if (IsValid &amp;&amp; <text:span text:style-name="Variable">inputFileId</text:span>.HasFile)<text:line-break/> {<text:line-break/> ...<text:line-break/>
<text:span text:style-name="Variable">inputFileId</text:span>.MoveTo(Path.Combine(Request.PhysicalApplicationPath,<text:span text:style-name="Variable">inputFileId</text:span>.FileName),<text:line-break/> MoveToOptions.Overwrite);</text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">If you are using the <text:span text:style-name="Source_20_Text">MultiFile</text:span> control, the <text:span text:style-name="Variable">multiFileId</text:span>
<text:span text:style-name="Source_20_Text">.Files</text:span> property returns an array of <text:span text:style-name="Source_20_Text">UploadedFile</text:span> objects. <text:s/>Those objects have members similar to the above <text:span text:style-name="Source_20_Text">InputFile</text:span> members, that you can use to save and access the uploaded files. <text:s/>
</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Allowing Users with Flash to Select Multiple Files from One File Selection Dialog</text:h>
<text:p text:style-name="Text_20_body">By default, the NeatUpload <text:span text:style-name="Source_20_Text">MultiFile</text:span> control requires the user to use select each file they want to upload using a new file selection dialog. <text:s/>This can be cumbersome when uploading a large number of files. <text:s/>If you set <text:span text:style-name="Source_20_Text">MultiFile</text:span>'s <text:span text:style-name="Source_20_Text">UseFlashIfAvailable</text:span> property to true, then users with Flash 8 or higher well be able select multiple files from a single file selection dialog (e.g. using shift-click or ctrl-click). <text:s/>For all other users, the experience will remain unchanged. <text:s/>You can set <text:span text:style-name="Source_20_Text">MultiFile</text:span>'s <text:span text:style-name="Source_20_Text">FlashFilterExtensions</text:span> property to a semicolon delimited list of extension patterns (e.g. â€œ*.jpg;*.gifâ€) that Flash will <text:s/>allow the user to select in the file selection dialog. <text:s/>You can also set <text:span text:style-name="Source_20_Text">MultiFile</text:span>'s <text:span text:style-name="Source_20_Text">FlashFilterDescription</text:span> to a short textual description of the files that Flash will allow the user to select. <text:s/>Flash displays that description in the file selection dialog.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Validating File Names</text:h>
<text:p text:style-name="Text_20_body">NeatUpload's <text:span text:style-name="Source_20_Text">MultiFile</text:span> and <text:span text:style-name="Source_20_Text">InputFile</text:span> controls can be used with validation controls (e.g. <text:span text:style-name="Source_20_Text">RegularExpressionValidator</text:span>) to restrict the file names that are allowed. <text:s/>If the validation control is capable of client-side validation and the browser supports JavaScript, the file names will be validated before the upload starts. <text:s/>Otherwise, they will be validated after the files have been uploaded. <text:s/>Note that the validation controls in ASP.NET 1.1 don't do client-side validation for many non-IE browsers. <text:s/>That is fixed in ASP.NET 2.0 and later. <text:s/>Developers using ASP.NET 1.1 should consider alternative validation controls.</text:p>
<text:p text:style-name="Text_20_body">To validate an <text:span text:style-name="Source_20_Text">InputFile</text:span> or <text:span text:style-name="Source_20_Text">MultiFile</text:span> control using an ASP.NET validator, just set the validator's <text:span text:style-name="Source_20_Text">ControlToValidate</text:span> property to the ID of the <text:span text:style-name="Source_20_Text">InputFile</text:span> or <text:span text:style-name="Source_20_Text">MultiFile</text:span> control. <text:s/>For the <text:span text:style-name="Source_20_Text">InputFile</text:span> control, the validator will validate the <text:span text:style-name="Source_20_Text">ValidationFileName</text:span> property which is the same as the <text:span text:style-name="Source_20_Text">FileName</text:span> property except that is an empty string (instead of null) when there are no files. <text:s/>For the <text:span text:style-name="Source_20_Text">MultiFile</text:span> control, the validator will validate the <text:span text:style-name="Source_20_Text">ValidationFileNames</text:span> property which is a semicolon-delimited list of the file names, or an empty string if there are no files. <text:s/>The <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/Brettle.Web.NeatUpload/Demo.aspx </text:span>page contains examples of using <text:span text:style-name="Source_20_Text">RegularExpressionValidators</text:span> to validate <text:span text:style-name="Source_20_Text">InputFile</text:span> and <text:span text:style-name="Source_20_Text">MultiFile</text:span> controls.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Preventing Accidental Upload Interruptions</text:h>
<text:p text:style-name="Text_20_body">By default, any in-progress uploads are uploaded when a user resubmits the form, closes the browser window, or attempts to view another page in the same window that started the upload. <text:s/>To prevent a user from accidentally interrupting the upload in any of those ways add the <text:span text:style-name="Source_20_Text">UnloadConfirmer</text:span> control to your page. <text:s/>It will display a confirmation dialog to the user if they do something that would interrupt the upload. <text:s/>The text of the confirmation defaults to the <text:span text:style-name="Source_20_Text">UnloadConfirmation</text:span> resource in <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Variable">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/src/Brettle.Web.NeatUpload/NeatUpload.Strings.resx</text:span> and can be overriden using the <text:span text:style-name="Source_20_Text">Text</text:span> property of the <text:span text:style-name="Source_20_Text">UnloadConfirmer</text:span> control.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId900479"/>Avoiding Unnecessary Uploads and Progress Displays</text:h>
<text:p text:style-name="Text_20_body">By default, anytime the user submits a form containing a non-empty <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> and a <text:span text:style-name="Source_20_Text">ProgressBar</text:span>, the progress display is started (either inline or in a popup). Â If all <text:span text:style-name="Source_20_Text">MultiFile</text:span> and <text:span text:style-name="Source_20_Text">InputFiles</text:span> are empty, the progress display is not started. Â That ensures that the user is not distracted by a transient and meaningless progress display.<text:line-break/>
<text:line-break/>Now consider the case where the form contains a cancel button in addition to a normal submit button. Â Both buttons cause the form to be submitted, but when the cancel button is clicked, the server ignores the values on the form. Â By default, if the user selects a file to upload and then changes his mind and clicks the cancel button, the progress display will start and the user will need to wait for the file to be uploaded. Â To avoid this unfriendly behavior, NeatUpload allows you to specify "trigger" controls. Â If you specify at least one trigger, then form submissionsÂ initiated via any <text:span text:style-name="T3">other</text:span> control will cause NeatUpload to clear all the <text:span text:style-name="Source_20_Text">MultiFile</text:span> and <text:span text:style-name="Source_20_Text">InputFile</text:span> controls so that no files will be uploaded and the progress display will not start. Â (On some downlevel browsers, notably Internet Explorer for the Mac, NeatUpload can't clear the controls so it displays a dialog asking the user to clear them manually and try again. Â The text for that dialog can be customized via the <text:span text:style-name="Source_20_Text">ClearFileNamesAlert</text:span> resource in <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Variable">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/src/Brettle.Web.NeatUpload/NeatUpload.Strings.resx</text:span>.)<text:line-break/>
<text:line-break/>If your form contains more than one <text:span text:style-name="Source_20_Text">ProgressBar</text:span>, each <text:span text:style-name="Source_20_Text">ProgressBar</text:span> which specifies trigger controls will only start when the form submission is initiated by one of those controls.<text:line-break/>
<text:line-break/>There are two ways to indicate that a control is a "trigger" control. <text:s/>The first way is to include the ID of the control in the <text:span text:style-name="Source_20_Text">ProgressBar</text:span>'s <text:span text:style-name="Source_20_Text">Triggers </text:span>property/attribute. <text:s/>Multiple IDs must be space-separated. <text:s/>Each ID can either by the <text:span text:style-name="Source_20_Text">ID</text:span> or <text:span text:style-name="Source_20_Text">ClientID</text:span> property of the trigger. <text:s/>The second way is to call the ProgressBar's <text:span text:style-name="Source_20_Text">AddTrigger(Control)</text:span> method. Â Note: if you call the <text:span text:style-name="Source_20_Text">AddTrigger(Control)</text:span> method, you need to call it each time the page is loaded (even when <text:span text:style-name="Source_20_Text">Page.IsPostBack</text:span> is <text:span text:style-name="Source_20_Text">true</text:span>) because the list of trigger controls is not maintained in the page's <text:span text:style-name="Source_20_Text">ViewState</text:span>.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Showing Processing Progress</text:h>
<text:p text:style-name="Text_20_body">By default, the NeatUpload <text:span text:style-name="Source_20_Text">ProgressBar</text:span> displays "Processing..." (the <text:span text:style-name="Source_20_Text">ProcessingMessage</text:span> resource in <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Variable">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/src/Brettle.Web.NeatUpload/NeatUpload.Strings.resx</text:span>) if it refreshes while the code associated with your page runs. In most cases your code finishes running before the display refreshes, so you never see that text. However, if you perform some long-running task (e.g. converting large images to a different format) you can use the <text:span text:style-name="Source_20_Text">ProgressBar</text:span> to display how that task is progressing. </text:p>
<text:p text:style-name="Text_20_body">To display the progress of a long-running task, you first must set some properties on your page and the <text:span text:style-name="Source_20_Text">ProgressBar</text:span> control. Specifically: </text:p>
<text:list text:style-name="L10">
<text:list-item>
<text:p text:style-name="P49">Use <text:span text:style-name="Source_20_Text">EnableSessionState="false"</text:span> in your <text:span text:style-name="Source_20_Text">&lt;%@Page ...%&gt;</text:span> directive. If you don't do that your page will hold a lock on the session for the duration of your long-running task. That will block the display of any other pages which need access to the session until your long-running task completes. More importantly, NeatUpload's progress display will not update because it needs access to the session to determine how the upload is progressing. If you need to access the session from your page, you should consider moving the code that requires that access into a web method that you can can from your page.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P49">If you're form doesn't contain any <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> controls you need to add a <text:span text:style-name="Source_20_Text">HiddenPostBackID</text:span> control at the top of the form so that NeatUpload can associate the form submission with the progress display. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P49">If you want to display progress even if the user doesn't upload a file (either because your form doesn't have a way to select file or because the user chose not to select a file), you need to set the <text:span text:style-name="Source_20_Text">ProgressBar</text:span>'s <text:span text:style-name="Source_20_Text">AutoStartCondition</text:span> property to the string <text:span text:style-name="Source_20_Text">"true"</text:span>. </text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">To actually update the progress display from the your page: </text:p>
<text:list text:style-name="L11">
<text:list-item>
<text:p text:style-name="P113">Set the <text:span text:style-name="Source_20_Text">ProgressBar</text:span>'s <text:span text:style-name="Source_20_Text">ProcessingProgress</text:span> property to a new <text:span text:style-name="Source_20_Text">ProgressInfo</text:span> object, passing to the constructor the maximum number of work units that will be performed and a string describing those units. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P113">Update the <text:span text:style-name="Source_20_Text">ProgressInfo</text:span>'s <text:span text:style-name="Source_20_Text">Value</text:span> property as the task progresses. The <text:span text:style-name="Source_20_Text">Value</text:span> property will control the position of the bar. If <text:span text:style-name="Source_20_Text">Value</text:span> is 0, no bar will be shown. If it is equal to the <text:span text:style-name="Source_20_Text">Maximum</text:span> property (initialized via the constructor), a full bar will be shown. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P52">Optionally, update the <text:span text:style-name="Source_20_Text">ProgressInfo</text:span>'s <text:span text:style-name="Source_20_Text">Text</text:span> property. By default, when a <text:span text:style-name="Source_20_Text">ProgressBar</text:span>'s <text:span text:style-name="Source_20_Text">ProcessingProgress</text:span> property has been set, it will display "<text:span text:style-name="T3">Value</text:span>/<text:span text:style-name="T3">Maximum</text:span>
<text:span text:style-name="T3">Units</text:span> processed" where <text:span text:style-name="T3">Value</text:span>, <text:span text:style-name="T3">Maximum</text:span>, and <text:span text:style-name="T3">Units</text:span> are the corresponding properties of the <text:span text:style-name="Source_20_Text">ProgressInfo</text:span> object. You can localize that text via the <text:span text:style-name="Source_20_Text">ProgressInfoFormat</text:span> resource in <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Variable">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/src/Brettle.Web.NeatUpload/NeatUpload.Strings.resx</text:span> or you can replace that text completely by setting the <text:span text:style-name="Source_20_Text">ProgressInfo</text:span>'s <text:span text:style-name="Source_20_Text">Text</text:span> property. </text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">Here's an example: </text:p>
<text:p text:style-name="Preformatted_20_Text">...<text:line-break/>myProgressBar.ProcessingProgress = new ProgressInfo(5, "images");<text:line-break/>for (int i = 1; i &lt;= 5; i++)<text:line-break/>{<text:line-break/>
<text:s text:c="7"/>ConvertImage(i);<text:line-break/>
<text:s text:c="7"/>myProgressBar.ProgressInfo.Value = i;<text:line-break/>}<text:line-break/>myProgressBar.ProgressInfo.Text = "Image conversion complete";<text:line-break/>...</text:p>
<text:p text:style-name="Text_20_body">For a complete working example, see <text:span text:style-name="Source_20_Text">Processing.aspx</text:span> and <text:span text:style-name="Source_20_Text">Processing.aspx.cs</text:span> in the <text:span text:style-name="Source_20_Text">NeatUpload-1.3.x/dotnet/app/Brettle.Web.NeatUpload/tests/</text:span> directory. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="UploadingWithoutInputFile"/>Uploading without <text:span text:style-name="Source_20_Text">InputFile</text:span>
</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload will stream to storage only those files associated with <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> controls.Â  Other files will be processed by ASP.NET and will only cause any <text:span text:style-name="Source_20_Text">ProgressBar</text:span>s to update if they happen to occur after a file that NeatUpload has streamed.Â  To tell NeatUpload to stream the other files, you must put a <text:span text:style-name="Source_20_Text">HiddenPostBackID</text:span> control in your form before the controls used to upload those other files.Â  If you are using the Visual Studio web form designer, just drag-and-drop the control at the top of your form.Â  Otherwise, just manually add <text:span text:style-name="Source_20_Text">&lt;Upload:HiddenPostBackID runat="server"/&gt;</text:span> just inside the <text:span text:style-name="Source_20_Text">&lt;form&gt;</text:span> element on your page.Â  There are no properties to set. </text:p>
<text:p text:style-name="Text_20_body">Files that NeatUpload streams to storage are not available via the standard ASP.NET <text:span text:style-name="Source_20_Text">Request.Files</text:span> property.Â  Instead, they must be accessed via the static <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.UploadModule.Files</text:span> property.Â  Since ASP.NET doesn't allow subclassing of the <text:span text:style-name="Source_20_Text">HttpFileCollection</text:span> returned by <text:span text:style-name="Source_20_Text">Request.Files</text:span> (nor the <text:span text:style-name="Source_20_Text">HttpPostedFile</text:span> class), NeatUpload attempts to mimic their API with new classes called <text:span text:style-name="Source_20_Text">UploadedFileCollection</text:span> and <text:span text:style-name="Source_20_Text">UploadedFile</text:span>.Â  <text:span text:style-name="Source_20_Text">UploadModule.Files</text:span> only contains an <text:span text:style-name="Source_20_Text">UploadedFile</text:span> object for files that NeatUpload streamed to storage. <text:s/>To convert an <text:span text:style-name="Source_20_Text">HttpPostedFile</text:span> to an <text:span text:style-name="Source_20_Text">UploadedFile</text:span>, pass it to <text:span text:style-name="Source_20_Text">UploadModule.ConvertToUploadedFile()</text:span>. <text:s/>If the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> is listed in the <text:span text:style-name="Source_20_Text">&lt;httpModules&gt;</text:span> section (even if it is disabled), <text:span text:style-name="Source_20_Text">ConvertToUploadedFile()</text:span> will stream the file to storage and return a corresponding <text:span text:style-name="Source_20_Text">UploadedFile</text:span>.Â  If no upload module is listed in the <text:span text:style-name="Source_20_Text">&lt;httpModules&gt;</text:span> section, <text:span text:style-name="Source_20_Text">ConvertToUploadedFile()</text:span> will return a subclass of <text:span text:style-name="Source_20_Text">UploadedFile</text:span> that delegates to the underlying <text:span text:style-name="Source_20_Text">HttpPostedFile</text:span>.</text:p>
<text:p text:style-name="Text_20_body">There is one important difference between <text:span text:style-name="Source_20_Text">UploadedFile</text:span> and <text:span text:style-name="Source_20_Text">HttpPostedFile</text:span>. <text:s/>You must call the <text:span text:style-name="Source_20_Text">Dispose()</text:span> method of each <text:span text:style-name="Source_20_Text">UploadedFile</text:span> you use when you are done with it. <text:s/>If you do not call <text:span text:style-name="Source_20_Text">Dispose()</text:span>, temporary files or other similar resources might not get cleaned up. <text:s/>This is particularly important if the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> is disabled or not listed in the <text:span text:style-name="Source_20_Text">&lt;httpModules&gt;</text:span> section.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId483750"/>Uploading from a Client Application</text:h>
<text:p text:style-name="Text_20_body">If your users are uploading using their web browser, you don't need to read this section. Â This section is for environments where a separate client application uses HTTP POST requests to uploads files to your application. Â You should read the earlier sections before reading this one.<text:line-break/>
<text:line-break/>In order for NeatUpload to process requests from non-browser client applications, each request needs to contain a unique IDÂ called a post-back ID. Â NeatUpload looks for the post-back ID in a parameter that is in either the query string or in a form field in the body of the request that occurs before the files to be streamed. Â The parameter name is <text:a xlink:type="simple" xlink:href="#mozTocId991184">configurable</text:a>. Â By default, NeatUpload looks for a parameter named "NeatUpload_PostBackID". Â The post-back ID itself does not need to be in any particular format, but it needs to be unique for each request. Â So, for example, if the client application uploads the file to :</text:p>
<text:p text:style-name="P4">http://www.tempuri.org/path/to/MyUploadPage.aspx?NeatUpload_PostBackID=afa02a6999e54541bb6873151d1dfbfc</text:p>
<text:p text:style-name="Text_20_body">
<text:line-break/>then NeatUpload will use "afa02a6999e54541bb6873151d1dfbfc" as the post-back ID.<text:line-break/>
<text:line-break/>If NeatUpload finds the post-back ID in the query string it will stream all files in the request to storage. Â You can access the uploaded file via the static <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.UploadModule.Files</text:span> property.Â Alternatively, you can put <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> controls on your page and make sure that the name of the form field(s) used by the client application match the control IDs of your <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> control(s). Â So, if your client application uses a field name of "FILE001", you could put the following in your page:</text:p>
<text:p text:style-name="Preformatted_20_Text">...<text:line-break/>&lt;Upload:InputFile id="FILE001" runat="server" /&gt;<text:line-break/>...</text:p>
<text:p text:style-name="Text_20_body"/>
<text:h text:style-name="Heading_20_1" text:outline-level="1">
<text:bookmark text:name="mozTocId221000"/>Configuration</text:h>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId576312"/>Using the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> Configuration Section</text:h>
<text:p text:style-name="Text_20_body">To configure NeatUpload, you need to add the NeatUpload configuration section handler to your <text:span text:style-name="Source_20_Text">Web.config</text:span>:</text:p>
<text:p text:style-name="Preformatted_20_Text">&lt;configuration&gt;<text:line-break/>
<text:s text:c="3"/>&lt;configSections&gt;<text:line-break/>
<text:s text:c="7"/>&lt;section name="neatUpload" type="Brettle.Web.NeatUpload.ConfigSectionHandler, Brettle.Web.NeatUpload" allowLocation="true" /&gt;<text:line-break/>
<text:s text:c="3"/>&lt;/configSections&gt;<text:line-break/>...</text:p>
<text:p text:style-name="Text_20_body">Once you've added the configuration section handler, you can add the &lt;neatUpload&gt; element inside your <text:span text:style-name="Source_20_Text">Web.config </text:span>like this:</text:p>
<text:p text:style-name="Preformatted_20_Text">&lt;configuration&gt;<text:line-break/>
<text:s text:c="3"/>...<text:line-break/>
<text:s text:c="7"/>&lt;neatUpload xmlns="http://www.brettle.com/neatupload/config/2008"<text:line-break/>
<text:s text:c="11"/>
<text:a xlink:type="simple" xlink:href="#0.0.2.Using Location Filtering to Restrict/Modify NeatUpload's Request Processing|outline">useHttpModule</text:a>="<text:span text:style-name="T3">true or false, defaults to true</text:span>"<text:line-break/>
<text:s text:c="11"/>
<text:a xlink:type="simple" xlink:href="#0.0.2.Changing the Maximum Size of Normal Requests|outline">maxNormalRequestLength</text:a>="<text:span text:style-name="T3">up to 2097151</text:span>
<text:span text:style-name="T3">in KBytes, defaults to 4096</text:span>" <text:line-break/>
<text:s text:c="11"/>
<text:a xlink:type="simple" xlink:href="#0.0.2.Limiting the Size of Upload Requests|outline">maxRequestLength</text:a>="<text:span text:style-name="T3">up to 2097151</text:span>
<text:span text:style-name="T3">in KBytes, defaults to 2097151</text:span>" <text:line-break/>
<text:s text:c="11"/>
<text:a xlink:type="simple" xlink:href="#0.0.2.Limiting the Upload Rate|outline">maxUploadRate</text:a>="<text:span text:style-name="T3">rate in KBytes/sec, defaults to -1 which means unlimited</text:span>"<text:line-break/>
<text:s text:c="11"/>
<text:a xlink:type="simple" xlink:href="#0.0.2.Changing the Query String Parameter Used When Uploading From Client Applications|outline">postBackIDQueryParam</text:a>="<text:span text:style-name="T3">parameter name, defaults to NeatUpload_PostBackID</text:span>"<text:line-break/>
<text:s text:c="11"/>
<text:a xlink:type="simple" xlink:href="#0.0.2.Changing the Location of NeatUpload's Files|outline">multiRequestUploadHandlerUrl</text:a>=<text:span text:style-name="T9">"</text:span>
<text:span text:style-name="T14">URL that handles the requests in a multi-request upload,<text:line-break/>
<text:s text:c="41"/>defaults to ~/NeatUpload/MultiRequestUploadHandler.ashx</text:span>
<text:span text:style-name="T15">"<text:line-break/>
<text:s text:c="11"/>
</text:span>
<text:a xlink:type="simple" xlink:href="#0.1.Troubleshooting|outline">debugDirectory</text:a>
<text:span text:style-name="T15">="d</text:span>
<text:span text:style-name="T14">irectory to which debug info should be written, defaults to none</text:span>
<text:span text:style-name="T16">"<text:line-break/>
<text:s text:c="11"/>
</text:span>
<text:a xlink:type="simple" xlink:href="#0.0.2.Supporting Web Gardens and Web Farms|outline">validationKey</text:a>
<text:span text:style-name="T16">="</text:span>
<text:span text:style-name="T14">40 hex-digit key used to sign and validate protected data, <text:line-break/>
<text:s text:c="26"/>defaults to auto-generated for each app instance</text:span>
<text:span text:style-name="T16">"</text:span>
<text:line-break/>
<text:span text:style-name="T16">
<text:s text:c="11"/>
</text:span>
<text:a xlink:type="simple" xlink:href="#0.0.2.Supporting Web Gardens and Web Farms|outline">encryptionKey</text:a>
<text:span text:style-name="T16">="32</text:span>
<text:span text:style-name="T14">hex-digit key used to encrypt/decrypt protected data, <text:line-break/>
<text:s text:c="26"/>defaults to auto-generated for each app instance</text:span>
<text:span text:style-name="T16">"</text:span>
<text:line-break/>
<text:span text:style-name="T16">
<text:s text:c="11"/>
</text:span>
<text:a xlink:type="simple" xlink:href="#0.0.2.Reducing Server Load|outline">stateMergeIntervalSeconds</text:a>
<text:span text:style-name="T16">="secs between</text:span>
<text:span text:style-name="T14">merges of the current and stored upload states,<text:line-break/>
<text:s text:c="38"/>defaults to 1</text:span>
<text:span text:style-name="T16">"</text:span>
<text:line-break/>
<text:span text:style-name="T16">
<text:s text:c="11"/>
</text:span>
<text:a xlink:type="simple" xlink:href="#0.0.2.Reducing Server Load|outline">stateStaleAfterSeconds</text:a>
<text:span text:style-name="T16">="</text:span>
<text:span text:style-name="T14">secs before an unchanged upload state can be removed from the store,<text:line-break/>
<text:s text:c="35"/>defaults to 60</text:span>
<text:span text:style-name="T16">"</text:span>
<text:line-break/>
<text:s text:c="11"/>defaultStorageProvider="<text:span text:style-name="T3">friendly name, <text:line-break/>
<text:s text:c="35"/>defaults to a FilesystemUploadStorageProvider with </text:span>
<text:a xlink:type="simple" xlink:href="#TempDirectory">
<text:span text:style-name="T3">default temp dir</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="#TempDirectory"/>"<text:line-break/>
<text:s text:c="11"/>defaultStateStoreProvider="<text:span text:style-name="T3">friendly name, defaults to a AdaptiveUploadStateStoreProvider</text:span>"<text:line-break/>&gt;<text:line-break/>
<text:s text:c="11"/>&lt;providers&gt;<text:line-break/>
<text:s text:c="15"/>&lt;add name="<text:span text:style-name="T3">friendly name</text:span>" <text:line-break/>
<text:s text:c="20"/>type="<text:span text:style-name="T3">type derived from Brettle.Web.NeatUpload.UploadStorageProvider</text:span>" <text:line-break/>
<text:s text:c="20"/>
<text:span text:style-name="T3">provider-specific-</text:span>
<text:span text:style-name="T10">attributes</text:span>
<text:span text:style-name="T9">...</text:span> /&gt;<text:line-break/>
<text:s text:c="11"/>&lt;/providers&gt;<text:line-break/>
<text:s text:c="7"/>&lt;/neatUpload&gt;<text:line-break/>
<text:s text:c="7"/>...<text:line-break/>&lt;/configuration&gt;</text:p>
<text:p text:style-name="Text_20_body">All of the attributes are optional. <text:s/>The xmlns attribute allows the Visual Studio XML Editor to provide Intellisense support for the &lt;neatUpload&gt; element using the NeatUpload/NeatUploadConfig.xsd file in your application. <text:s/>The remaining attributes are described in the remainder of this section and in the sections linked to the attribute names above.</text:p>
<text:p text:style-name="Text_20_body">The <text:span text:style-name="Source_20_Text">&lt;providers&gt;</text:span> element is also optional. You only need to use it if you are using an <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span> or <text:span text:style-name="Source_20_Text">UploadStateStoreProvider</text:span> other than the default providers, or if you need to change the temporary directory used by the <text:span text:style-name="Source_20_Text">FilesystemUploadStorageProvider</text:span>. In those cases, you should include an &lt;add&gt; element for each provider or provider configuration you will be using and set the &lt;neatUpload&gt; element's <text:span text:style-name="Source_20_Text">defaultStorageProvider</text:span> or <text:span text:style-name="Source_20_Text">defaultStateStoreProvider</text:span> attribute to the name you chose for the provider you want to use by default. For specific pages or directories, you can override that default or add/remove/clear available providers using child configuration sections. Child configuration sections are &lt;neatUpload&gt; elements within &lt;location&gt; elements or in Web.config files in subdirectories.</text:p>
<text:p text:style-name="Text_20_body">Each provider object is created and initialized at most once during the application lifecycle - when the configuration section containing the associated &lt;add&gt; element is relevant to a request. A configuration section is relevant to a request if the request matches the "path" attribute of the containing &lt;location&gt; element. If there is no containing &lt;location&gt; element, the configuration section is relevant if the requested page is in the directory hierarchy controlled by the containing Web.config. This means that multiple provider objects might be created and initialized in response to a request, but only the one configured as the "defaultStorageProvider" or â€œdefaultStateStoreProviderâ€ for the requested page is actually used for that request. The others might be configured as default providers for other pages. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="TempDirectory"/>Changing the Temporary Directory Used by the FilesystemUploadStorageProvider</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload puts uploaded files in temporary files in <text:span text:style-name="Source_20_Text">
<text:span text:style-name="T3">YOUR_APP_ROOT</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"> \app_data\NeatUpload_Temp\</text:span> if it exists (or can be created) and is writable by your application, or failing that, it puts them in the <text:a xlink:type="simple" xlink:href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemiopathclassgettemppathtopic.asp">system's temporary directory</text:a>. You can specify a different directory using the <text:span text:style-name="Source_20_Text">tempDirectory</text:span> attribute of the <text:span text:style-name="Source_20_Text">FilesystemUploadStorageProvider</text:span>, like this: </text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="2"/>&lt;neatUpload ...<text:span text:style-name="Source_20_Text"> defaultStorageProvider="FilesystemUploadStorageProvider" ...</text:span>&gt;<text:line-break/>
<text:span text:style-name="Source_20_Text">
<text:s text:c="2"/>&lt;providers&gt;<text:line-break/>
<text:s text:c="7"/>...<text:line-break/>
<text:s text:c="3"/>&lt;add name="FilesystemUploadStorageProvider" <text:line-break/>
<text:s text:c="5"/>type="Brettle.Web.NeatUpload.FilesystemUploadStorageProvider" <text:line-break/>
<text:s text:c="5"/>tempDirectory="</text:span>
<text:span text:style-name="Source_20_Text">
<text:span text:style-name="T3">path, defaults as described above</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"> " ... /&gt;<text:line-break/>
<text:s text:c="7"/>...<text:line-break/>
<text:s text:c="2"/>&lt;/providers&gt;<text:line-break/>
</text:span>
<text:s/>&lt;/neatUpload&gt;<text:line-break/>
<text:s text:c="7"/>
</text:p>
<text:p text:style-name="Text_20_body">If you specify a relative path, it will be relative to your application root directory. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Supporting Web Gardens and Web Farms</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload won't work properly on a web garden or web farm. <text:s/>To use NeatUpload is a web garden or web farm, you need to specify the same random 40-hex-digit <text:span text:style-name="Source_20_Text">validationKey</text:span> and 32-hex-digit <text:span text:style-name="Source_20_Text">encryptionKey</text:span> attributes in the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> section of each server's <text:span text:style-name="Source_20_Text">Web.config</text:span>. <text:s/>Those keys allows NeatUpload to securely communicate the state of uploads across all application instances.</text:p>
<text:p text:style-name="Text_20_body">In addition, if you are using a control that performs multi-request uploads like the <text:span text:style-name="Source_20_Text">MultiFile</text:span> control with <text:span text:style-name="Source_20_Text">useFlashWhenAvailable=â€trueâ€</text:span> you must specify a shared location for the uploaded files to be stored temporarily. <text:s/>You could configure a <text:span text:style-name="Source_20_Text">FilesystemUploadStorageProvider</text:span> to use a network share as the temporary directory, if the network share is readable and writable by the ASP.NET worker process. <text:s/>Alternatively, you could use a different <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span> (e.g. the one used by the <text:span text:style-name="Source_20_Text">SqlServerInputFile</text:span> extension) which stores the uploaded files in a shared location.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Using Location Filtering to Restrict/Modify NeatUpload's Request Processing</text:h>
<text:p text:style-name="Text_20_body">By default, whenever NeatUpload's <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> is added via the <text:span text:style-name="Source_20_Text">&lt;httpModules&gt;</text:span> section of your <text:span text:style-name="Source_20_Text">Web.config</text:span>, it intercepts and filters <text:span text:style-name="T3">all</text:span> requests sent to your application. Â For upload requests, it streams the uploaded files to disk and makes them available to your code. Â It also limits the size of the non-upload part of the request <text:span text:style-name="T3">and the total size of non-upload requests</text:span> because that request data is stored in server memory. Â If it didn't do that an attacker could mount a Denial of Service attack by sending a request that contains up to <text:span text:style-name="Source_20_Text">maxRequestLength</text:span> kilobytes of non-file data.</text:p>
<text:p text:style-name="Text_20_body">You can disable use of <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> by settting the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element's <text:span text:style-name="Source_20_Text">useHttpModule</text:span> attribute to false. Â If you want to use the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> for only some requests, you can use ASP.NET's <text:span text:style-name="Source_20_Text">&lt;location&gt;</text:span> element to specify which pages it should be used for. Â You can also use the <text:span text:style-name="Source_20_Text">&lt;location&gt;</text:span> element to control which <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span> is used for specific pages. Â For example, consider the following configuration:</text:p>
<text:p text:style-name="P19">&lt;configuration&gt;<text:line-break/> ...<text:line-break/> &lt;system.web&gt;<text:line-break/>
<text:s/>...<text:line-break/>
<text:s/>&lt;httpRuntime maxRequestLength="100" /&gt;<text:line-break/>
<text:s/>...<text:line-break/>
<text:s/>&lt;httpModules&gt;<text:line-break/>
<text:s text:c="2"/>&lt;add name="UploadHttpModule" type="Brettle.Web.NeatUpload.UploadHttpModule, Brettle.Web.NeatUpload" /&gt;<text:line-break/>
<text:s text:c="2"/>...<text:line-break/>
<text:s/>&lt;/httpModules&gt;<text:line-break/>
<text:s/>...<text:line-break/> &lt;/system.web&gt;<text:line-break/> ...<text:line-break/> &lt;neatUpload ... useHttpModule="false" maxNormalRequestLength="100" maxRequestLength="2097151"&gt;<text:line-break/>
<text:s/>&lt;providers&gt;<text:line-break/>
<text:s text:c="2"/>&lt;add name="special" type="Brettle.Web.NeatUpload.FilesystemUploadStorageProvider" <text:line-break/>
<text:s text:c="3"/>tempDirectory="SpecialTempDirectory" /&gt;<text:line-break/>
<text:s/>&lt;/providers&gt;<text:line-break/> &lt;/neatUpload&gt;<text:line-break/> ...<text:line-break/> &lt;location path="Upload.aspx"&gt;<text:line-break/>
<text:s/>&lt;system.web&gt;<text:line-break/>
<text:s text:c="2"/>&lt;httpRuntime maxRequestLength="2097151" executionTimeout="3600" /&gt;<text:line-break/>
<text:s/>&lt;/system.web&gt;<text:line-break/>
<text:s/>&lt;neatUpload useHttpModule="true" /&gt;<text:line-break/> &lt;/location&gt;<text:line-break/> &lt;location path="Special.aspx"&gt;<text:line-break/>
<text:s/>&lt;system.web&gt;<text:line-break/>
<text:s text:c="2"/>&lt;httpRuntime maxRequestLength="2097151" executionTimeout="3600" /&gt;<text:line-break/>
<text:s/>&lt;/system.web&gt;<text:line-break/>
<text:s/>&lt;neatUpload useHttpModule="true" defaultStorageProvider="special" /&gt;<text:line-break/> &lt;/location&gt;<text:line-break/>
<text:s/>...<text:line-break/>&lt;/configuration&gt;</text:p>
<text:p text:style-name="Text_20_body">That configuration will cause the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> toÂ only be used for requests to <text:span text:style-name="Source_20_Text">Upload.aspx</text:span> and <text:span text:style-name="Source_20_Text">Special.aspx</text:span>. Â In addition, ASP.NET's <text:span text:style-name="Source_20_Text">maxRequestLength</text:span> is set to only 100 KBytes for all requests other than those two pages. Â For those two pages, the <text:span text:style-name="Source_20_Text">maxRequestLength</text:span> is increased to 2 GBytes and the <text:span text:style-name="Source_20_Text">executionTimeout</text:span> is increased to 1 hour. Â Also, requests for <text:span text:style-name="Source_20_Text">Special.aspx</text:span> use the "special" provider which is configured to use the "<text:span text:style-name="Source_20_Text">SpecialTempDirectory</text:span>", while requests for <text:span text:style-name="Source_20_Text">Upload.aspx</text:span> use the default provider and the default temporary directory.<text:line-break/>
<text:line-break/>Note that you still need to add the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> in the <text:span text:style-name="Source_20_Text">&lt;httpModules&gt;</text:span> section so that it will be available to your application.Â  Location filtering just gives you finer control over which requests the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> actually touches.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="Limiting_the_Size_of_Upload_Requests"/>
<text:bookmark text:name="mozTocId970185"/>Limiting the Size of Upload Requests</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload does not directly limit the size of uploads. Â To limit upload size,Â use the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element's <text:span text:style-name="Source_20_Text">maxRequestLength </text:span>attribute: </text:p>
<text:p text:style-name="P4">&lt;neatUpload ... maxRequestLength="<text:span text:style-name="Emphasis">sizeInKBytes</text:span>" ... /&gt;</text:p>
<text:p text:style-name="Text_20_body">If a user attempts to upload a file larger than the specified size, NeatUpload will update the progress bar to indicate that the upload was rejected because it was too large. Â If the progress bar is in a pop-up window, it will leave the window open to ensure that the user sees why the upload was rejected. Â  Next it will attempt to stop the upload by asking the browser to run JavaScript that simulates clicking the browser's Stop button. Â If JavaScript is enabled, most modern browsers (including recent versions of IE, Firefox, and Opera) will be able to stop the upload and the user will simply see the original form along with the progress bar displaying the reason the upload was rejected. Â The remainder of this section only affects the user when the browser is <text:span text:style-name="T3">not</text:span> able to stop the upload.</text:p>
<text:p text:style-name="Text_20_body">After asking the browser to stop the upload using JavaScript, NeatUpload reads the remainder of the request and then throws an <text:span text:style-name="Source_20_Text">UploadTooLargeException</text:span> . Â The <text:span text:style-name="Source_20_Text">UploadTooLargeExceptionÂ </text:span>class is a subclass of <text:span text:style-name="Source_20_Text">UploadException</text:span> with an HTTP status code of 413. Â If the browser hasn't stopped the upload for some reason, the exception will cause the user to seeÂ a generic error page by default. Â If you want something more user-friendly, you can either handle the error by adding a handler for the <text:span text:style-name="Source_20_Text">HttpApplication.Error</text:span> event, or you can use a custom error page. Â NeatUpload comes with an example custom error page. Â To use it, add the following to yourÂ <text:span text:style-name="Source_20_Text">Web.config</text:span> under <text:span text:style-name="Source_20_Text">configuration/system.web</text:span>: </text:p>
<text:p text:style-name="Preformatted_20_Text">customErrors mode="On"&gt;<text:line-break/>
<text:s/>&lt;error statusCode="413" redirect="~/NeatUpload/Error413.aspx" /&gt;<text:line-break/>&lt;/customErrors&gt;</text:p>
<text:p text:style-name="Text_20_body">Note: most browsers, including IE and Firefox, won't display any new content until the entire upload has been sent to the server. Â If that takes longer than the amount of time specified via the <text:span text:style-name="Source_20_Text">httpRuntime</text:span> element's <text:span text:style-name="Source_20_Text">executionTimeout</text:span> attribute, the server may choose to close the connection and the user will see a different error. Â IE will display a generic error page saying "Page cannot be displayed". Â Firefox will display a dialog saying "Document contains no data". Â The default <text:span text:style-name="Source_20_Text">executionTimeout</text:span> is 360 seconds.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId358727"/>Changing the Maximum Size of Normal Requests</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload restricts the size of non-upload requests and the non-upload portion of upload requests to 4 MBytes. To specify a different maximum size,Â use the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element's <text:span text:style-name="Source_20_Text">maxNormalRequestLength </text:span>attribute: </text:p>
<text:p text:style-name="P4">&lt;neatUpload ... maxNormalRequestLength="<text:span text:style-name="Emphasis">sizeInKBytes</text:span>" ... /&gt;</text:p>
<text:p text:style-name="Text_20_body">The behavior when this value is exceeded is similar to the behavior when the <text:span text:style-name="Source_20_Text">maxRequestLength</text:span> is exceeded. Â See the preceding section for details. Â The only differences are: </text:p>
<text:list text:style-name="L12">
<text:list-item>
<text:p text:style-name="P115">For upload requests where the non-file portion exceeds the <text:span text:style-name="Source_20_Text">maxNormalRequestLength</text:span> limit, NeatUpload throws a <text:span text:style-name="Source_20_Text">NonfilePortionTooLargeException</text:span> instead of an <text:span text:style-name="Source_20_Text">UploadTooLargeException</text:span>. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P53">For non-upload requests that exceed the <text:span text:style-name="Source_20_Text">maxNormalRequestLength</text:span> limit, NeatUpload does not attempt to use JavaScript to interrupt the browser and the exception that is thrown is an <text:span text:style-name="Source_20_Text">HttpException(413, "Request Entity Too Large")</text:span> instead of an <text:span text:style-name="Source_20_Text">UploadTooLargeException()</text:span>. </text:p>
</text:list-item>
</text:list>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="MaxUploadRate"/>Limiting the Upload Rate</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload receives the upload as fast as it can. Â To limit the rate at which the upload is received, use the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element's <text:span text:style-name="Source_20_Text">maxUploadRate</text:span> attribute:</text:p>
<text:p text:style-name="P4">&lt;neatUpload ... maxUploadRate="<text:span text:style-name="Emphasis">rateInKBytesPerSec</text:span>" ... /&gt;</text:p>
<text:p text:style-name="Text_20_body">This is mostly useful when testing on your local machine. Â By limiting the upload rate, you can get a better idea how the progress display will look when users upload over the internet.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId652103"/>Configuring Individual InputFile and MultiFile Controls Programmatically</text:h>
<text:p text:style-name="Text_20_body">You can use the <text:span text:style-name="Source_20_Text">StorageConfig</text:span> property of each <text:span text:style-name="Source_20_Text">MultiFile</text:span> and <text:span text:style-name="Source_20_Text">InputFile</text:span> control to change the way the <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span> handles the file uploaded to that control. Â The interpretation of the <text:span text:style-name="Source_20_Text">StorageConfig</text:span> property depends on which <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span> is used. Â The default <text:span text:style-name="Source_20_Text">FilesystemUploadStorageProvider</text:span> only allows the temporary directory to be set via the <text:span text:style-name="Source_20_Text">StorageConfig</text:span> property. Â To programmatically set the temporary directory place a line like this inÂ <text:span text:style-name="Source_20_Text">Page_Load()</text:span>:</text:p>
<text:p text:style-name="P5">
<text:span text:style-name="T3">inputFileId</text:span>.StorageConfig["tempDirectory"] = "<text:span text:style-name="T3">path_to_temp_directory</text:span>";</text:p>
<text:p text:style-name="Text_20_body">Before using the <text:span text:style-name="Source_20_Text">StorageConfig</text:span> property, it is critical to understand how the <text:span text:style-name="Source_20_Text">StorageConfig</text:span> is communicated to the UploadStorageProvider to avoid some possible pitfalls. Â When the <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> control is rendered, NeatUpload encrypts the <text:span text:style-name="Source_20_Text">StorageConfig</text:span> with an encryption key, signs it with a validation key and then renders the ciphertext and signature in a hidden form field. Â When NeatUpload receives the upload request, it retrieves the form field value, verifies the signature, and decrypts the ciphertext to get the <text:span text:style-name="Source_20_Text">StorageConfig</text:span>. Â By default, NeatUpload automatically generates random encryption and validation keys when they are first needed during the application lifetime. Â However, you can set them explicitly by setting the <text:span text:style-name="Source_20_Text">encryptionKey</text:span> and <text:span text:style-name="Source_20_Text">validationKey</text:span> attributes of the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element to random 32 and 40 digit hexadecimal strings, respectively.<text:line-break/>
<text:line-break/>Encrypting and signing the <text:span text:style-name="Source_20_Text">StorageConfig</text:span> prevents an attacker from examining and modifying it. Â However, <text:span text:style-name="T1">it does not prevent replay attacks and it will cause uploads to be rejected if the server uses different keys for validation/decryption than it did for signing/encryption</text:span>. Â Follow the following rules to avoid these problems:</text:p>
<text:list text:style-name="L13">
<text:list-item>
<text:p text:style-name="P116">Only use <text:span text:style-name="Source_20_Text">StorageConfig</text:span> to configure a <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> control if you don't mindÂ an attacker associating that <text:span text:style-name="Source_20_Text">StorageConfig</text:span> with other <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> controlsÂ while the same validation key is being used. Â This is not typically a problem for <text:span text:style-name="Source_20_Text">StorageConfig["tempDirectory"]</text:span> because it is mostly used to specify a temporary directory on the same drive as the final location of the file to improve performance. Â If an attacker used aÂ  <text:span text:style-name="Source_20_Text">StorageConfig</text:span> from a different control, they would typically just get poor performance. Â Note, however, that if you decide to stop using a temporary directory, you should either change the validation key or use some other mechanism (e.g. change the permissions on the directory) to ensure that an upload that uses an old <text:span text:style-name="Source_20_Text">StorageConfig</text:span> can not write to the old directory. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P116">Only use <text:span text:style-name="Source_20_Text">StorageConfig</text:span> to configure a <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> control if you don't mind having uploads rejected while transitioning from old to new keys. Â NeatUpload will reject any uploads from forms rendered with the old key. Â The default rejection message is the value of the <text:span text:style-name="Source_20_Text">InvalidStorageConfigMessageFormat</text:span> resource in <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Variable">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/src/Brettle.Web.NeatUpload/NeatUpload.Strings.resx</text:span>. Â It defaults to "Please refresh the page and try again." </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P54">To use <text:span text:style-name="Source_20_Text">StorageConfig</text:span> in an environment (e.g. a web farm) where the server rendering the form could be different from the server that receives the upload request, you must manually configure all servers to use the same keys. </text:p>
</text:list-item>
</text:list>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Reducing Server Load</text:h>
<text:p text:style-name="Text_20_body">NeatUpload provides several configuration options that can help you reduce the load on the server associated with using NeatUpload.</text:p>
<text:p text:style-name="Text_20_body">First, if you are not using a web garden or web farm, you can use the <text:span text:style-name="Source_20_Text">InProcUploadStateStoreProvider</text:span> instead of the default <text:span text:style-name="Source_20_Text">AdaptiveUploadStateStoreProvider</text:span>, like this:</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="2"/>&lt;neatUpload ...<text:span text:style-name="Source_20_Text"> defaultStateStoreProvider="InProcUploadStateStoreProvider" ...</text:span>&gt;<text:line-break/>
<text:span text:style-name="Source_20_Text">
<text:s text:c="2"/>&lt;providers&gt;<text:line-break/>
<text:s text:c="7"/>...<text:line-break/>
<text:s text:c="3"/>&lt;add name="InProcUploadStateStoreProvider" <text:line-break/>
<text:s text:c="5"/>type="Brettle.Web.NeatUpload.InProcUploadStateStoreProvider "/&gt;<text:line-break/>
<text:s text:c="7"/>...<text:line-break/>
<text:s text:c="2"/>&lt;/providers&gt;<text:line-break/>
</text:span>
<text:s/>&lt;/neatUpload&gt;<text:line-break/>
<text:s text:c="7"/>
</text:p>
<text:p text:style-name="Text_20_body"/>
<text:p text:style-name="Text_20_body">That will prevent NeatUpload from making extra web requests to transfer upload state. <text:s/>The <text:span text:style-name="Source_20_Text">AdaptiveUploadStateStoreProvider</text:span> will only make one such request during the application lifetime if the session state mode is InProc or Off, but will make many requests per upload otherwise. <text:s/>The <text:span text:style-name="Source_20_Text">InProcUploadStateStoreProvider</text:span>, never makes any of those requests.</text:p>
<text:p text:style-name="Text_20_body">Next, if you are using a web garden or web farm, you can reduce the rate at which those extra web requests are made my setting the value of the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element's <text:span text:style-name="Source_20_Text">stateMergeIntervalSeconds</text:span> attribute to a value larger than the default value of 1. <text:s/>However, note that making such a change will cause the progress display to appear to update at no more than the corresponding rate.</text:p>
<text:p text:style-name="Text_20_body">Lastly, if you find that users are interrupting many uploads and the partial uploads are occupying too much storage space, you can reduce the time that NeatUpload waits to remove such partial uploads by reducing the value of the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element's <text:span text:style-name="Source_20_Text">stateStaleAfterSeconds</text:span> attribute from it's default of 60 seconds.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Changing the Location of NeatUpload's Files</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload looks for all the files it needs in the NeatUpload folder under your application root. <text:s/>If you want to move some of those files to other locations, this section will help tell NeatUpload where to find them.</text:p>
<text:p text:style-name="Text_20_body">If you move <text:span text:style-name="Source_20_Text">default.css</text:span>, <text:span text:style-name="Source_20_Text">cancel.png</text:span>, <text:span text:style-name="Source_20_Text">refresh.png</text:span>, or <text:span text:style-name="Source_20_Text">stop_refresh.png</text:span>, you need to <text:a xlink:type="simple" xlink:href="#0.1.0.Customizing Progress.aspx |outline">customize </text:a>
<text:a xlink:type="simple" xlink:href="#0.1.0.Customizing Progress.aspx |outline">
<text:span text:style-name="Source_20_Text">Progress.aspx</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="#0.1.0.Customizing Progress.aspx |outline"/>to refer to them in their new locations.</text:p>
<text:p text:style-name="Text_20_body">If you move <text:span text:style-name="Source_20_Text">Progress.aspx</text:span>, you need to set the <text:span text:style-name="Source_20_Text">ProgressBar</text:span>'s <text:span text:style-name="Source_20_Text">Url</text:span> property to refer to the new location.</text:p>
<text:p text:style-name="Text_20_body">If you move <text:span text:style-name="Source_20_Text">MultiRequestUploadHandler.ashx</text:span>, you need to set the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element's <text:span text:style-name="Source_20_Text">multiRequestUploadHandlerUrl</text:span> attribute to refer to the new location. <text:s/>You also need to ensure that sufficiently large requests are allowed and the upload module is enabled for the new location. <text:s/>The <text:span text:style-name="Source_20_Text">Web.config</text:span> file in the <text:span text:style-name="Source_20_Text">NeatUpload</text:span> folder does that.</text:p>
<text:p text:style-name="Text_20_body">If you move <text:span text:style-name="Source_20_Text">UploadStateStoreHandler.ashx</text:span>, you need to set the <text:span text:style-name="Source_20_Text">handlerUrl</text:span> attribute of the <text:span text:style-name="Source_20_Text">&lt;add&gt;</text:span> element that adds the <text:span text:style-name="Source_20_Text">AdaptiveUploadStateStoreProvider</text:span> so that it refers to the new location.</text:p>
<text:p text:style-name="Text_20_body">If you move <text:span text:style-name="Source_20_Text">Error413.aspx</text:span>, you need to change any <text:span text:style-name="Source_20_Text">&lt;customErrors&gt;</text:span> section of your <text:span text:style-name="Source_20_Text">Web.config</text:span> that refers to that page to refer to the new location.</text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">NeatUploadConfig.xsd</text:span> is only used to provide Intellisense for the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> section. <text:s/>It can be relocated to any location within your application without affecting Intellisense support. <text:s/>If you remove it entirely, your application will still function normally.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId991184"/>Changing the Query String Parameter Used When Uploading From Client Applications</text:h>
<text:p text:style-name="Text_20_body">If you are <text:a xlink:type="simple" xlink:href="#mozTocId483750">uploading from a client application</text:a>Â other than a browser, you might not have control over the name of the query string parameter that the application uses to identify each upload. Â To configure NeatUpload to look for a query string parameter with a particular name, the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element's <text:span text:style-name="Source_20_Text">postBackIDQueryParam</text:span> attribute:</text:p>
<text:p text:style-name="P4">&lt;neatUpload ... postBackIDQueryParam=" <text:span text:style-name="Emphasis">
<text:span text:style-name="T6">parameterName</text:span>
</text:span>
<text:span text:style-name="Emphasis"/>" ... /&gt;</text:p>
<text:p text:style-name="Text_20_body">The default value is "NeatUpload_PostBackID".</text:p>
<text:h text:style-name="Heading_20_1" text:outline-level="1">
<text:bookmark text:name="mozTocId250326"/>Customization</text:h>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="Customizing_Progress_aspx"/>
<text:bookmark text:name="mozTocId628349"/>Customizing <text:span text:style-name="Source_20_Text">Progress.aspx</text:span>
</text:h>
<text:p text:style-name="Text_20_body">The <text:span text:style-name="Source_20_Text">Progress.aspx</text:span> page that comes with NeatUpload is just an example. You can modify it to suit your needs. Â For example, you could change the color scheme with minor modification to the <text:span text:style-name="Source_20_Text">default.css</text:span> stylesheet that is included, or you could change the text or images that are used by modifying <text:span text:style-name="Source_20_Text">Progress.aspx</text:span> itself. Â You could even rearrange the layout entirely or create a new page derived from <text:span text:style-name="Source_20_Text">ProgressPage</text:span> and use the <text:span text:style-name="Source_20_Text">Url</text:span> property of the <text:span text:style-name="Source_20_Text">ProgressBar</text:span> to refer to it. Â To allow AJAX refreshless updates, you must include at least one <text:span text:style-name="Source_20_Text">DetailsSpan</text:span> or <text:span text:style-name="Source_20_Text">DetailsDiv</text:span> control. Â Those controls render as like <text:span text:style-name="Source_20_Text">div</text:span> and <text:span text:style-name="Source_20_Text">span</text:span> controls, respectively. Â Use data-binding expressions within those controls (either the in the content or properties) to access the details of the upload at runtime.Â  Below is a list of the properties and methods that NeatUpload provides for use in data-binding expressions. Â  Refer to the default <text:span text:style-name="Source_20_Text">Progress.aspx</text:span> for an example of how each of these is used. </text:p>
<table:table table:name="Table1" table:style-name="Table1">
<table:table-column table:style-name="Table1.A"/>
<table:table-column table:style-name="Table1.B"/>
<table:table-header-rows>
<table:table-row>
<table:table-cell table:style-name="Table1.A1" office:value-type="string">
<text:p text:style-name="Table_20_Heading">Name</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B1" office:value-type="string">
<text:p text:style-name="Table_20_Heading">Description</text:p>
</table:table-cell>
</table:table-row>
</table:table-header-rows>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">Status</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">A value from the <text:span text:style-name="Source_20_Text">UploadStatus</text:span> enumeration, as follows:<text:line-break/>
<text:span text:style-name="Source_20_Text">Unknown</text:span> - NeatUpload has not yet started receiving the upload<text:line-break/>
<text:span text:style-name="Source_20_Text">NormalInProgress</text:span> - a normal (non-chunked) upload had started but not yet finished<text:line-break/>
<text:span text:style-name="Source_20_Text">ChunkedInProgress</text:span> - an upload which uses chunked transfer coding has started but not yet finished.<text:line-break/>
<text:span text:style-name="Source_20_Text">ProcessingInProgress</text:span> - an upload (if any) has completed and the code associated with the page is running. See <text:a xlink:type="simple" xlink:href="#ShowingProcessingProgress">Showing Processing Progress</text:a> for details.<text:line-break/>
<text:span text:style-name="Source_20_Text">Completed</text:span> - the entire upload wasÂ successfully received and processed<text:line-break/>
<text:span text:style-name="Source_20_Text">Cancelled</text:span> - the user has cancelled the upload using the cancel link<text:line-break/>
<text:span text:style-name="Source_20_Text">Rejected</text:span> - the upload has been rejected by the server because it is unacceptable for some reason<text:line-break/>
<text:span text:style-name="Source_20_Text">Failed</text:span> - an unexpected error occurred while receiving the upload<text:line-break/>
<text:line-break/>If the <text:span text:style-name="Source_20_Text">WhenStatus</text:span> property of a <text:span text:style-name="Source_20_Text">DetailsSpan</text:span> and <text:span text:style-name="Source_20_Text">DetailsDiv</text:span> control is set, the control will only render when the status is one of the space-separated list of statuses in the <text:span text:style-name="Source_20_Text">WhenStatus</text:span> value. Â If the <text:span text:style-name="Source_20_Text">WhenStatus</text:span> property is not set, the control will always display.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">BytesRead</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">Number of bytes received by the server so far. Â Pass this to <text:span text:style-name="Source_20_Text">FormatCount()</text:span> to get a more readable value.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">BytesTotal</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">Total number of bytes in the upload. Â Pass this to <text:span text:style-name="Source_20_Text">FormatCount()</text:span> to get a more readable value. Â For chunked uploads, <text:span text:style-name="Source_20_Text">BytesTotal</text:span> is -1.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">CountUnits</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">The units associated with the result of a call to <text:span text:style-name="Source_20_Text">FormatCount()</text:span>. Â Â IfÂ <text:span text:style-name="Source_20_Text">BytesTotal</text:span> is greater that 1 million, returns the value of the <text:span text:style-name="Source_20_Text">MBUnits</text:span> resource. Â Otherwise, ifÂ <text:span text:style-name="Source_20_Text">BytesTotal</text:span> is greater than 1 thousand,Â returns the value of the <text:span text:style-name="Source_20_Text">KBUnits</text:span> resource. Â Otherwise, returns the value of the <text:span text:style-name="Source_20_Text">ByteUnits</text:span> resource. Â Note: for chunked uploads, <text:span text:style-name="Source_20_Text">BytesRead</text:span> is used instead of <text:span text:style-name="Source_20_Text">BytesTotal</text:span>.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">FormatCount(long count)</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">Converts a number of bytes to units that would make <text:span text:style-name="Source_20_Text">BytesTotal</text:span> readable. Â If <text:span text:style-name="Source_20_Text">BytesTotal</text:span> is greater that 1 million,Â <text:span text:style-name="Source_20_Text">count</text:span> is formatted according to the <text:span text:style-name="Source_20_Text">MBCountFormat</text:span> resource. Â Otherwise, ifÂ <text:span text:style-name="Source_20_Text">BytesTotal</text:span> greater than 1 thousand,Â <text:span text:style-name="Source_20_Text">count</text:span> is formatted according to the <text:span text:style-name="Source_20_Text">KBCountFormat</text:span> resource. Â Otherwise, <text:span text:style-name="Source_20_Text">count</text:span> is formatted according of the <text:span text:style-name="Source_20_Text">ByteCountFormat</text:span> resource. Â Note: for chunked uploads, <text:span text:style-name="Source_20_Text">BytesRead</text:span> is used instead of <text:span text:style-name="Source_20_Text">BytesTotal</text:span>.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">BytesPerSec</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">Rate (in bytes/sec) at which the server has received the upload. Â  While the upload is in progress, this is an average over the past 1-2 seconds. Â When the upload has finished, this is an average over the entire upload.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">FormatRate(int rate)</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">Converts a rate to more readable units. Â If <text:span text:style-name="Source_20_Text">rate</text:span> is greater than 1 million, it is formatted according to the <text:span text:style-name="Source_20_Text">MBRateFormat</text:span> resource. Â Otherwise, ifÂ <text:span text:style-name="Source_20_Text">rate</text:span> is greater than 1 thousand, it is formatted according to the <text:span text:style-name="Source_20_Text">KBRateFormat</text:span> resource. Â Otherwise,Â <text:span text:style-name="Source_20_Text">rate</text:span> is formatted according of the <text:span text:style-name="Source_20_Text">ByteRateFormat</text:span> resource.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">FractionComplete</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">A double in the range 0.0-1.0. Â Computed as <text:span text:style-name="Source_20_Text">BytesRead</text:span>/<text:span text:style-name="Source_20_Text">BytesTotal</text:span> for normal (ie non-chunked) uploads. Â Always 0.0 for chunked uploads.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">TimeElapsed</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">TimeSpan</text:span> representing the time that has elapsed since the upload began.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">TimeRemaining</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">TimeSpan</text:span> estimating the time left until the upload completes. Â This is projected based on the elapsed time and the fraction complete. Â Returns <text:span text:style-name="Source_20_Text">TimeSpan</text:span>.<text:span text:style-name="Source_20_Text">MaxValue</text:span> if <text:span text:style-name="Source_20_Text">BytesRead</text:span> is 0 or if this is a chunked upload. </text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">FormatTimeSpan(TimeSpan</text:span> ts<text:span text:style-name="Source_20_Text">)</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">Formats a <text:span text:style-name="Source_20_Text">TimeSpan</text:span> for readability using the following code:</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="3"/>string format;<text:line-break/>
<text:s text:c="2"/>if (ts.TotalSeconds &lt; 60)<text:line-break/>
<text:s text:c="3"/>format = GetResourceString("SecondsFormat");<text:line-break/>
<text:s text:c="2"/>else if (ts.TotalSeconds &lt; 60*60)<text:line-break/>
<text:s text:c="3"/>format = GetResourceString("MinutesFormat");<text:line-break/>
<text:s text:c="2"/>else<text:line-break/>
<text:s text:c="3"/>format = GetResourceString("HoursFormat");<text:line-break/>
<text:s text:c="2"/>return String.Format(format,<text:line-break/>
<text:s text:c="23"/>(int)Math.Floor(ts.TotalHours),<text:line-break/>
<text:s text:c="23"/>(int)Math.Floor(ts.TotalMinutes),<text:line-break/>
<text:s text:c="23"/>ts.Seconds,<text:line-break/>
<text:s text:c="23"/>ts.TotalHours,<text:line-break/>
<text:s text:c="23"/>ts.TotalMinutes);</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">Rejection</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">An <text:span text:style-name="Source_20_Text">UploadException</text:span> (eg <text:span text:style-name="Source_20_Text">UploadTooLargeException</text:span>) when <text:span text:style-name="Source_20_Text">Status</text:span> is <text:span text:style-name="Source_20_Text">Rejected</text:span>. Â Otherwise, <text:span text:style-name="Source_20_Text">null</text:span>. Â It can be useful to display <text:span text:style-name="Source_20_Text">Rejection.Message</text:span> to the user when a rejection occurs. Â NeatUpload throws an <text:span text:style-name="Source_20_Text">UploadTooLargeException</text:span> if the total request size is more than the size specified with the <text:span text:style-name="Source_20_Text">maxRequestLength</text:span> attribute of the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element. Â The value of the <text:span text:style-name="Source_20_Text">UploadTooLargeException</text:span>'s <text:span text:style-name="Source_20_Text">Message</text:span> property is based on the <text:span text:style-name="Source_20_Text">UploadTooLargeMessageFormat</text:span> resource in <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Variable">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/src/Brettle.Web.NeatUpload/NeatUpload.Strings.resx</text:span>. Â NeatUpload throws an <text:span text:style-name="Source_20_Text">NonfilePortionTooLargeException</text:span> if the non-file portion of an upload request is more than the size specified with the <text:span text:style-name="Source_20_Text">maxNormalRequestLength</text:span> attribute of the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element. Â The value of the <text:span text:style-name="Source_20_Text">NonfilePortionTooLargeException</text:span>'s <text:span text:style-name="Source_20_Text">Message</text:span> property is based on the <text:span text:style-name="Source_20_Text">NonfilePortionTooLargeMessageFormat</text:span> resource in <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Variable">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/src/Brettle.Web.NeatUpload/NeatUpload.Strings.resx</text:span>. </text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">Failure</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">AnÂ <text:span text:style-name="Source_20_Text">Exception</text:span>Â  when <text:span text:style-name="Source_20_Text">Status</text:span> is <text:span text:style-name="Source_20_Text">Failed</text:span>. Â Otherwise, <text:span text:style-name="Source_20_Text">null</text:span>. Â It can be useful to display <text:span text:style-name="Source_20_Text">Failure.Message</text:span> to the user when a failure occurs.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">CurrentFileName</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">The client-specified name of the file currently being received by the server. Â </text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">CancelVisible</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">Whether the 'cancel' link should be visible. Â This is only 'true' when an upload is in progress and NeatUpload can use JavaScript to cancel an upload.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">StartRefreshVisible</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">Whether the 'start refresh' link should be visible. Â This is only 'true' when the progress display is not refreshing and NeatUpload can't use JavaScript to automatically start refreshing it when the upload starts. Â </text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">StopRefreshVisible</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">Whether the 'stop refresh' link should be visible. Â This is only 'true' when the upload is in progress, the progress display is refreshing, and NeatUpload can't use Javascript to cancel the upload.</text:p>
</table:table-cell>
</table:table-row>
<table:table-row>
<table:table-cell table:style-name="Table1.A2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">
<text:span text:style-name="Source_20_Text">CancelUrl, StartRefreshUrl.Â StopRefreshUrl</text:span>
</text:p>
</table:table-cell>
<table:table-cell table:style-name="Table1.B2" office:value-type="string">
<text:p text:style-name="Table_20_Contents">The URLs for the 'cancel', 'start refresh', and 'stop refresh' links, respectively.</text:p>
</table:table-cell>
</table:table-row>
</table:table>
<text:p text:style-name="Text_20_body">
<text:line-break/>By default, <text:span text:style-name="Source_20_Text">ProgressPage</text:span> calls it's <text:span text:style-name="Source_20_Text">GetResourceString()</text:span> method to retrieve all of it's resources. Â The default implementation uses the embedded resources compiled from <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Variable">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/src/Brettle.Web.NeatUpload/NeatUpload.Strings.resx</text:span>. Â If you want to use a different source, override <text:span text:style-name="Source_20_Text">GetResourceString()</text:span> in your subclass. </text:p>
<text:p text:style-name="Text_20_body">For AJAX refreshless updates to work, your <text:span text:style-name="Source_20_Text">ProgressPage</text:span> subclass must render as a well-formed XML document. Â Here are a few tips to avoid the most common problems:</text:p>
<text:list text:style-name="L14">
<text:list-item>
<text:p text:style-name="P118">Use all lowercase for HTML element names (ie '<text:span text:style-name="Source_20_Text">&lt;body&gt;</text:span>' instead of '<text:span text:style-name="Source_20_Text">&lt;BODY&gt;</text:span>' or '<text:span text:style-name="Source_20_Text">&lt;Body&gt;</text:span>'). </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P118">If your page contains HTML-specific entities replace them with their numeric equivalents. Â For example, replace '<text:span text:style-name="Source_20_Text">&amp;nbsp;</text:span>' with '<text:span text:style-name="Source_20_Text">&amp;#160;</text:span>'. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P55">Use <text:span text:style-name="Source_20_Text">&lt;asp:HyperLink&gt;</text:span> instead of <text:span text:style-name="Source_20_Text">&lt;a&gt;</text:span> for links, especially for links that use <text:span text:style-name="Source_20_Text">CancelUrl</text:span>, <text:span text:style-name="Source_20_Text">StartRefreshUrl</text:span>, and <text:span text:style-name="Source_20_Text">StopRefreshUrl</text:span>. Â SomeÂ <text:span text:style-name="Source_20_Text">HtmlAnchor</text:span>Â (i.e. <text:span text:style-name="Source_20_Text">&lt;a&gt;</text:span>) implementations, notably Microsoft's ASP.NET 2.0, do not HTML encode the value of the <text:span text:style-name="Source_20_Text">href</text:span> attribute. Â If the URLs contain ampersands, the XML will not be considered well-formed unless they are encoded. </text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">One final note: By default,Â <text:span text:style-name="Source_20_Text">DetailsDiv</text:span> and <text:span text:style-name="Source_20_Text">DetailsSpan</text:span> controls (like regular <text:span text:style-name="Source_20_Text">div</text:span> and <text:span text:style-name="Source_20_Text">span</text:span> controls) will not render as simple <text:span text:style-name="Source_20_Text">&lt;div&gt;</text:span> and <text:span text:style-name="Source_20_Text">&lt;span&gt;</text:span> elements in browsers that ASP.NET considers "downlevel". Â Instead, <text:span text:style-name="Source_20_Text">div</text:span> controls are rendered as tables and <text:span text:style-name="Source_20_Text">span</text:span> controls may render with extra font tags, etc. Â The <text:span text:style-name="Source_20_Text">Machine.config</text:span> shipped with ASP.NET 1.1 contains a <text:a xlink:type="simple" xlink:href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpgenref/html/gngrfbrowsercapssection.asp">
<text:span text:style-name="Source_20_Text">&lt;browserCaps&gt;</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpgenref/html/gngrfbrowsercapssection.asp"/>section that causes all non-IE browsers to be considered downlevel, including Netscape, Firefox, Opera, Safari, etc. Â To force the <text:span text:style-name="Source_20_Text">DetailsDiv</text:span> and <text:span text:style-name="Source_20_Text">DetailsSpan</text:span> controls to render as simple <text:span text:style-name="Source_20_Text">&lt;div&gt;</text:span> and <text:span text:style-name="Source_20_Text">&lt;span&gt;</text:span> elements even in supposedly downlevel browsers, set the control's <text:span text:style-name="Source_20_Text">UseHtml4</text:span> property to "true". Â The default <text:span text:style-name="Source_20_Text">Progress.aspx</text:span> does that for the <text:span text:style-name="Source_20_Text">DetailsDiv</text:span> control with an id of "barDetailsDiv" that is used to draw the gray progress bar. Â Note that even with the <text:span text:style-name="Source_20_Text">UseHtml4</text:span> property it is still a good idea to <text:a xlink:type="simple" xlink:href="http://slingfive.com/pages/code/browserCaps/">update or supplement the default ASP.NET 1.1 </text:a>
<text:a xlink:type="simple" xlink:href="http://slingfive.com/pages/code/browserCaps/">
<text:span text:style-name="Source_20_Text">&lt;browserCaps&gt;</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="http://slingfive.com/pages/code/browserCaps/"/>
<text:a xlink:type="simple" xlink:href="http://slingfive.com/pages/code/browserCaps/">section</text:a> to make the rest of your web application render more cleanly in modern non-IE browsers. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId184279"/>Creating Custom Fallback Content for <text:span text:style-name="Source_20_Text">ProgressBar</text:span>
</text:h>
<text:p text:style-name="Text_20_body">If JavaScript is not available or the browser doesn't support IFRAMEs and the <text:span text:style-name="Source_20_Text">ProgressBar</text:span> element is empty, a "Check Upload Progress" link will be displayed. To change the text of that link, simply place the desired text (or controls) between the begin and end tags of the <text:span text:style-name="Source_20_Text">ProgressBar</text:span> element. For example: </text:p>
<text:p text:style-name="P4">&lt;Upload:ProgressBar id="progressBar" runat="server" &gt;<text:line-break/> &lt;asp:Label id="label" runat="server" Text="Your Text Here"/&gt;<text:line-break/>&lt;/Upload:ProgressBar&gt;</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Advanced Progress Bar Customization</text:h>
<text:p text:style-name="Text_20_body">NeatUpload's <text:span text:style-name="Source_20_Text">ProgressBar</text:span> (and the <text:span text:style-name="Source_20_Text">GreyBoxProgressBar</text:span> extension) are both subclasses of NeatUpload's abstract <text:span text:style-name="Source_20_Text">ProgressBarBase</text:span> class. <text:s/>
<text:span text:style-name="Source_20_Text">ProgressBarBase</text:span> provides all of the functionality of the progress bar including detecting postbacks initiated by registered triggers, displaying the progress bar in a pop-up window, and displaying fallback content when scripting is not available. <text:s/>The <text:span text:style-name="Source_20_Text">ProgressBar</text:span> control adds an <text:span text:style-name="Source_20_Text">Inline</text:span> property that displays the progress bar inline using an IFRAME if the browser supports it. <text:s/>
<text:span text:style-name="Source_20_Text">GreyBoxProgressBar</text:span> displays the popup using GreyBox instead of <text:span text:style-name="Source_20_Text">window.open()</text:span>. <text:s/>You can create your own subclass of <text:span text:style-name="Source_20_Text">ProgressBarBase</text:span> to change the way that the progress bar is displayed. <text:s/>Refer to the source code of <text:span text:style-name="Source_20_Text">GreyBoxProgressBar</text:span> for an example of how to do that. <text:s/>The key is to override <text:span text:style-name="Source_20_Text">GetStartupScript()</text:span> to return the base startup script followed by your own script. <text:s/>The base startup script will create the <text:span text:style-name="Source_20_Text">NeatUploadPB</text:span> script object associated with your control. <text:s/>You can access the created object using <text:span text:style-name="Source_20_Text">NeatUploadPB.prototype.Bars['</text:span>
<text:span text:style-name="Emphasis">progressBarID</text:span>
<text:span text:style-name="Source_20_Text">'] </text:span>where <text:span text:style-name="Emphasis">progressBarID</text:span> is the <text:span text:style-name="Source_20_Text">ClientID</text:span> property of your control. <text:s/>Once you have that object, you can modify it's behavior by replacing any of the following:</text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">Display()</text:span> - NeatUpload calls <text:span text:style-name="Source_20_Text">Display()</text:span> with no parameters when the progress bar should be displayed. <text:s/>The default implementation calls <text:span text:style-name="Source_20_Text">DisplayUrl(progressUrl)</text:span> which is described below. <text:s/>You might want to override the <text:span text:style-name="Source_20_Text">Display()</text:span> method to show a hidden progress bar before calling <text:span text:style-name="Source_20_Text">DisplayUrl()</text:span>.</text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">DisplayUrl(progressUrl)</text:span> â€“ The default implementation of <text:span text:style-name="Source_20_Text">Display()</text:span> calls <text:span text:style-name="Source_20_Text">DisplayUrl(progressUrl)</text:span> to start the progress display. <text:s text:c="2"/>The <text:span text:style-name="Source_20_Text">progressUrl</text:span> parameter is the URL of the progress page (e.g. Progress.aspx) with the required query string. <text:s/>The default <text:span text:style-name="Source_20_Text">DisplayUrl()</text:span> passes <text:span text:style-name="Source_20_Text">progressUrl</text:span> to <text:span text:style-name="Source_20_Text">window.open()</text:span> to start the progress display in a popup window. <text:s/>You might want to override <text:span text:style-name="Source_20_Text">DisplayUrl()</text:span> to display the progress information in some other way.</text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Source_20_Text">EvalOnClose</text:span> - NeatUpload passes the <text:span text:style-name="Source_20_Text">EvalOnClose</text:span> string to JavaScript's eval function in the window or frame that displays the progress page (e.g. Progress.aspx) when the upload completes successfully or has been cancelled by the user. <text:s/>It does not eval the string if an error occurs because any error message displayed in progress bar should normally remain visible until the user acknowledges it. <text:s/>You might set <text:span text:style-name="Source_20_Text">EvalOnClose</text:span> to some code that hides the progress bar that you display in <text:span text:style-name="Source_20_Text">DisplayUrl()</text:span>. <text:s/>The value you specify for <text:span text:style-name="Source_20_Text">EvalOnClose</text:span> must be a string instead of function object because the browser runs the code in the window/frame where the progress page is displayed, not the window/frame that started the progress display. <text:s/>You can access the window object that started the display using the <text:span text:style-name="Source_20_Text">NeatUploadMainWindow</text:span> variable. <text:s/>
</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Customizing the MultiFile Button</text:h>
<text:p text:style-name="Text_20_body">By default, the <text:span text:style-name="Source_20_Text">MultiFile</text:span> control renders as a â€œPick Files...â€ button that displays a file selection dialog when clicked. <text:s/>You can replace that button with a different button, a link, or any other HTML you want by putting the desired content inside the <text:span text:style-name="Source_20_Text">MultiFile</text:span> element on your page. <text:s/>Note that whatever content you place in the <text:span text:style-name="Source_20_Text">MultiFile</text:span> element is for display purposes only. <text:s/>The user won't actually interact with any of that content. <text:s/>If the user attempts to click anywhere on your content, the file selection dialog will be displayed. <text:s/>For example, the following:</text:p>
<text:p text:style-name="Preformatted_20_Text">&lt;Upload:MultiFile runat=â€serverâ€&gt;<text:line-break/> &lt;a href=â€<text:a xlink:type="simple" xlink:href="http://www.google.com/">http://www.</text:a>brettle.com/neatuploadâ€&gt;Select Files...&lt;/a&gt;<text:line-break/>&lt;/Upload:MultiFile&gt;</text:p>
<text:p text:style-name="Text_20_body">will display a â€œSelect Files...â€ link instead of the â€œPick Files...â€ button, but clicking on the link will display the file selection dialog instead of loading the NeatUpload home page.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Customizing MultiFile's Handling of Queued Files</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload's <text:span text:style-name="Source_20_Text">MultiFile</text:span> displays queued files (i.e. files that have been selected but not yet uploaded) as a vertical list above the â€œPick Files...â€ button, with each name preceded by an â€œXâ€ which the user can click to delete the file. <text:s/>To display the list someplace else, simply set MultiFile's <text:span text:style-name="Source_20_Text">FileQueueControlID</text:span> property to the ID of the element (e.g. a &lt;div&gt;) that should contain the list. <text:s/>To display the list in some other format, replace the <text:span text:style-name="Source_20_Text">OnFileQueued()</text:span> method of the <text:span text:style-name="Source_20_Text">NeatUploadMultiFile</text:span> script object that NeatUpload creates for your control. <text:s/>You can access that object using <text:span text:style-name="Source_20_Text">NeatUploadMultiFile.prototype.Controls['multiFileID'] </text:span>where <text:span text:style-name="Emphasis">multiFileID</text:span> is the <text:span text:style-name="Source_20_Text">ClientID</text:span> property of your control. <text:s/>The <text:span text:style-name="Source_20_Text">OnFileQueued()</text:span> method takes one argument: a file object that contains a <text:span text:style-name="Source_20_Text">name</text:span> property which your <text:span text:style-name="Source_20_Text">OnFileQueued()</text:span> method should display and a <text:span text:style-name="Source_20_Text">Delete()</text:span> method which your <text:span text:style-name="Source_20_Text">OnFileQueued()</text:span> method should arrange to call when the user deletes the file from the queue. <text:s/>For an example, see the default implementation of <text:span text:style-name="Source_20_Text">OnFileQueued()</text:span> in <text:span text:style-name="Source_20_Text">NeatUpload-</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/js/NeatUpload.js</text:span>.</text:p>
<text:p text:style-name="Text_20_body">The file object passed to <text:span text:style-name="Source_20_Text">OnFileQueued()</text:span> also has a size property. <text:s/>If the file was selected using flash, that property will contain the size of the file in bytes. <text:s/>Otherwise, it will contain -1. <text:s/>You could use that property to warn the user and immediately call <text:span text:style-name="Source_20_Text">Delete()</text:span> for any files which are larger than you want.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Creating a Custom UploadStorageProvider</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload uses the built-in <text:span text:style-name="Source_20_Text">FilesystemUploadStorageProvider</text:span> which streams uploaded files to a temporary directory until you move them. Â If you would rather stream uploaded files to some other location (e.g. a database, or remote machine), or you want some other functionality not provided byÂ <text:span text:style-name="Source_20_Text">FilesystemUploadStorageProvider,</text:span> you need to create and use a custom <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span>. Â To create a custom <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span>, create a class which inherits from <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span>. Â You will need to implement the following methods:</text:p>
<text:p text:style-name="Preformatted_20_Text">public abstract void Initialize(string name, NameValueCollection attrs);<text:line-break/>public virtual UploadedFile CreateUploadedFile(UploadContext ctx, <text:line-break/>
<text:s text:c="46"/>string controlUniqueID, <text:line-break/>
<text:s text:c="46"/>string fileName,<text:line-break/>
<text:s text:c="46"/>string contentType,<text:line-break/>
<text:s text:c="46"/>UploadStorageConfig storageConfig);</text:p>
<text:p text:style-name="Text_20_body">When the configuration section where your provider is added is first relevant to a request, NeatUpload creates an instance of your provider and calls it's <text:span text:style-name="Source_20_Text">Initialize()</text:span> method, Â passing the value of the "name" attribute as the first parameter and the remaining attributes (other than "name", and "type") as the second parameter. Â You can use the remaining attributes to pass provider-specific configuration information to your provider.<text:line-break/>
<text:line-break/>Whenever NeatUpload encounters a file upload associated with a <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> control, it calls the second <text:span text:style-name="Source_20_Text">CreateUploadedFile()</text:span> method of the provider that is configured as the <text:span text:style-name="Source_20_Text">defaultProvider</text:span> for the requested page. Â When NeatUpload calls your provider's <text:span text:style-name="Source_20_Text">CreateUploadedFile()</text:span> method, it passes the <text:span text:style-name="Source_20_Text">UploadContext</text:span> associated with the current request, the ID of the <text:span text:style-name="Source_20_Text">MultiFile</text:span> or <text:span text:style-name="Source_20_Text">InputFile</text:span> control associated with the upload, the browser-specified name and MIME type of the file, and the value of the control's <text:span text:style-name="Source_20_Text">StorageConfig</text:span> property. Â <text:span text:style-name="Source_20_Text">CreateUploadedFile()</text:span> is responsible for returning an instance of a class derived from <text:span text:style-name="Source_20_Text">UploadedFile</text:span>. Â NeatUpload will stream the file to that object. <text:s/>Various <text:span text:style-name="Source_20_Text">InputFile</text:span> members delegate to the associated methods of your <text:span text:style-name="Source_20_Text">UploadedFile</text:span>-derived object. <text:s/>The <text:span text:style-name="Source_20_Text">MultiFile</text:span> control has a <text:span text:style-name="Source_20_Text">Files</text:span> property that returns an array of your <text:span text:style-name="Source_20_Text">UploadedFile</text:span>-derived objects directly.<text:line-break/>
<text:line-break/>Your provider's <text:span text:style-name="Source_20_Text">CreateUploadedFile()</text:span> can optionally use the <text:span text:style-name="Source_20_Text">ContentLength</text:span> property of the passed <text:span text:style-name="Source_20_Text">UploadContext</text:span> to get the length of the entire request, including all files. Â That information could be used to reserve sufficient space to store the files, for example. Â At the moment, no members of <text:span text:style-name="Source_20_Text">UploadContext</text:span> other than <text:span text:style-name="Source_20_Text">ContentLength</text:span> are available to providers. Â Future releases of NeatUpload might use UploadContext to pass other similar information to providers.<text:line-break/>
<text:line-break/>Your provider can "reject" an upload at any time (eg based on MIME type, size, or content), by throwing an exception derived from <text:span text:style-name="Source_20_Text">UploadException</text:span>. Â When NeatUpload detects such an exception, it:</text:p>
<text:list text:style-name="L15">
<text:list-item>
<text:p text:style-name="P120">updates the progress bar to indicate that the upload was rejected (i.e. sets <text:span text:style-name="Source_20_Text">Status</text:span> to <text:span text:style-name="Source_20_Text">Rejected</text:span> and <text:span text:style-name="Source_20_Text">Rejection</text:span> to the <text:span text:style-name="Source_20_Text">UploadException</text:span> that occured) </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P120">if the progress bar is in a pop-up window, leaves the pop-up open so that the user can see the message </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P120">asks the browser to stop the upload using javascript to simulate clicking the browser's Stop button </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P120">waits 5 seconds to give the browser and opportunity to stop the upload </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P56">rethrows the exception </text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">NeatUpload has no way of knowing for sure whether the browser stopped the upload, so it always rethrows the exception. Â If the browser did stop the upload, it will ignore any response that the application generates because of the error. Â If the browser didn't stop the upload, it will display the response that the application generates. Â You can customize that response by handling the <text:span text:style-name="Source_20_Text">Application.Error</text:span> event or by using custom error pages. NeatUpload responds to Â <text:span text:style-name="Source_20_Text">UploadException</text:span>s by throwing an <text:span text:style-name="Source_20_Text">HttpException</text:span> with the same HTTP error code and the <text:span text:style-name="Source_20_Text">UploadException</text:span> as the <text:span text:style-name="Source_20_Text">InnerException</text:span>. This allows you to control which custom error page is used by specifying the corresponding HTTP error code when you construct your <text:span text:style-name="Source_20_Text">UploadException</text:span>.<text:line-break/>
<text:line-break/>When NeatUpload detects an exception that is <text:span text:style-name="T3">not</text:span> derived from <text:span text:style-name="Source_20_Text">UploadException</text:span>, it assumes that it is an unexpected error, so it:</text:p>
<text:list text:style-name="L16">
<text:list-item>
<text:p text:style-name="P124">updates the progress bar to indicate that an error occurredÂ (i.e. sets <text:span text:style-name="Source_20_Text">Status</text:span> to <text:span text:style-name="Source_20_Text">Failed</text:span> and <text:span text:style-name="Source_20_Text">Failure</text:span> to theÂ <text:span text:style-name="Source_20_Text">Exception</text:span> that occured) </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P124">if the progress bar is in a pop-up window, leaves the pop-up open so that the user can see the message </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P57">rethrows the exception </text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">ASP.NET will handled the exception the same way any other exception is handled. Â It will fire the <text:span text:style-name="Source_20_Text">Application.Error</text:span> event and use custom error pages if they are configured.<text:line-break/>
<text:line-break/>If the <text:span text:style-name="Source_20_Text">NameValueCollection</text:span> provided by <text:span text:style-name="Source_20_Text">UploadStorageConfig</text:span> is not sufficient for your provider, you can override <text:span text:style-name="Source_20_Text">UploadStorageProvider.CreateUploadStorageConfig()</text:span> to return your own <text:span text:style-name="Source_20_Text">UploadStorageConfig</text:span> subclass. Â Your subclass can override the <text:span text:style-name="Source_20_Text">UploadStorageConfig.Serialize(Stream)</text:span> and <text:span text:style-name="Source_20_Text">UploadStorageConfig.Deserialize(Stream)</text:span> methods to serialize itself to the provided <text:span text:style-name="Source_20_Text">Stream</text:span> and deserialize itself from the provided <text:span text:style-name="Source_20_Text">Stream</text:span>. Â The base class implementations of these methods use <text:a xlink:type="simple" xlink:href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemWebUILosFormatterClassTopic.asp">
<text:span text:style-name="Source_20_Text">LosFormatter</text:span>
</text:a>
<text:a xlink:type="simple" xlink:href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemWebUILosFormatterClassTopic.asp"/>to provide a concise serialization of the <text:span text:style-name="Source_20_Text">NameValueCollection</text:span> as a <text:span text:style-name="Source_20_Text">Hashtable</text:span>.<text:line-break/>
<text:line-break/>For an example of how to implement a custom <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span>, see <text:span text:style-name="Source_20_Text">FilesystemUploadStorageProvider.cs</text:span> and <text:span text:style-name="Source_20_Text">FilesystemUploadedFile.cs</text:span>. Â  For another example, see the files in the <text:span text:style-name="Source_20_Text">HashedInputFile</text:span> directory.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Creating a Custom UploadStateStoreProvider</text:h>
<text:p text:style-name="Text_20_body">By default, NeatUpload uses the built-in <text:span text:style-name="Source_20_Text">AdaptiveUploadStateStoreProvider</text:span> which maintains the state of uploads in application state if the session state mode is Off or InProc, and otherwise maintains state in the user's session so that it can be shared across a web garden or web farm. <text:s/>You can force NeatUpload to maintain upload state in application state or the user's session by configuring NeatUpload to use the <text:span text:style-name="Source_20_Text">InProcUploadStateStoreProvider</text:span> or <text:span text:style-name="Source_20_Text">SessionBasedUploadStateStoreProvider</text:span>, respectively. <text:s/>
</text:p>
<text:p text:style-name="Text_20_body">In addition, you can create your own <text:span text:style-name="Source_20_Text">UploadStateStoreProvider</text:span> subclass which maintains upload state differently. <text:s/>You will need to implement the following methods:</text:p>
<text:p text:style-name="Preformatted_20_Text">public abstract void Initialize(string name, NameValueCollection attrs);<text:line-break/>public abstract UploadState Load(string postBackID); </text:p>
<text:p text:style-name="Preformatted_20_Text">public abstract void MergeAndSave(UploadState uploadState); </text:p>
<text:p text:style-name="Preformatted_20_Text">protected virtual void Delete(string postBackID); </text:p>
<text:list text:style-name="L17">
<text:list-header>
<text:p text:style-name="P153">When the configuration section where your provider is added is first relevant to a request, NeatUpload creates an instance of your provider and calls it's <text:span text:style-name="Source_20_Text">Initialize()</text:span> method, Â passing the value of the "name" attribute as the first parameter and the remaining attributes (other than "name", and "type") as the second parameter. Â You can use the remaining attributes to pass provider-specific configuration information to your provider. <text:s/>
</text:p>
</text:list-header>
<text:list-item>
<text:p text:style-name="P153">When NeatUpload needs the <text:span text:style-name="Source_20_Text">UploadState</text:span> object associated with a particular post-back ID, it will call the <text:span text:style-name="Source_20_Text">Load()</text:span> method which must return either the <text:span text:style-name="Source_20_Text">UploadState</text:span> object, or null if the post-back ID is not known. <text:s/>
</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P153">When NeatUpload needs to update the <text:span text:style-name="Source_20_Text">UploadState</text:span>, it will call the <text:span text:style-name="Source_20_Text">MergeAndSave()</text:span> method. <text:s/>That method must atomically merge the passed <text:span text:style-name="Source_20_Text">UploadState</text:span> object with the stored <text:span text:style-name="Source_20_Text">UploadState</text:span> object and replace the stored <text:span text:style-name="Source_20_Text">UploadState</text:span> object with the merged result. <text:s/>The static <text:span text:style-name="Source_20_Text">UploadStateStoreProvider.Merge()</text:span> helper method can do the actual merging once your provider has both <text:span text:style-name="Source_20_Text">UploadState</text:span> objects. <text:s/>
</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P153">When NeatUpload determines that an <text:span text:style-name="Source_20_Text">UploadState</text:span> object is stale, it will call the <text:span text:style-name="Source_20_Text">Delete()</text:span> method which must delete the <text:span text:style-name="Source_20_Text">UploadState</text:span> object from the state store. <text:s/>
<text:span text:style-name="Source_20_Text">Delete()</text:span> is called from the protected <text:span text:style-name="Source_20_Text">CleanUpIfStale()</text:span> method. <text:s/>
<text:span text:style-name="Source_20_Text">CleanUpIfStale()</text:span> calls <text:span text:style-name="Source_20_Text">Load()</text:span> to retrieve the <text:span text:style-name="Source_20_Text">UploadState</text:span> object from the store, and then calls <text:span text:style-name="Source_20_Text">Delete()</text:span> if it is stale. <text:s/>By default, the <text:span text:style-name="Source_20_Text">CleanUpIfStale()</text:span> method runs on a thread which does not have any <text:span text:style-name="Source_20_Text">HttpContext</text:span>. <text:s/>So, if your <text:span text:style-name="Source_20_Text">Load()</text:span> or <text:span text:style-name="Source_20_Text">Delete()</text:span> implementations require an <text:span text:style-name="Source_20_Text">HttpContext</text:span>, you will need to implement:</text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Preformatted_20_Text">public virtual CleanUpIfStaleCallback GetCleanUpIfStaleCallback();</text:p>
<text:list text:style-name="L17">
<text:list-item text:start-value="1">
<text:p text:style-name="P153">to return a method that calls <text:span text:style-name="Source_20_Text">CleanUpIfStale()</text:span> in an a suitable environment. <text:s/>For example, <text:span text:style-name="Source_20_Text">InProcUploadStateStoreProvider.GetCleanUpIfStaleCallback()</text:span> saves a reference to the <text:span text:style-name="Source_20_Text">HttpApplicationState</text:span> object and returns a method that makes it available to the provider (via a <text:span text:style-name="Source_20_Text">ThreadStatic</text:span> field) when the returned method calls <text:span text:style-name="Source_20_Text">CleanUpIfStale()</text:span>.</text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">For an example of how to implement a custom <text:span text:style-name="Source_20_Text">UploadStateStoreProvider</text:span>, see <text:span text:style-name="Source_20_Text">InProcUploadStateProvider.cs</text:span> and <text:span text:style-name="Source_20_Text">SessionBasedUploadStateStoreProvider.cs</text:span>. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Handling Non-absolute Paths in IE6</text:h>
<text:p text:style-name="Text_20_body">If instead of selecting a file to upload via the file selection dialog, an IE6 user types in a non-absolute path (e.g. just "x"), IE6 will not submit the form, no upload will occur, and NeatUpload will not start the progress display. Â Unfortunately, this means that the user gets no feedback to indicate what the problem is. Â If you want to provide feedback, NeatUpload provides a hook for that purpose. Â When NeatUpload detects this situation, it checks to see if a JavaScript function named NeatUpload_HandleIE6InvalidPath() exists. Â  If it exists, NeatUpload calls that function, passing it the input file form element that contains the non-absolute path. Â NeatUpload does not provide an implementation of that function by default, but you can provide your own implementation. Â For example, your implementation might display "Invalid path" next to the input file form element so that the user knows what the problem is. </text:p>
<text:p text:style-name="Text_20_body">Since users almost always use the file selection dialog, this issue almost never arises.</text:p>
<text:h text:style-name="Heading_20_1" text:outline-level="1">
<text:bookmark text:name="SqlServerInputFile"/>Extensions</text:h>
<text:h text:style-name="Heading_20_2" text:outline-level="2">The SqlServerInputFile Extension</text:h>
<text:p text:style-name="Text_20_body">SqlServerInputFile is a NeatUpload extension generously contributed by Joakim Wennergren (jokedst at gmail dot com). It streams uploaded files to and from an SQL Server database and consists of the <text:span text:style-name="Source_20_Text">SqlServerInputFile</text:span> web controlÂ and a custom <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span> called <text:span text:style-name="Source_20_Text">SqlServerUploadStorageProvider</text:span>. </text:p>
<text:h text:style-name="Heading_20_3" text:outline-level="3">
<text:bookmark text:name="SqlServerInputFileInstall"/>Installation</text:h>
<text:p text:style-name="P1">To install <text:span text:style-name="Source_20_Text">SqlServerInputFile</text:span>:</text:p>
<text:p text:style-name="P7">
<text:span text:style-name="T8">If you will be using the Visual Studio Web Form Designer</text:span>, add the <text:span text:style-name="Source_20_Text">SqlServerInputFile</text:span> control to your toolbox. Â To do that, right-click on the Toolbox, click Add/Remove Items, Browse toÂ  <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/bin/Hitone.Web.SqlServerUploader.dll</text:span>, click Open, and then click OK. Â A reference to <text:span text:style-name="Source_20_Text">Hitone.Web.SqlServerUploader.dll</text:span> will automatically be added to your project the first time you use the designer to a SqlServerInputFile to a form.<text:line-break/>
<text:span text:style-name="T8">If you won't be using the Visual Studio Web Form Designer</text:span>, add a reference to your web application that refers to the <text:span text:style-name="Source_20_Text">Hitone.Web.SqlServerUploader.dll</text:span> in the <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/bin/</text:span> directory.</text:p>
<text:h text:style-name="Heading_20_3" text:outline-level="3">
<text:bookmark text:name="SqlServerInputFileConfigure"/>Configuration</text:h>
<text:p text:style-name="Text_20_body">To configure your application to use the <text:span text:style-name="Source_20_Text">SqlServerUploadStorageProvider</text:span>, add the following to your <text:span text:style-name="Source_20_Text">Web.config</text:span>:</text:p>
<text:p text:style-name="Preformatted_20_Text">&lt;configuration&gt;<text:line-break/> &lt;configSections&gt;<text:line-break/>
<text:s/>&lt;section name="neatUpload" type="Brettle.Web.NeatUpload.ConfigSectionHandler, Brettle.Web.NeatUpload" allowLocation="true" /&gt;<text:line-break/> &lt;/configSections&gt;<text:line-break/>
<text:s/>...<text:line-break/> &lt;neatUpload ...<text:line-break/>
<text:s/>defaultStorageProvider="SqlServerUploadStorageProvider"&gt;<text:line-break/>
<text:s/>&lt;providers&gt;<text:line-break/>
<text:s text:c="2"/>&lt;add name="SqlServerUploadStorageProvider" <text:line-break/>
<text:s text:c="3"/>type="<text:span text:style-name="T9">Hitone</text:span>
<text:span text:style-name="T11">.Web.SqlServerUploader.SqlServerUploadStorageProvider, Hitone.Web.SqlServerUploader"<text:line-break/>
</text:span>
<text:s text:c="6"/>connectionString="connection string (required unless using connectionName to identify named connection in ASP.NET 2.0)"<text:line-break/>
<text:s text:c="6"/>options identifying stored procs or table/column names (required)<text:line-break/>
<text:s text:c="6"/>hashAlgorithm="optional name of hash algorithm supported by .NET (e.g. MD5, SHA1, etc), defaults to no hash"/&gt;<text:line-break/>
<text:s/>&lt;/providers&gt;<text:line-break/> &lt;/neatUpload&gt;<text:line-break/> ...<text:line-break/>&lt;/configuration&gt;</text:p>
<text:p text:style-name="Text_20_body">The <text:span text:style-name="Source_20_Text">SqlServerUploadStorageProvider</text:span> can either generate SQL itself or use stored procedures on the database server for all tasks. This is controlled by the attributes you specify when you add the provider to your <text:span text:style-name="Source_20_Text">Web.config</text:span>. When the provider needs to do something, it first checks to see if you have specified a stored procedure to do it using one of the following attributes: </text:p>
<text:list text:style-name="L18">
<text:list-item>
<text:p text:style-name="P126">
<text:span text:style-name="Source_20_Text">createProcedure</text:span> - Procedure that takes @FileName and @MIMEType (both varchars) input parameters, and sets @Identity (Numeric) and @Pointer (Binary(16)) output parameters. The @Identity and @Pointer values that are returned will be passed to the <text:span text:style-name="Source_20_Text">writeProcedure</text:span> as the file is received. The @Identity value will also be passed to the <text:span text:style-name="Source_20_Text">deleteProcedure</text:span>, <text:span text:style-name="Source_20_Text">cleanupProcedure</text:span>, <text:span text:style-name="Source_20_Text">renameProcedure</text:span>, and <text:span text:style-name="Source_20_Text">storeHashProcedure</text:span>. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P126">
<text:span text:style-name="Source_20_Text">writeProcedure</text:span> - Procedure that takes @Identity (Numeric), @Pointer (Binary(16)), @Offset (Int), @Delete (Int), and @Bytes (varbinary) input parameters. It should replace the @Delete bytes at position @Offset in the file identified by @Identity and @Pointer with the bytes in @Bytes. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P126">
<text:span text:style-name="Source_20_Text">cleanupProcedure</text:span> - The provider calls this procedure with @Identity (Numeric) when an upload is no longer in progress and it will not call <text:span text:style-name="Source_20_Text">writeProcedure</text:span> anymore. Note that this procedure is called even if the upload did not complete successfully for some reason. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P126">
<text:span text:style-name="Source_20_Text">storeHashProcedure</text:span> - If the <text:span text:style-name="Source_20_Text">hashAlgorithm</text:span> attribute is set, the provider calls this procedure with @Identity (Numeric) and @Hash (varchar). @Hash is the hash value computed for the file identified by @Identity. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P126">
<text:span text:style-name="Source_20_Text">renameProcedure</text:span> - The provider calls this procedure with @Identity (Numeric) and @FileName (varchar) to indicate that the application has requested that the name of the file identified by @Identity be changed to @FileName. This happens when you call <text:span text:style-name="Emphasis">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.MoveTo()</text:span>. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P126">
<text:span text:style-name="Source_20_Text">deleteProcedure</text:span> - Procedure that takes @Identity (Numeric) input parameter and deletes the specified file. This is called at the end of the request if your application called neither <text:span text:style-name="Emphasis">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.MoveTo() nor </text:span>
<text:span text:style-name="Emphasis">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.Verify()</text:span>
</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P126">
<text:span text:style-name="Source_20_Text">openProcedure</text:span> - This procedure is called if you use <text:span text:style-name="Emphasis">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.FileContent</text:span> to access the uploaded file as a stream. It takes an @Identity (Numeric) input parameter, and sets @Pointer (Binary(16)), @FileName (varchar), and @MIMEType (varchar) output parameters. The @Pointer value that is returned will be passed to the <text:span text:style-name="Source_20_Text">readProcedure</text:span> as content is read from the stream. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P58">
<text:span text:style-name="Source_20_Text">readProcedure</text:span> - This procedure is called if you use <text:span text:style-name="Emphasis">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.FileContent</text:span> to access the uploaded file as a stream. It takes @Identity (Numeric), @Pointer (Binary(16)), @Offset (Int), and @Size (Int) input parameters and returns the @Size bytes starting at position @Offset in the file identified by @Identity and @Pointer. </text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">If you don't provide a stored procedure for what the provider needs to do, it will generate the SQL to do it. When generating SQL queries, the provider uses the values you specify with the following attributes: </text:p>
<text:list text:style-name="L19">
<text:list-item>
<text:p text:style-name="P133">
<text:span text:style-name="Source_20_Text">tableName</text:span> - Name of the table to contain the files. "FileTable" in the example below. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P133">
<text:span text:style-name="Source_20_Text">dataColumnName</text:span> - Name of an image/varbinary column for the contents of the uploaded file. "DataField" in the example below. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P133">
<text:span text:style-name="Source_20_Text">partialFlagColumnName</text:span> - Name of a tinyint column that the provider will set to 1 while the upload is being received and set to 0 when the upload is complete. "Partial" in the example below. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P133">
<text:span text:style-name="Source_20_Text">fileNameColumnName</text:span> - Name of a nvarchar column for the name of the uploaded file. While the upload is being received, the provider will set the column to the name (excluding path provided by the browser). If you call <text:span text:style-name="Emphasis">inputFileId</text:span>.MoveTo(), the new name will be stored in this column. "FileName" in the example below. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P133">
<text:span text:style-name="Source_20_Text">mimeTypeColumnName</text:span> - Name of a nvarchar column for the browser-provided MIME content type of the file "MimeType" in the example below. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P59">
<text:span text:style-name="Source_20_Text">hashColumnName</text:span> - Name of a nvarchar column for the hash of the file contents (as a hex string). "FileHash" in the example below. </text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">To generate SQL queries, the provider only requires <text:span text:style-name="Source_20_Text">tableName</text:span> and <text:span text:style-name="Source_20_Text">dataColumnName</text:span>. The remaining attributes are optional. </text:p>
<text:p text:style-name="Text_20_body">
<text:span text:style-name="Strong_20_Emphasis">Note: The generated SQL will not work with SQL Server 2000</text:span> because it requires the "$IDENTITY" object to reference the IDENTITY column of the table. An <text:span text:style-name="Source_20_Text">identityColumnName</text:span> attribute might be added in a future release. Until then, SQL Server 2000 users will need to use stored procedures to workaround around this limitation. </text:p>
<text:h text:style-name="Heading_20_3" text:outline-level="3">
<text:bookmark text:name="SqlServerInputFileUse"/>Usage</text:h>
<text:p text:style-name="Text_20_body">To add the <text:span text:style-name="Source_20_Text">SqlServerInputFile</text:span> to your forms:</text:p>
<text:list text:style-name="L20">
<text:list-item>
<text:p text:style-name="P60">
<text:span text:style-name="T8">If you are using Visual Studio Web Form Designer</text:span>, simply drag the <text:span text:style-name="Source_20_Text">SqlServerInputFile</text:span> control from your Toolbox and drop it on the form.<text:line-break/>
<text:span text:style-name="T8">If you are not using Visual Studio Web Form Designer</text:span>, add the following line at the top of your form:</text:p>
<text:p text:style-name="P202">&lt;%@ Register TagPrefix="SqlUpload" Namespace="Hitone.Web.SqlServerUploader" Assembly="Hitone.Web.SqlServerUploader"%&gt;</text:p>
<text:p text:style-name="P60">and add anÂ <text:span text:style-name="Source_20_Text">SqlServerInputFile</text:span> control to your aspx page wherever you want the user to choose a file, using something like this: </text:p>
<text:p text:style-name="P198">&lt;SqlUpload:SqlServerInputFile id="<text:span text:style-name="Variable">inputFileId</text:span>" runat="server" /&gt;</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P138">Set any properties that you would normally set on an <text:span text:style-name="Source_20_Text">InputFile or HtmlInputFile</text:span> control. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P60">In your code-behind class, you can use the methods properties you would normally use on an <text:span text:style-name="Source_20_Text">InputFile</text:span> object. In addition, <text:span text:style-name="Source_20_Text">SqlServerInputFile</text:span> offers a <text:span text:style-name="Source_20_Text">Verify()</text:span> method that tells the <text:span text:style-name="Source_20_Text">SqlServerUploadStorageProvider</text:span> not to delete the uploaded file at the end of the request. <text:span text:style-name="Source_20_Text">Verify()</text:span> is equivalent to calling <text:span text:style-name="Emphasis">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.MoveTo(</text:span>
<text:span text:style-name="Emphasis">inputFileId</text:span>
<text:span text:style-name="Source_20_Text">.FileName, MoveToOptions.Overwrite)</text:span> but doesn't cause the extra database update. <text:span text:style-name="Source_20_Text">SqlServerInputFile</text:span> also adds <text:span text:style-name="Source_20_Text">Hash</text:span>, <text:span text:style-name="Source_20_Text">HashSize</text:span>, and <text:span text:style-name="Source_20_Text">HashAlgorithm</text:span> properties which return information about the cryptographic hash (if any) computed for the uploaded file.</text:p>
</text:list-item>
</text:list>
<text:h text:style-name="Heading_20_3" text:outline-level="3">
<text:bookmark text:name="SqlServerInputFileExample"/>Example</text:h>
<text:p text:style-name="Text_20_body">There is a demo at <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/Extensions/</text:span>
<text:span text:style-name="Source_20_Text">Hitone.Web.SqlServerUploader</text:span>
<text:span text:style-name="Source_20_Text">/DBWrite.aspx</text:span>. Before using it for the first time, you need to: </text:p>
<text:list text:style-name="L21">
<text:list-item>
<text:p text:style-name="P139">Create a database named "FileStorageTest" on an SQL Server. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P139">Create the table and stored procedures by running the query below corresponding to your version of SQL Server. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P63">If necessary, change the connection strings in <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/Extensions/Hitone.Web.SqlServerUploader</text:span>
<text:span text:style-name="Source_20_Text">/</text:span>
<text:span text:style-name="Source_20_Text">Web.config</text:span> to point to your database. For example, if you are using SQL Server Express on your local machine, you'll need to change <text:span text:style-name="Source_20_Text">"Server=.;"</text:span> to <text:span text:style-name="Source_20_Text">"Server=.\SQLEXPRESS;"</text:span> in several places.</text:p>
</text:list-item>
</text:list>
<text:h text:style-name="Heading_20_4" text:outline-level="4">Example Setup Query for SQL Server 2005</text:h>
<text:p text:style-name="Preformatted_20_Text">CREATE TABLE [FileTable] (</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>[Id] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>[FileName] [nvarchar] (50) NULL,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>[DataField] [varbinary] (max) NOT NULL ,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>[Partial] [tinyint] NOT NULL ,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>[MimeType] [nvarchar] (50) NULL ,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>[Created] [datetime] NOT NULL CONSTRAINT [DF_FileTable_Created] DEFAULT (getdate()),</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>[FileHash] [nvarchar] (50) NULL ,</text:p>
<text:p text:style-name="Preformatted_20_Text">)</text:p>
<text:p text:style-name="Preformatted_20_Text">GO</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">CREATE Procedure CreateBlob</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Identity Numeric Output,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Pointer Binary(16) Output,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@FileName VarChar(250) = null,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@MIMEType VarChar(250) = null</text:p>
<text:p text:style-name="Preformatted_20_Text">As Begin Set NoCount ON;</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>Insert Into FileTable (Datafield,FileName,MimeType,Partial) Values (0x,@FileName,@MimeType,1)</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>Select @Identity = SCOPE_IDENTITY()</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>Select @Pointer = DataField From FileTable Where $IDENTITY = @Identity</text:p>
<text:p text:style-name="Preformatted_20_Text">End</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">Go</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">CREATE Procedure OpenBlob</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Identity Numeric,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Pointer VarBinary(max) Output,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Size Int Output,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@FileName VarChar(250) Output,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@MIMEType VarChar(250) Output</text:p>
<text:p text:style-name="Preformatted_20_Text">As Begin Set NoCount On</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>Select <text:s/>@Pointer = 0x, -- Because @pointer is not used</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="24"/>@Size = DATALENGTH(DataField),</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="24"/>@FileName = [FileName],</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="24"/>@MIMEType = MIMEType</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>From FileTable Where $IDENTITY = @Identity</text:p>
<text:p text:style-name="Preformatted_20_Text">End</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">Go</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">CREATE Procedure ReadBlob</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Identity Numeric, --ignored in this implementation, here for reference</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Pointer Binary(16),</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Offset Int,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Size Int</text:p>
<text:p text:style-name="Preformatted_20_Text">As Begin Set NoCount On</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>SELECT SUBSTRING(DataField, @Offset+1, @Size) FROM FileTable WHERE ($IDENTITY = @Identity)</text:p>
<text:p text:style-name="Preformatted_20_Text">End</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">Go</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">CREATE Procedure WriteBlob</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Identity Numeric, --ignored in this implementation, here for reference</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Pointer Binary(16),</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Bytes VarBinary(max),</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Offset Int,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Delete Int</text:p>
<text:p text:style-name="Preformatted_20_Text">As Begin Set NoCount On</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>UPDATE FileTable SET DataField.write(@Bytes, null, null) WHERE $IDENTITY = @Identity</text:p>
<text:p text:style-name="Preformatted_20_Text">End</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">Go</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">CREATE Procedure CleanUpBlob</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Identity Numeric</text:p>
<text:p text:style-name="Preformatted_20_Text">As Begin Set NoCount On</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>Update FileTable Set Partial=0 Where $Identity=@Identity</text:p>
<text:p text:style-name="Preformatted_20_Text">End</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">Go</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">CREATE Procedure DeleteBlob</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Identity Numeric</text:p>
<text:p text:style-name="Preformatted_20_Text">As Begin Set NoCount On</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>Delete From FileTable Where $Identity=@Identity</text:p>
<text:p text:style-name="Preformatted_20_Text">End</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">Go</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">CREATE Procedure RenameBlob</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Identity Numeric,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@FileName VarChar(250)</text:p>
<text:p text:style-name="Preformatted_20_Text">As Begin Set NoCount On</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>Update FileTable Set [FileName]=@FileName Where $Identity=@Identity</text:p>
<text:p text:style-name="Preformatted_20_Text">End</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">Go</text:p>
<text:p text:style-name="Preformatted_20_Text"/>
<text:p text:style-name="Preformatted_20_Text">CREATE Procedure FinalizeBlob</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Identity Numeric,</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>@Hash VarChar(250)</text:p>
<text:p text:style-name="Preformatted_20_Text">As Begin Set NoCount On</text:p>
<text:p text:style-name="Preformatted_20_Text">
<text:s text:c="8"/>Update FileTable Set FileHash=@Hash Where $Identity=@Identity</text:p>
<text:p text:style-name="P5">End</text:p>
<text:h text:style-name="Heading_20_4" text:outline-level="4">Example Setup Query for SQL Server 2000</text:h>
<text:p text:style-name="Text_20_body">The main difference between this version and the version for SQL Server 2005 is the lack of a $IDENTITY object and the cap of 8000 bytes in a varbinary </text:p>
<text:p text:style-name="Preformatted_20_Text">CREATE TABLE [FileTable] (<text:line-break/> [Id] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,<text:line-break/> [FileName] [nvarchar] (50) NOT NULL ,<text:line-break/> [DataField] [image] NOT NULL ,<text:line-break/> [Partial] [tinyint] NOT NULL ,<text:line-break/> [MimeType] [nvarchar] (50) NOT NULL ,<text:line-break/> [Created] [datetime] NOT NULL CONSTRAINT [DF_FileTable_Created] DEFAULT (getdate()),<text:line-break/> [FileHash] [nvarchar] (50) NULL ,<text:line-break/>)<text:line-break/>
<text:line-break/>GO<text:line-break/>
<text:line-break/>CREATE Procedure CleanUpBlob<text:line-break/> @Identity Numeric<text:line-break/>As Begin Set NoCount On<text:line-break/> Update FileTable Set Partial=0 Where Id=@Identity<text:line-break/>End<text:line-break/>
<text:line-break/>GO<text:line-break/>
<text:line-break/>CREATE Procedure CreateBlob<text:line-break/> @Identity Numeric Output,<text:line-break/> @Pointer Binary(16) Output,<text:line-break/> @FileName VarChar(250) = null,<text:line-break/> @MIMEType VarChar(250) = null<text:line-break/>As Begin Set NoCount ON;<text:line-break/> Insert Into FileTable (Datafield,FileName,MimeType,Partial) Values ('',@FileName,@MimeType,1)<text:line-break/> Select @Identity = SCOPE_IDENTITY()<text:line-break/> Select @Pointer = TEXTPTR(DataField) From FileTable Where id = @Identity<text:line-break/>End<text:line-break/>
<text:line-break/>GO<text:line-break/>
<text:line-break/>CREATE Procedure DeleteBlob<text:line-break/> @Identity Numeric<text:line-break/>As Begin Set NoCount On<text:line-break/> Delete From FileTable Where id=@Identity<text:line-break/>End<text:line-break/>
<text:line-break/>GO<text:line-break/>
<text:line-break/>CREATE Procedure FinalizeBlob<text:line-break/> @Identity Numeric,<text:line-break/> @Hash VarChar(250)<text:line-break/>As Begin Set NoCount On<text:line-break/> Update FileTable Set FileHash=@Hash Where id=@Identity<text:line-break/>End<text:line-break/>
<text:line-break/>GO<text:line-break/>
<text:line-break/>CREATE Procedure OpenBlob<text:line-break/> @Identity Numeric,<text:line-break/> @Pointer VarBinary(8000) Output,<text:line-break/> @Size Int Output,<text:line-break/> @FileName VarChar(250) Output,<text:line-break/> @MIMEType VarChar(250) Output<text:line-break/>As Begin Set NoCount On<text:line-break/> Select <text:s/>@Pointer = TEXTPTR(DataField), <text:line-break/> @Size = DATALENGTH(DataField),<text:line-break/> @FileName = [FileName],<text:line-break/> @MIMEType = MIMEType<text:line-break/> From FileTable Where id = @Identity<text:line-break/>End<text:line-break/>
<text:line-break/>GO<text:line-break/>
<text:line-break/>CREATE Procedure ReadBlob<text:line-break/> @Identity Numeric, --ignored in this implementation, here for reference<text:line-break/> @Pointer Binary(16),<text:line-break/> @Offset Int,<text:line-break/> @Size Int<text:line-break/>As Begin Set NoCount On<text:line-break/> ReadText FileTable.DataField @Pointer @Offset @Size<text:line-break/>End<text:line-break/>
<text:line-break/>GO<text:line-break/>
<text:line-break/>CREATE Procedure RenameBlob<text:line-break/> @Identity Numeric,<text:line-break/> @FileName VarChar(250)<text:line-break/>As Begin Set NoCount On<text:line-break/> Update FileTable Set [FileName]=@FileName Where id=@Identity<text:line-break/>End<text:line-break/>
<text:line-break/>GO<text:line-break/>
<text:line-break/>CREATE Procedure WriteBlob<text:line-break/> @Identity Numeric, --ignored in this implementation, here for reference<text:line-break/> @Pointer Binary(16),<text:line-break/> @Bytes VarBinary(8000),<text:line-break/> @Offset Int,<text:line-break/> @Delete Int<text:line-break/>As Begin Set NoCount On<text:line-break/> UpdateText FileTable.DataField @Pointer @Offset @Delete With Log @Bytes<text:line-break/>End</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">The GreyBoxProgressBar Extension</text:h>
<text:p text:style-name="Text_20_body">GreyBoxProgressBar is a NeatUpload extension that uses <text:a xlink:type="simple" xlink:href="http://www.orangoo.com/labs/GreyBox/">Orangoo's open-source GreyBox</text:a> to display progress in a â€œpop-up window that doesn't suckâ€. <text:s/>To use the <text:span text:style-name="Source_20_Text">GreyBoxProgressBar</text:span> control:</text:p>
<text:list text:style-name="L22">
<text:list-item>
<text:p text:style-name="P141">Install GreyBoxProgressBar:</text:p>
<text:p text:style-name="P141">
<text:span text:style-name="T8">If you will be using the Visual Studio Web Form Designer</text:span>, add the <text:span text:style-name="Source_20_Text">GreyBoxProgressBar</text:span> control to your toolbox. Â To do that, right-click on the Toolbox, click Add/Remove Items, Browse toÂ  <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/bin/Brettle.Web.NeatUpload.GreyBoxProgressBar.dll</text:span>, click Open, and then click OK. Â A reference to <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.GreyBoxProgressBar.dll</text:span> will automatically be added to your project the first time you use the designer to a GreyBoxProgressBar to a form.<text:line-break/>
<text:span text:style-name="T8">If you won't be using the Visual Studio Web Form Designer</text:span>, add a reference to your web application that refers to the <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.GreyBoxProgressBar.dll</text:span> in the <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/bin/</text:span> directory.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P141">Download and install <text:a xlink:type="simple" xlink:href="http://www.orangoo.com/labs/GreyBox/">GreyBox</text:a> into a â€œ/greyboxâ€ folder of your application. <text:s/>If you wish to put GreyBox someplace else, use the GreyBoxRoot attribute of the GreyBoxProgressBar control to specify the URL of the GreyBox directory. <text:s/>You may use an absolute or relative URL that refers to a page in the same web application. <text:s/>If the URL starts with "~", the "~" will be replaced with the web application root. <text:s/>By default, "~/greybox" will be used.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P64">Add the GreyBoxProgressBar to your forms:<text:line-break/>
<text:span text:style-name="T8">If you are using Visual Studio Web Form Designer</text:span>, simply drag the <text:span text:style-name="Source_20_Text">GreyBoxProgressBar</text:span> control from your Toolbox and drop it on the form.<text:line-break/>
<text:span text:style-name="T8">If you are not using Visual Studio Web Form Designer</text:span>, add the following line at the top of your form:</text:p>
<text:p text:style-name="P203">&lt;%@ Register TagPrefix="GreyBoxUpload" Namespace="Brettle.Web.NeatUpload" Assembly="Brettle.Web.NeatUpload.GreyBoxProgressBar "%&gt;</text:p>
<text:p text:style-name="P64">and add a <text:span text:style-name="Source_20_Text">GreyBoxProgressBar</text:span> control to your aspx page wherever you want the user to choose a file, using something like this: </text:p>
<text:p text:style-name="P199">&lt;GreyBoxUpload:GreyBoxProgressBar id="progressBar<text:span text:style-name="Variable">Id</text:span>" runat="server" /&gt;</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P141">Optionally, set any properties that you would normally set on an<text:span text:style-name="Source_20_Text"> ProgressBar</text:span> control, except the for the Inline property. <text:s/>If you set the Width or Height properties, they must be set to values in units of pixels.</text:p>
<text:p text:style-name="P141"/>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">For an example of using the GreyBoxProgressBar extension, see <text:span text:style-name="Source_20_Text">Demo.aspx </text:span>and<text:span text:style-name="Source_20_Text"> Demo.aspx.cs </text:span>in the<text:span text:style-name="Source_20_Text"> NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/Extensions/Brettle.Web.NeatUpload.GreyBoxProgressBar/ </text:span>directory<text:span text:style-name="Source_20_Text">.</text:span>
</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId831551"/>The HashedInputFile Extension</text:h>
<text:p text:style-name="Text_20_body">HashedInputFile is a NeatUpload extension that computes the cryptographic hash of each uploaded file while the upload is in progress.Â  Â It consists of the <text:span text:style-name="Source_20_Text">HashedInputFile</text:span> web controlÂ and a custom <text:span text:style-name="Source_20_Text">UploadStorageProvider</text:span> called <text:span text:style-name="Source_20_Text">HashingFilesystemUploadStorageProvider</text:span>. Â The <text:span text:style-name="Source_20_Text">HashedInputFile</text:span> control is a subclass of <text:span text:style-name="Source_20_Text">InputFile</text:span> that adds a <text:span text:style-name="Source_20_Text">Hash</text:span> property which returns the cryptographic hash of the uploaded file computed by the <text:span text:style-name="Source_20_Text">HashingFilesystemUploadStorageProvider</text:span>. Â To use the HashedInputFile extension:</text:p>
<text:list text:style-name="L22" text:continue-numbering="true">
<text:list-item>
<text:p text:style-name="P141">Install HashedInputFile:</text:p>
<text:p text:style-name="P141">
<text:span text:style-name="T8">If you will be using the Visual Studio Web Form Designer</text:span>, add the <text:span text:style-name="Source_20_Text">HashedInputFile</text:span> control to your toolbox. Â To do that, right-click on the Toolbox, click Add/Remove Items, Browse toÂ  <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/bin/Brettle.Web.NeatUpload.HashedInputFile.dll</text:span>, click Open, and then click OK. Â A reference to <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.HashedInputFile.dll</text:span> will automatically be added to your project the first time you use the designer to a HashedInputFile to a form.<text:line-break/>
<text:span text:style-name="T8">If you won't be using the Visual Studio Web Form Designer</text:span>, add a reference to your web application that refers to the <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.HashedInputFile.dll</text:span> in the <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/bin/</text:span> directory.</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P141">Configure your web application to use the <text:span text:style-name="Source_20_Text">HashingFilesystemUploadStorageProvider</text:span>. Â The simplest way to do that is to add the following to your <text:span text:style-name="Source_20_Text">Web.config</text:span> (seeÂ <text:a xlink:type="simple" xlink:href="Manual.html#mozTocId221000">Configuration</text:a> for more options):</text:p>
<text:p text:style-name="P166">&lt;configuration&gt;<text:line-break/> &lt;configSections&gt;<text:line-break/>
<text:s/>&lt;section name="neatUpload" type="Brettle.Web.NeatUpload.ConfigSectionHandler,Brettle.Web.NeatUpload"<text:line-break/>
<text:s text:c="16"/>allowLocation="true" /&gt;<text:line-break/> &lt;/configSections&gt;<text:line-break/> ...<text:line-break/> &lt;neatUpload ... <text:line-break/>
<text:s/>defaultStorageProvider="HashingFilesystemUploadStorageProvider"&gt;<text:line-break/>
<text:s/>&lt;providers&gt;<text:line-break/>
<text:s text:c="2"/>&lt;add name="HashingFilesystemUploadStorageProvider" <text:line-break/>
<text:s text:c="3"/>type="Brettle.Web.NeatUpload.HashingFilesystemUploadStorageProvider,Brettle.Web.NeatUpload.HashedInputFile"<text:line-break/>
<text:s text:c="6"/>algorithm="MD5"/&gt;<text:line-break/>
<text:s/>&lt;/providers&gt;<text:line-break/> &lt;/neatUpload&gt;<text:line-break/> ...<text:line-break/>&lt;/configuration&gt;</text:p>
<text:p text:style-name="P141">Note: the value of theÂ <text:span text:style-name="Source_20_Text">algorithm</text:span> attribute above is passed to <text:a xlink:type="simple" xlink:href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyhashalgorithmclasscreatetopic2.asp">HashAlgorithm.Create()</text:a>. Â The default value is "MD5", so the attribute could have been omitted above. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P64">Add the HashedInputFile to your forms:<text:line-break/>
<text:span text:style-name="T8">If you are using Visual Studio Web Form Designer</text:span>, simply drag the <text:span text:style-name="Source_20_Text">HashedInputFile</text:span> control from your Toolbox and drop it on the form.<text:line-break/>
<text:span text:style-name="T8">If you are not using Visual Studio Web Form Designer</text:span>, add the following line at the top of your form:</text:p>
<text:p text:style-name="P203">&lt;%@ Register TagPrefix="HashedUpload" Namespace="Brettle.Web.NeatUpload" Assembly="Brettle.Web.NeatUpload.HashedInputFile"%&gt;</text:p>
<text:p text:style-name="P64">and add anÂ <text:span text:style-name="Source_20_Text">HashedInputFile</text:span> control to your aspx page wherever you want the user to choose a file, using something like this: </text:p>
<text:p text:style-name="P199">&lt;HashedUpload:HashedInputFile id="<text:span text:style-name="Variable">inputFileId</text:span>" runat="server" /&gt;</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P141">Set any properties that you would normally set on an <text:span text:style-name="Source_20_Text">InputFile or HtmlInputFile</text:span> control. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P64">In your code-behind class,Â use the <text:span text:style-name="Source_20_Text">
<text:span text:style-name="T12">inputFileId</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>
<text:span text:style-name="Source_20_Text">
<text:span text:style-name="T11">.Hash</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>property to get a byte array containing the cryptographic hash. Â You can also use <text:span text:style-name="T12">inputFileId</text:span>
<text:span text:style-name="T11">.HashSize</text:span> to get the number of bits in the hash (in case it isn't a multiple of 8).</text:p>
</text:list-item>
</text:list>
<text:p text:style-name="Text_20_body">For an example of using the HashedInputFile extension, see <text:span text:style-name="Source_20_Text">HashedDemo.aspx</text:span> and <text:span text:style-name="Source_20_Text">HashedDemo.aspx.cs</text:span> in the <text:span text:style-name="Source_20_Text">NeatUploadâ€‘</text:span>
<text:span text:style-name="Emphasis">version</text:span>
<text:span text:style-name="Source_20_Text">/dotnet/app/Extensions/Brettle.Web.NeatUpload.HashedInputFile/ </text:span>
<text:s/>directory. Â For a more complex configuration example, see <text:span text:style-name="Source_20_Text">Web.config</text:span> in that directory. Â It uses <text:a xlink:type="simple" xlink:href="#mozTocId134915">location filtering</text:a> and is designed to work in conjuction with the <text:span text:style-name="Source_20_Text">Web.config</text:span> in application root.</text:p>
<text:h text:style-name="Heading_20_1" text:outline-level="1">
<text:bookmark text:name="mozTocId580088"/>Known Issues</text:h>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="AspNetTrace"/>ASP.NET application-wide tracing disables NeatUpload</text:h>
<text:p text:style-name="Text_20_body">When ASP.NET tracing is enabled in the application Web.config, ASP.NET reads the entire upload before NeatUpload can access it. As a result, NeatUpload can't stream the upload to storage and can't provide a meaningful progress bar. Since NeatUpload can't do anything useful under such circumstances, it automatically disables itself. Specifically, it acts as though you set the <text:span text:style-name="Source_20_Text">useHttpModule</text:span> attribute of the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element to "false". That prevents display of the progress bar and prevents streaming to storage, but your code should otherwise continue to function normally. </text:p>
<text:p text:style-name="Text_20_body">Note that this issue only arises when you enable <text:span text:style-name="T3">application-wide</text:span> ASP.NET tracing (i.e. via the Web.config). It does not arise if you only enable ASP.NET tracing at the page level using the <text:span text:style-name="Source_20_Text">Trace</text:span> attribute of the <text:span text:style-name="Source_20_Text">&lt;%@Page%&gt;</text:span> directive. Unfortunately, if you enable application-wide ASP.NET tracing but disable tracing for some or all pages using the <text:span text:style-name="Source_20_Text">Trace</text:span> attribute of the <text:span text:style-name="Source_20_Text">&lt;%@Page%&gt;</text:span> directive, the problem still occurs. This is because the <text:span text:style-name="Source_20_Text">Trace</text:span> attribute of the <text:span text:style-name="Source_20_Text">&lt;%@Page%&gt;</text:span> directive has no effect on whether ASP.NET reads in the entire request before NeatUpload can access it. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:span text:style-name="Source_20_Text">Permissions on uploaded files depend on temporary directory</text:span>
</text:h>
<text:p text:style-name="Text_20_body">Uploaded files are created in a temporary directory and inherit the permissions of that directory. Calling <text:span text:style-name="Source_20_Text">InputFile.MoveTo()</text:span> does not change the permissions. In some environments, files in the default temporary directory are not readable by web applications, and as a result uploaded files are not readable by the web application. To avoid this issue, simply <text:a xlink:type="simple" xlink:href="../../branches/NeatUpload-1.2/docs/Manual.html#mozTocId905959">change the temporary directory used by NeatUpload</text:a> to a directory that has the permissions you desire. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:span text:style-name="Source_20_Text">Module conflicts can cause data length is shorter than Content-Length errors</text:span>
</text:h>
<text:p text:style-name="Text_20_body">When certain 3rd-party HttpModules are used along with NeatUpload a "Data length (xxx) is shorter than Content-Length (yyy) error" can occur. To avoid this place NeatUpload's UploadHttpModule <text:span text:style-name="Emphasis">first</text:span> in the &lt;httpModules&gt; section, before all other modules. This problem has been reported with both <text:a xlink:type="simple" xlink:href="http://www.snapsis.com/PageBlaster.aspx">PageBlaster</text:a> and <text:a xlink:type="simple" xlink:href="http://www.ifinity.com.au/Products/Url_Master_DNN_SEO_Urls/">UrlMaster</text:a>. It is often encountered on sites that installed NeatUpload as part of <text:a xlink:type="simple" xlink:href="http://www.bizmodules.net/Products/UltraVideoGallery2/Overview/tabid/124/Default.aspx">Ultra Video Gallery (UVG)</text:a>. </text:p>
<text:p text:style-name="Text_20_body">This issue is caused by the fact that NeatUpload (and any other module that monitors upload progress) needs to intercept the request before ASP.NET reads the request body. ASP.NET needs to read the request body in order to compute certain properties of the Request object (e.g. Request.Params). So if another module accesses one of those properties before NeatUpload intercepts the request, ASP.NET will read the request body and when NeatUpload tries to read the request body, there won't be anything there. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId766780"/>
<text:span text:style-name="Source_20_Text">HttpResponse.AppendToLog()</text:span> does nothing when <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> is used</text:h>
<text:p text:style-name="Text_20_body">Due to the design of NeatUpload this bug will not be fixed, however NeatUpload does provide a workaround. Â Simply replace <text:span text:style-name="Source_20_Text">Response.AppendToLog()</text:span> with <text:span text:style-name="Source_20_Text">Brettle.Web.NeatUpload.UploadHttpModule.AppendToLog()</text:span>. Â That will work whether the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> is used or not.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">Setting <text:span text:style-name="Source_20_Text">HttpResponse.HeaderEncoding</text:span> does nothing when <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> is used</text:h>
<text:p text:style-name="Text_20_body">Due to the design of NeatUpload this bug will not be fixed, however if the pages that need to set <text:span text:style-name="Source_20_Text">Response.HeaderEncoding</text:span> are not pages to which the user will be uploading files, you can use <text:a xlink:type="simple" xlink:href="../../branches/NeatUpload-1.2/docs/Manual.html#mozTocId134915">location filtering</text:a> to disable the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> for those pages. Also, if you are setting <text:span text:style-name="Source_20_Text">Response.HeaderEncoding</text:span> so that you can specify a non-ASCII filename for a downloaded file via the filename parameter of the Content-Disposition header, you should consider other approaches. Even without the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span>, setting <text:span text:style-name="Source_20_Text">Response.HeaderEncoding</text:span> will only work if you set it to the encoding that the browser happens to be using. For example, setting it to "big5" will not cause the file to have a name with Chinese characters if the user is using the UTF-8 encoding. Also, if you set <text:span text:style-name="Source_20_Text">Response.HeaderEncoding</text:span> to a value that is different from the encoding used by the browser, you could create a security hole. </text:p>
<text:p text:style-name="Text_20_body">There are two better approaches. For both approaches, the filename needs to be encoded using the <text:span text:style-name="Source_20_Text">HttpUtility.UrlPathEncode()</text:span> method. That encodes non-ASCII characters using the %XX notation you often see in URLs. Once you have the UrlPathEncoded filename, you have 2 options. </text:p>
<text:list text:style-name="L23">
<text:list-item>
<text:p text:style-name="P69">Option 1: Set the Content-Disposition header to simply "attachment", and place the encoded filename in the "path info" part of the download URL. So, instead of using a download URL of "http://tempuri.org/DownloadFile.ashx", you would use a download URL of "http://tempuri.org/DownloadFile.ashx/<text:span text:style-name="T3">YourUrlPathEncodedFilename</text:span>". If you are using IIS or some other webserver that supports path info, this approach will work under at least the latest versions of IE, Firefox, Opera, and Safari. However, this approach does not work if you are using Visual Studio's Development Web Server because it doesn't support path info. If your server does support path info, you can implement this approach easily by changing your download page to redirect the browser to a page which has the necessary path info, like this: </text:p>
<text:p text:style-name="P167">&lt;%@ WebHandler Language="C#" Class="Handler" %&gt;</text:p>
<text:p text:style-name="P167">using System;</text:p>
<text:p text:style-name="P167">using System.Web;</text:p>
<text:p text:style-name="P167"/>
<text:p text:style-name="P167">public class Handler : IHttpHandler {</text:p>
<text:p text:style-name="P167">
<text:s text:c="4"/>public void ProcessRequest (HttpContext context) </text:p>
<text:p text:style-name="P167">
<text:s text:c="4"/>{</text:p>
<text:p text:style-name="P167">
<text:s text:c="8"/>string filename = "ä¸­æ–‡æª”å.doc" // <text:s/>or some other file name</text:p>
<text:p text:style-name="P167">
<text:s text:c="8"/>string encodedFilename = HttpUtility.UrlPathEncode(filename);</text:p>
<text:p text:style-name="P167">
<text:s text:c="8"/>if (context.Request.PathInfo == null || context.Request.PathInfo.Length == 0)</text:p>
<text:p text:style-name="P167">
<text:s text:c="8"/>{</text:p>
<text:p text:style-name="P167">
<text:s text:c="12"/>string query = context.Request.Url.Query;</text:p>
<text:p text:style-name="P167">
<text:s text:c="12"/>context.Response.Redirect(context.Request.Path + "/" + encodedFilename + query);</text:p>
<text:p text:style-name="P167">
<text:s text:c="8"/>}</text:p>
<text:p text:style-name="P167">
<text:s text:c="8"/>else</text:p>
<text:p text:style-name="P167">
<text:s text:c="8"/>{</text:p>
<text:p text:style-name="P167">
<text:s text:c="12"/>context.Response.Clear();</text:p>
<text:p text:style-name="P167">
<text:s text:c="12"/>context.Response.ContentType = "application/octet-stream";</text:p>
<text:p text:style-name="P167">
<text:s text:c="12"/>context.Response.AddHeader("Content-Disposition", "attachment");</text:p>
<text:p text:style-name="P167">
<text:s text:c="12"/>FileInfo fi = new FileInfo(context.Server.MapPath(filename));</text:p>
<text:p text:style-name="P167">
<text:s text:c="12"/>context.Response.WriteFile(fi.FullName);</text:p>
<text:p text:style-name="P167">
<text:s text:c="12"/>context.Response.Flush();</text:p>
<text:p text:style-name="P167">
<text:s text:c="12"/>context.Response.End();</text:p>
<text:p text:style-name="P167">
<text:s text:c="8"/>}</text:p>
<text:p text:style-name="P167">
<text:s text:c="4"/>}</text:p>
<text:p text:style-name="P167">
<text:s text:c="4"/>
</text:p>
<text:p text:style-name="P167">
<text:s text:c="4"/>public bool IsReusable { get { return false; } }</text:p>
<text:p text:style-name="P205">}</text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P69">Option 2: Set the Content-Disposition header's filename parameter to the UrlPathEncoded filename, but do so in a way that is supported by the browser. According to <text:a xlink:type="simple" xlink:href="http://www.faqs.org/rfcs/rfc2231.html">RFC 2231</text:a>, the correct way to do this is to set the Content-Disposition header to "<text:span text:style-name="Source_20_Text">attachment;Â filename*=utf-8''</text:span>
<text:span text:style-name="Source_20_Text">
<text:span text:style-name="T3">YourUrlPathEncodedFilename</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>". That works for the latest versions of Firefox and Opera, but not IE and Safari. Both IE and Safari will ignore the filename parameter and use the name of your download page (e.g. DownloadFile.ashx). There is no way to set the filename parameter to work with Safari, but for IE you can set Content-Disposition header to "<text:span text:style-name="Source_20_Text">attachment;Â filename=</text:span>
<text:span text:style-name="Source_20_Text">
<text:span text:style-name="T3">YourUrlPathEncodedFilename</text:span>
</text:span>
<text:span text:style-name="Source_20_Text"/>". That doesn't work for Firefox or Safari though. So, you need to treat it as a special IE-only case. Here is an example: </text:p>
<text:p text:style-name="P206">&lt;%@ WebHandler Language="C#" Class="Handler" %&gt;</text:p>
<text:p text:style-name="P206">using System;</text:p>
<text:p text:style-name="P206">using System.Web;</text:p>
<text:p text:style-name="P206"/>
<text:p text:style-name="P206">public class Handler : IHttpHandler {</text:p>
<text:p text:style-name="P206">
<text:s text:c="4"/>public void ProcessRequest (HttpContext context) </text:p>
<text:p text:style-name="P206">
<text:s text:c="4"/>{</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>string filename = "ä¸­æ–‡æª”å.doc" // <text:s/>or some other file name</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>string encodedFilename = HttpUtility.UrlPathEncode(filename);</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>context.Response.Clear();</text:p>
<text:p text:style-name="P206">
<text:s text:c="12"/>context.Response.ContentType = "application/octet-stream";</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>string contentDisposition = "attachment";</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>if (context.Request.Browser.IsBrowser("IE"))</text:p>
<text:p text:style-name="P206">
<text:s text:c="12"/>contentDisposition += "; filename=" + encodedFilename;</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>else</text:p>
<text:p text:style-name="P206">
<text:s text:c="12"/>contentDisposition += "; filename*=utf-8''" + encodedFilename;</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>context.Response.AddHeader("Content-Disposition", contentDisposition);</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>FileInfo fi = new FileInfo(context.Server.MapPath(filename));</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>context.Response.WriteFile(fi.FullName);</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>context.Response.Flush();</text:p>
<text:p text:style-name="P206">
<text:s text:c="8"/>context.Response.End();</text:p>
<text:p text:style-name="P206">
<text:s text:c="4"/>}</text:p>
<text:p text:style-name="P206">
<text:s text:c="4"/>
</text:p>
<text:p text:style-name="P206">
<text:s text:c="4"/>public bool IsReusable { get { return false; } }</text:p>
<text:p text:style-name="P230">}</text:p>
</text:list-item>
</text:list>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId752771"/>Inline <text:span text:style-name="Source_20_Text">ProgressBars </text:span>don't work with Opera</text:h>
<text:p text:style-name="Text_20_body">Opera does not seem to allow an <text:span text:style-name="Source_20_Text">IFRAME</text:span> to be updated during form submission. Â NeatUpload works around this by using a popup progress bar whenever the User-Agent header contains "Opera" (case-insensitive). Most browsers don't allow popups to be smaller that 500x100 pixels. If you specify a smaller width or height or use units other than pixels, NeatUpload will automatically use the minimum size in pixels.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="mozTocId181845"/>Non-absolute path in IE7 causes the progress display to start even though no upload occurs</text:h>
<text:p text:style-name="Text_20_body">If instead of selecting a file to upload via the file selection dialog, the user types in a non-absolute path (e.g. just "x"), IE6 and IE7 will not submit the form and no upload will occur. Â Under IE6, it is possible to detect this situation and prevent the progress display from starting. Â The situation is detected by using Javascript to examine the value of the <text:span text:style-name="Source_20_Text">&lt;input type="file"&gt;</text:span> form element. Â If the value doesn't look like an absolute path, the progress display is not started. Â In IE7, the value of the form element is always just the filename, not the full path, probably for security reasons. Â As a result, NeatUpload can't prevent the progress display from starting because it's not possible to determine whether an absolute path was entered -- the value is "x" whether the user entered "x" or "c:\x".</text:p>
<text:p text:style-name="Text_20_body">Since users almost always use the file selection dialog, this issue almost never arises.</text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="OnClickReturnValue"/>Handler returning false does not block default action in IE6</text:h>
<text:p text:style-name="Text_20_body">When not using NeatUpload, an event handler returning false will prevent the browser from performing the default action for the event. For example, consider a submit button with <text:span text:style-name="Source_20_Text">onclick="returnÂ confirm('Submit?');"</text:span>. If the user clicks the button a dialog will appear asking "Submit?". When not using NeatUpload, declining will prevent submission of the form. However, when using NeatUpload, the form will be submitted if the user is using IE6. To workaround this, change such handlers to set <text:span text:style-name="Source_20_Text">window.event.returnValue=false</text:span> when they return false. For example, here is the implementation of a function that can be used instead of <text:span text:style-name="Source_20_Text">confirm()</text:span> in the above example: </text:p>
<text:p text:style-name="P4">function confirmSubmit(msg)<text:line-break/>{<text:line-break/>
<text:s text:c="3"/>var confirmed = confirm(msg);<text:line-break/>
<text:s text:c="3"/>if (!confirmed &amp;&amp; window.event)<text:line-break/>
<text:s text:c="7"/>window.event.returnValue = false;<text:line-break/>
<text:s text:c="3"/>return confirmed;<text:line-break/>}</text:p>
<text:p text:style-name="Text_20_body">This problem is caused by a difference in the order IE6 calls event handlers. In order to prevent non-triggers from starting an upload, NeatUpload registers event handlers on the <text:span text:style-name="Source_20_Text">&lt;form&gt;</text:span> element for a variety of events (including onclick). Those handlers clear the filename if the event is not coming from a trigger. In standard-conformant browsers (i.e. modern browsers other than IE), it is possible to register those handlers so that they run before other handlers registered for controls within the form (e.g. submit buttons). As a result, the value returned by the submit button handler is what determines whether the form actually gets submitted. In IE, the NeatUpload form event handler runs last and the value it returns (always true) determines whether the form gets submitted. NeatUpload can't determine the value returned by the submit button handler and return it instead, so the above workaround is needed. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="MacIELinkButtons"/>
<text:span text:style-name="Source_20_Text">LinkButtons</text:span> do not start the progress display in Internet Explorer for the Mac</text:h>
<text:p text:style-name="Text_20_body">NeatUpload overrides the <text:span text:style-name="Source_20_Text">form.submit()</text:span> JavaScript method to start the progress display when the form is submitted programmatically (e.g. with a <text:span text:style-name="Source_20_Text">LinkButton</text:span>). Mac IE does not support overriding <text:span text:style-name="Source_20_Text">form.submit()</text:span> so NeatUpload can't start the progress display if a <text:span text:style-name="Source_20_Text">LinkButton</text:span> is used to submit the form. The upload still occurs though. Since Mac IE is no longer supported by Microsoft and currently has less than 1% of the browser market, there are currently no plans to develop a workaround for this. </text:p>
<text:h text:style-name="Heading_20_2" text:outline-level="2">
<text:bookmark text:name="LargeResponseNotBuffered"/>Sometimes responses larger than 1MB are not buffered</text:h>
<text:p text:style-name="Text_20_body">Without NeatUpload, ASP.NET (by default) buffers the entire response in memory before sending it. However, when NeatUpload's <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> is installed, it will sometimes flush the buffer if the response is larger than 1 MByte. Responses smaller then 1 MBytes are not affected, but NeatUpload will sometimes flush larger responses even if the page does not contain any NeatUpload controls and does not receive uploads. To avoid this behavior you need to use <text:a xlink:type="simple" xlink:href="#mozTocId134915">location filtering</text:a> to set <text:span text:style-name="Source_20_Text">&lt;neatUpload ... useHttpModule="true".../&gt;</text:span> for the page. Very few applications need to buffer such large responses, but if your application needs such buffering, you can use location filtering to workaround the issue. </text:p>
<text:p text:style-name="Text_20_body">Technical note: The current behavior is a side-effect of a workaround for a problem where <text:span text:style-name="Source_20_Text">HttpResponse.TransmitFile()</text:span> was causing the entire file to be buffered in memory when the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> was being used. Apparently, Microsoft coded <text:span text:style-name="Source_20_Text">TransmitFile()</text:span> so that buffering is only avoided when the current <text:span text:style-name="Source_20_Text">HttpWorkerRequest</text:span> is a particular subclass of <text:span text:style-name="Source_20_Text">HttpWorkerRequest</text:span>. Since NeatUpload wraps the original <text:span text:style-name="Source_20_Text">HttpWorkerRequest</text:span> in it's own subclass, ASP.NET does not see the original <text:span text:style-name="Source_20_Text">HttpWorkerRequest</text:span> and does not bypass the buffering. Instead it calls <text:span text:style-name="Source_20_Text">HttpWorkerRequest.SendResponseFromFile()</text:span>. NeatUpload's implementation of <text:span text:style-name="Source_20_Text">SendResponseFromFile()</text:span> avoids the problem by flushing the response after every 1 MByte. Since this workaround affects <text:span text:style-name="Source_20_Text">SendResponseFromFile()</text:span> but not other methods of sending response content, the flushing will not occur for all types of responses. That means you should not assume a response will be flushed simply because it is larger than 1 MByte. </text:p>
<text:h text:style-name="Heading_20_1" text:outline-level="1">
<text:bookmark text:name="mozTocId405545"/>Troubleshooting</text:h>
<text:p text:style-name="Text_20_body">If you think NeatUpload's <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> might be causing a problem, the first thing you should do is set the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element'sÂ <text:span text:style-name="Source_20_Text">useHttpModule</text:span> attribute toÂ "false" (or remove the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> from the <text:span text:style-name="Source_20_Text">&lt;httpModules&gt;</text:span> section) and try to reproduce the problem. Â All of your existing code should continue to work - you just won't get progress bars and streaming of files to disk. Â If the problem goes away when you remove the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span>, it is a bug so please <text:a xlink:type="simple" xlink:href="http://www.brettle.com/neatupload_bugs">report it</text:a>. Â You can help me diagnosis the problem by doing the following:</text:p>
<text:list text:style-name="L24">
<text:list-item>
<text:p text:style-name="P151">Set the <text:span text:style-name="Source_20_Text">debugDirectory</text:span> attribute of the <text:span text:style-name="Source_20_Text">&lt;neatUpload&gt;</text:span> element in your <text:span text:style-name="Source_20_Text">Web.config</text:span> to the name of a directory in your webapp where NeatUpload can store copies of the request bodies it processes. Â For example,<text:span text:style-name="Source_20_Text"> &lt;neatUpload ... debugDirectory="MyDebugDir" ...&gt; </text:span>would cause NeatUpload to store copies of the request bodies in the "MyDebugDir" directory under you application root. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P151">Reproduce the problem. </text:p>
</text:list-item>
<text:list-item>
<text:p text:style-name="P71">Send me (dean at brettle dot com) a zip file containing the files from debug directory with the extensions ".body" and ".sizes". Â Each ".body" file contains the body of a request you sent when reproducing the problem. Â The corresponding ".sizes" file contains the MIME type of the request and the size of each chunk that NeatUpload read. Â I can use the <text:span text:style-name="Source_20_Text">TestFilter.exe</text:span> program to reproduce how the <text:span text:style-name="Source_20_Text">UploadHttpModule</text:span> processed the request and (hopefully) determine exactly what went wrong. </text:p>
</text:list-item>
</text:list>
</office:text>
</office:body>
</office:document>
